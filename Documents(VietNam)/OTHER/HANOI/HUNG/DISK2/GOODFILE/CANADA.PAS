 uses crt;
 type  mang=array[1..100,1..100] of integer;
 var a:mang;
     b:array[1..100] of boolean;
     val,maxd:array[1..100] of byte;
     max,k,luu,m,n:byte;
     f:text;

 procedure  readfile;
 var i,j,k1:byte;
 begin
   fillchar(b,sizeof(b),true);
   fillchar(a,sizeof(a),0);
   fillchar(val,sizeof(val),0);
   k:=1;luu:=1;
   val[1]:=1;b[1]:=false;
   maxd:=val;max:=1;
   assign(f,'canada.inp');
   reset(f);
   readln(f,m,n);
   writeln(' INPUT:');
   writeln(m:6,n:6);
   for i:=1 to n do
    begin
       readln(f,j,k1);
       a[j,k1]:=1;
       a[k1,j]:=2;
       writeln(j:6,k1:6);
    end;
    close(f);
 end;

 function di_thang(i:byte):boolean;
 begin
   if a[val[k],i]=luu then di_thang:=true
   else  di_thang:=false;
 end;

 function  chuyen_huong(i:byte):boolean;
 var j:byte;
 begin
   chuyen_huong:=true;
   j:=1;
   while (j<=m) and ((b[j]=false ) or (a[i,j]<>2)) do inc(j);
   if j<=m then exit;
   chuyen_huong:=false;
 end;

 procedure ghi_nhan;
 begin
  maxd:=val;
  max:=k;
 end;

 procedure xuat;
 var i:byte;
 begin
  writeln(' OUTPUT:');
  writeln(max);
  for i:=1 to max do write(maxd[i]:6);
 end;

 procedure  try;
 var i,j:byte;
 begin
  for i:=1 to m do
   if b[i] and (a[val[k],i]=luu) then
    begin
     if di_thang(i) then
      begin
       inc(k);
       val[k]:=i;
       b[i]:=false;
       if (k>max) and (a[val[k],val[1]]=2) then ghi_nhan;
       try;
       b[i]:=true;
       dec(k);
     end;
     if chuyen_huong(i) then
      begin
        inc(k);
        val[k]:=i;
        b[i]:=false;
        luu:=2;
        if (k>max) and (a[val[k],val[1]]=20) then ghi_nhan ;
        try;
        dec(k);
        b[i]:=true;
        luu:=1;
      end;
   end;
 end;

 begin   clrscr;
 readfile;
 try;
 xuat;
 readln
 end.
30  70
   4   1
   7   1
   1  10
   1  11
   1  13
  15   1
  18   1
   1  19
  20   1
  22   1
  23   1
  24   1
   1  28
  30   1
   2   4
   6   2
   8   2
   9   2
   2  10
  11   2
  12   2
   2  16
   2  18
  20   2
   2  21
  22   2
  23   2
   2  24
  26   2
   2  27
  28   2
   2  29
  30   2
   5   3
   8   3
   3   9
  10   3
   3  11
   3  12
  13   3
  14   3
   3  15
  17   3
  18   3
  19   3
  20   3
  23   3
  24   3
   3  25
  26   3
  27   3
   3  30
   6   4
   4   9
  10   4
   4  15
   4  16
   4  19
  20   4
  21   4
  26   4
  27   4
   4  28
   4  29
   4  30
   6   5
   5   7
   5   8
   9   5
  10   5
  16   5
   5  18
   5  20
  21   5
   5  24
  25   5
  26   5
   5  28
  30   5
   7   6
   6   8
   9   6
   6  10
   6  11
   6  12
  13   6
  14   6
   6  16
   6  17
   6  20
  21   6
  23   6
  24   6
  25   6
  26   6
  28   6
  29   6
   6  30
   7   8
  11   7
   7  12
  14   7
  18   7
   7  19
  20   7
  22   7
  25   7
   7  26
   7  28
  29   7
   7  30
   8   9
   8  10
  12   8
  13   8
  15   8
   8  16
  18   8
   8  19
  21   8
   8  22
   8  24
  25   8
   8  26
   8  28
  10   9
  11   9
   9  12
  13   9
   9  14
  16   9
  19   9
  20   9
   9  21
  22   9
   9  27
   9  28
   9  29
  10  11
  10  12
  10  13
  14  10
  15  10
  10  16
  10  18
  10  19
  20  10
  10  21
  23  10
  10  24
  25  10
  10  26
  10  27
  10  28
  29  10
  10  30
  13  11
  14  11
  15  11
  16  11
  18  11
  21  11
  11  22
  23  11
  27  11
  29  11
  30  11
  13  12
  12  15
  16  12
  12  20
  12  21
  24  12
  12  26
  12  27
  15  13
  17  13
  13  18
  13  19
  20  13
  23  13
  24  13
  13  28
  13  29
  14  16
  17  14
  14  18
  20  14
  14  22
  14  24
  14  25
  27  14
  14  28
  14  29
  16  15
  21  15
  22  15
  25  15
  26  15
  15  27
  15  29
  30  15
  17  16
  16  18
  16  19
  20  16
  21  16
  22  16
  23  16
  24  16
  25  16
  26  16
  16  28
  18  17
  20  17
  21  17
  23  17
  24  17
  17  25
  26  17
  17  27
  17  28
  29  17
  30  17
  18  19
  18  20
  18  21
  22  18
  24  18
  18  26
  18  27
  18  28
  18  29
  30  18
  19  20
  21  19
  19  22
  19  23
  24  19
  19  27
  28  19
  29  19
  20  21
  22  20
  20  23
  20  25
  27  20
  28  20
  29  20
  20  30
  21  24
  25  21
  21  27
  28  21
  29  21
  30  21
  23  22
  24  22
  22  27
  28  22
  24  23
  23  25
  23  26
  23  27
  29  23
  30  23
  24  26
  27  24
  24  29
  24  30
  25  26
  27  25
  28  25
  26  27
  26  30
  27  30
  29  28
  28  30
0
   4   1
   7   1
   1  10
   1  11
   1  13
  15   1
  18   1
   1  19
  20   1
  22   1
  23   1
  24   1
   1  28
  30   1
   2   4
   6   2
   8   2
   9   2
   2  10
  11   2
  12   2
   2  16
   2  18
  20   2
   2  21
  22   2
  23   2
   2  24
  26   2
   2  27
  28   2
   2  29
  30   2
   5   3
   8   3
   3   9
  10   3
   3  11
   3  12
  13   3
  14   3
   3  15
  17   3
  18   3
  19   3
  20   3
  23   3
  24   3
   3  25
  26   3
  27   3
   3  30
   6   4
   4   9
  10   4
   4  15
   4  16
   4  19
  20   4
  21   4
  26   4
  27   4
   4  28
   4  29
   4  30
   6   5
   5   7
   5   8
   9   5
  10   5
  16   5
   5  18
   5  20
  21   5
   5  24
  25   5
  26   5
   5  28
  30   5
   7   6
   6   8
   9   6
   6  10
   6  11
   6  12
  13   6
  14   6
   6  16
   6  17
   6  20
  21   6
  23   6
  24   6
  25   6
  26   6
  28   6
  29   6
   6  30
   7   8
  11   7
   7  12
  14   7
  18   7
   7  19
  20   7
  22   7
  25   7
   7  26
   7  28
  29   7
   7  30
   8   9
   8  10
  12   8
  13   8
  15   8
   8  16
  18   8
   8  19
  21   8
   8  22
   8  24
  25   8
   8  26
   8  28
  10   9
  11   9
   9  12
  13   9
   9  14
  16   9
  19   9
  20   9
   9  21
  22   9
   9  27
   9  28
   9  29
  10  11
  10  12
  10  13
  14  10
  15  10
  10  16
  10  18
  10  19
  20  10
  10  21
  23  10
  10  24
  25  10
  10  26
  10  27
  10  28
  29  10
  10  30
  13  11
  14  11
  15  11
  16  11
  18  11
  21  11
  11  22
  23  11
  27  11
  29  11
  30  11
  13  12
  12  15
  16  12
  12  20
  12  21
  24  12
  12  26
  12  27
  15  13
  17  13
  13  18
  13  19
  20  13
  23  13
  24  13
  13  28
  13  29
  14  16
  17  14
  14  18
  20  14
  14  22
  14  24
  14  25
  27  14
  14  28
  14  29
  16  15
  21  15
  22  15
  25  15
  26  15
  15  27
  15  29
  30  15
  17  16
  16  18
  16  19
  20  16
  21  16
  22  16
  23  16
  24  16
  25  16
  26  16
  16  28
  18  17
  20  17
  21  17
  23  17
  24  17
  17  25
  26  17
  17  27
  17  28
  29  17
  30  17
  18  19
  18  20
  18  21
  22  18
  24  18
  18  26
  18  27
  18  28
  18  29
  30  18
  19  20
  21  19
  19  22
  19  23
  24  19
  19  27
  28  19
  29  19
  20  21
  22  20
  20  23
  20  25
  27  20
  28  20
  29  20
  20  30
  21  24
  25  21
  21  27
  28  21
  29  21
  30  21
  23  22
  24  22
  22  27
  28  22
  24  23
  23  25
  23  26
  23  27
  29  23
  30  23
  24  26
  27  24
  24  29
  24  30
  25  26
  27  25
  28  25
  26  27
  26  30
  27  30
  29  28
  28  30









