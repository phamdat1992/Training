{\rtf1\ansi \deff41\deflang1033{\fonttbl{\f0\froman\fcharset0\fprq2 Tms Rmn;}{\f1\froman\fcharset2\fprq2 Symbol;}{\f2\fswiss\fcharset0\fprq2 Helv;}{\f3\fmodern\fcharset0\fprq1 Courier{\*\falt Courier New};}
{\f4\froman\fcharset0\fprq2 Times New Roman;}{\f5\fswiss\fcharset0\fprq2 Arial;}{\f6\froman\fcharset0\fprq2 MS Serif;}{\f7\fswiss\fcharset0\fprq2 MS Sans Serif;}{\f8\froman\fcharset0\fprq2 Times;}{\f9\fswiss\fcharset0\fprq2 Helvetica;}
{\f10\fswiss\fcharset0\fprq2 System;}{\f11\fmodern\fcharset0\fprq1 Courier New;}{\f12\froman\fcharset0\fprq2 New York;}{\f13\fswiss\fcharset0\fprq2 Geneva;}{\f14\fnil\fcharset2\fprq2 Marlett;}{\f15\fnil\fcharset2\fprq2 Wingdings;}
{\f16\froman\fcharset2\fprq2 MT Extra;}{\f17\fswiss\fcharset0\fprq2 Arial Narrow;}{\f18\fswiss\fcharset0\fprq2 Arial Black;}{\f19\fswiss\fcharset0\fprq2 Arial Rounded MT Bold;}{\f20\froman\fcharset0\fprq2 Book Antiqua;}
{\f21\froman\fcharset0\fprq2 Bookman Old Style;}{\f22\fswiss\fcharset0\fprq2 Century Gothic;}{\f23\froman\fcharset0\fprq2 Century Schoolbook;}{\f24\fnil\fcharset2\fprq2 Monotype Sorts;}{\f25\froman\fcharset0\fprq2 Map Symbols;}
{\f26\fswiss\fcharset0\fprq2 Haettenschweiler;}{\f27\fdecor\fcharset0\fprq2 Algerian;}{\f28\fdecor\fcharset0\fprq2 Braggadocio;}{\f29\fswiss\fcharset0\fprq2 Britannic Bold;}{\f30\fscript\fcharset0\fprq2 Brush Script MT;}
{\f31\fdecor\fcharset0\fprq2 Colonna MT;}{\f32\fdecor\fcharset0\fprq2 Desdemona;}{\f33\froman\fcharset0\fprq2 Footlight MT Light;}{\f34\froman\fcharset0\fprq2 Garamond;}{\f35\fswiss\fcharset0\fprq2 Impact;}{\f36\fdecor\fcharset0\fprq2 Kino MT;}
{\f37\froman\fcharset0\fprq2 Wide Latin;}{\f38\fscript\fcharset0\fprq2 Matura MT Script Capitals;}{\f39\fdecor\fcharset0\fprq2 Playbill;}{\f40\fmodern\fcharset2\fprq1 MS LineDraw;}{\f41\fswiss\fcharset0\fprq2 .VnTime;}
{\f42\fswiss\fcharset0\fprq2 .VnTimeH;}{\f43\fswiss\fcharset0\fprq2 .VnArial;}{\f44\fswiss\fcharset0\fprq2 .VnArialH;}{\f45\froman\fcharset0\fprq2 .VnCourier New;}{\f46\froman\fcharset0\fprq2 .VnCourier NewH;}
{\f47\fswiss\fcharset0\fprq2 .VnBook-AntiquaH;}{\f48\fswiss\fcharset0\fprq2 .VnArabiaH;}{\f49\fswiss\fcharset0\fprq2 .VnArial Narrow;}{\f50\fswiss\fcharset0\fprq2 .VnAristoteH;}{\f51\fswiss\fcharset0\fprq2 .VnAvantH;}
{\f52\fswiss\fcharset0\fprq2 .VnBahamasBH;}{\f53\fswiss\fcharset0\fprq2 .VnBlackH;}{\f54\fswiss\fcharset0\fprq2 .VnBodoniH;}{\f55\fswiss\fcharset0\fprq2 .VnCentury SchoolbookH;}{\f56\fswiss\fcharset0\fprq2 .VnClarendonH;}
{\f57\fswiss\fcharset0\fprq2 .VnCommercial ScriptH;}{\f58\fswiss\fcharset0\fprq2 .VnCooperH;}{\f59\fswiss\fcharset0\fprq2 .VnMonotype corsivaH Italic;}{\f60\fswiss\fcharset0\fprq2 .VnExoticH;}{\f61\fswiss\fcharset0\fprq2 .VnFreeH;}
{\f62\fswiss\fcharset0\fprq2 .VnGothicH;}{\f63\fswiss\fcharset0\fprq2 .VnHelvetInsH;}{\f64\fswiss\fcharset0\fprq2 .VnKoalaH;}{\f65\fswiss\fcharset0\fprq2 .VnLincolnH;}{\f66\fswiss\fcharset0\fprq2 .VnLinusH;}{\f67\fswiss\fcharset0\fprq2 .VnMemorandumH;}
{\f68\fswiss\fcharset0\fprq2 .VnMysticalH;}{\f69\fswiss\fcharset0\fprq2 .VnParkH;}{\f70\fswiss\fcharset0\fprq2 .VnPresentH;}{\f71\fswiss\fcharset0\fprq2 .VnRevueH;}{\f72\fswiss\fcharset0\fprq2 .VnSouthernH;}{\f73\fswiss\fcharset0\fprq2 .VnTeknicalH;}
{\f74\fswiss\fcharset0\fprq2 .VnTifani Heavy;}{\f75\fswiss\fcharset0\fprq2 .VnUniverseH;}{\f76\fswiss\fcharset0\fprq2 .VnVogueH;}{\f77\fswiss\fcharset0\fprq2 .Vn3DH;}{\f78\fswiss\fcharset0\fprq2 .VnBook-Antiqua;}{\f79\fswiss\fcharset0\fprq2 .VnArabia;}
{\f80\fswiss\fcharset0\fprq2 .VnAristote;}{\f81\fswiss\fcharset0\fprq2 .VnAvant;}{\f82\fswiss\fcharset0\fprq2 .VnBahamasB;}{\f83\fswiss\fcharset0\fprq2 .VnBlack;}{\f84\fswiss\fcharset0\fprq2 .VnBodoni;}{\f85\fswiss\fcharset0\fprq2 .VnCentury Schoolbook;}
{\f86\fswiss\fcharset0\fprq2 .VnClarendon;}{\f87\fswiss\fcharset0\fprq2 .VnCommercial Script;}{\f88\fswiss\fcharset0\fprq2 .VnCooper;}{\f89\fswiss\fcharset0\fprq2 .VnMonotype corsiva;}{\f90\fswiss\fcharset0\fprq2 .VnCourier;}
{\f91\fswiss\fcharset0\fprq2 .VnExotic;}{\f92\fswiss\fcharset0\fprq2 .VnFree;}{\f93\fswiss\fcharset0\fprq2 .VnHelvetIns;}{\f94\fswiss\fcharset0\fprq2 .VnKoala;}{\f95\fswiss\fcharset0\fprq2 .VnLincoln;}{\f96\fswiss\fcharset0\fprq2 .VnLinus;}
{\f97\fswiss\fcharset0\fprq2 .VnLucida sans;}{\f98\fswiss\fcharset0\fprq2 .VnMemorandum;}{\f99\fswiss\fcharset0\fprq2 .VnMystical;}{\f100\fswiss\fcharset0\fprq2 .VnPark;}{\f101\fswiss\fcharset0\fprq2 .VnPresent;}{\f102\fswiss\fcharset0\fprq2 .VnRevue;}
{\f103\fswiss\fcharset0\fprq2 .VnSouthern;}{\f104\fswiss\fcharset0\fprq2 .VnStamp;}{\f105\fswiss\fcharset0\fprq2 .VnTeknical;}{\f106\fswiss\fcharset0\fprq2 .VnUniverse;}{\f107\fswiss\fcharset0\fprq2 .VnVogue;}{\f108\fmodern\fcharset255\fprq2 Modern;}
{\f109\fswiss\fcharset0\fprq1 MS Dialog;}{\f110\fswiss\fcharset0\fprq2 Tahoma;}{\f111\froman\fcharset128\fprq1 MS Mincho{\*\falt ?? ??};}{\f112\fswiss\fcharset0\fprq2 .VnArial NarrowH;}{\f113\fswiss\fcharset0\fprq2 .VnGothic;}
{\f114\fswiss\fcharset0\fprq2 .VnMonotype corsivaH;}{\f115\fdecor\fcharset0\fprq2 .VnShelley Allegro;}{\f116\fswiss\fcharset0\fprq2 .VnTifani HeavyH;}{\f117\fnil\fcharset0\fprq2 VNI-Aptima;}{\f118\fnil\fcharset0\fprq2 VNI-Auchon;}
{\f119\fnil\fcharset0\fprq2 VNI-Brush;}{\f120\fnil\fcharset0\fprq2 VNI-Centur;}{\f121\fnil\fcharset0\fprq2 VNI-Cooper;}{\f122\fnil\fcharset0\fprq2 VNI-Couri;}{\f123\fnil\fcharset0\fprq2 VNI-Helve;}{\f124\fnil\fcharset0\fprq2 VNI-Helve-Condense;}
{\f125\fnil\fcharset0\fprq2 VNI-Maria;}{\f126\fnil\fcharset0\fprq2 VNI-Present;}{\f127\fnil\fcharset0\fprq2 VNI-Revue;}{\f128\fnil\fcharset0\fprq2 VNI-Script;}{\f129\fnil\fcharset0\fprq2 VNI-Tekon;}{\f130\fnil\fcharset0\fprq2 VNI-Times;}
{\f131\fnil\fcharset0\fprq2 VNI-Univer;}{\f132\fswiss\fcharset0\fprq2 Verdana;}{\f133\froman\fcharset0\fprq2 Palatino Linotype;}{\f134\fscript\fcharset0\fprq2 Comic Sans MS;}{\f135\froman\fcharset0\fprq0 ?? ??;}
{\f136\fswiss\fcharset0\fprq2 VS1 Arial{\*\falt Courier New};}{\f137\froman\fcharset2\fprq2 Wingdings 2;}{\f138\froman\fcharset238\fprq2 Times New Roman CE;}{\f139\froman\fcharset204\fprq2 Times New Roman Cyr;}
{\f140\froman\fcharset161\fprq2 Times New Roman Greek;}{\f141\froman\fcharset162\fprq2 Times New Roman Tur;}{\f142\froman\fcharset186\fprq2 Times New Roman Baltic;}{\f143\fmodern\fcharset238\fprq1 Courier New CE;}
{\f144\fmodern\fcharset204\fprq1 Courier New Cyr;}{\f145\fmodern\fcharset161\fprq1 Courier New Greek;}{\f146\fmodern\fcharset162\fprq1 Courier New Tur;}{\f147\fmodern\fcharset186\fprq1 Courier New Baltic;}{\f148\fswiss\fcharset238\fprq2 .VnTime CE;}
{\f149\fswiss\fcharset204\fprq2 .VnTime Cyr;}{\f150\fswiss\fcharset161\fprq2 .VnTime Greek;}{\f151\fswiss\fcharset186\fprq2 .VnTime Baltic;}{\f152\fswiss\fcharset238\fprq2 .VnTimeH CE;}{\f153\fswiss\fcharset204\fprq2 .VnTimeH Cyr;}
{\f154\fswiss\fcharset161\fprq2 .VnTimeH Greek;}{\f155\fswiss\fcharset186\fprq2 .VnTimeH Baltic;}{\f156\froman\fcharset2\fprq2 Webdings{\*\falt Symbol};}{\f157\froman\fcharset204\fprq0 ?? ?? Cyr;}{\f158\froman\fcharset161\fprq0 ?? ?? Greek;}
{\f159\fswiss\fcharset0\fprq2 VnTimeU;}{\f160\fswiss\fcharset0\fprq2 VnTime;}{\f161\fswiss\fcharset238\fprq2 Tahoma CE;}{\f162\fswiss\fcharset204\fprq2 Tahoma Cyr;}{\f163\fswiss\fcharset161\fprq2 Tahoma Greek;}{\f164\fswiss\fcharset162\fprq2 Tahoma Tur;}
{\f165\fswiss\fcharset186\fprq2 Tahoma Baltic;}{\f166\fswiss\fcharset162\fprq2 .VnTimeH Tur;}{\f167\fswiss\fcharset238\fprq2 Arial Narrow CE;}{\f168\fswiss\fcharset204\fprq2 Arial Narrow Cyr;}{\f169\fswiss\fcharset161\fprq2 Arial Narrow Greek;}
{\f170\fswiss\fcharset162\fprq2 Arial Narrow Tur;}{\f171\fswiss\fcharset186\fprq2 Arial Narrow Baltic;}{\f172\fswiss\fcharset238\fprq2 Arial Black CE;}{\f173\fswiss\fcharset204\fprq2 Arial Black Cyr;}{\f174\fswiss\fcharset161\fprq2 Arial Black Greek;}
{\f175\fswiss\fcharset162\fprq2 Arial Black Tur;}{\f176\fswiss\fcharset186\fprq2 Arial Black Baltic;}{\f177\froman\fcharset238\fprq2 Bookman Old Style CE;}{\f178\froman\fcharset204\fprq2 Bookman Old Style Cyr;}
{\f179\froman\fcharset161\fprq2 Bookman Old Style Greek;}{\f180\froman\fcharset162\fprq2 Bookman Old Style Tur;}{\f181\froman\fcharset186\fprq2 Bookman Old Style Baltic;}{\f182\froman\fcharset238\fprq2 Garamond CE;}
{\f183\froman\fcharset204\fprq2 Garamond Cyr;}{\f184\froman\fcharset161\fprq2 Garamond Greek;}{\f185\froman\fcharset162\fprq2 Garamond Tur;}{\f186\froman\fcharset186\fprq2 Garamond Baltic;}{\f187\fswiss\fcharset238\fprq2 Impact CE;}
{\f188\fswiss\fcharset204\fprq2 Impact Cyr;}{\f189\fswiss\fcharset161\fprq2 Impact Greek;}{\f190\fswiss\fcharset162\fprq2 Impact Tur;}{\f191\fswiss\fcharset186\fprq2 Impact Baltic;}{\f192\fswiss\fcharset162\fprq2 .VnArial Tur;}
{\f193\fswiss\fcharset238\fprq2 .VnLincolnH CE;}{\f194\fswiss\fcharset162\fprq2 .VnLincolnH Tur;}{\f195\fdecor\fcharset162\fprq2 .VnShelley Allegro Tur;}{\f196\fnil\fcharset162\fprq2 VNI-Times Tur;}{\f197\fswiss\fcharset238\fprq2 Verdana CE;}
{\f198\fswiss\fcharset204\fprq2 Verdana Cyr;}{\f199\fswiss\fcharset161\fprq2 Verdana Greek;}{\f200\fswiss\fcharset162\fprq2 Verdana Tur;}{\f201\fswiss\fcharset186\fprq2 Verdana Baltic;}{\f202\froman\fcharset238\fprq2 Palatino Linotype CE;}
{\f203\froman\fcharset204\fprq2 Palatino Linotype Cyr;}{\f204\froman\fcharset161\fprq2 Palatino Linotype Greek;}{\f205\froman\fcharset162\fprq2 Palatino Linotype Tur;}{\f206\froman\fcharset186\fprq2 Palatino Linotype Baltic;}}
{\colortbl;\red0\green0\blue0;\red0\green0\blue255;\red0\green255\blue255;\red0\green255\blue0;\red255\green0\blue255;\red255\green0\blue0;\red255\green255\blue0;\red255\green255\blue255;\red0\green0\blue128;\red0\green128\blue128;\red0\green128\blue0;
\red128\green0\blue128;\red128\green0\blue0;\red128\green128\blue0;\red128\green128\blue128;\red192\green192\blue192;}{\stylesheet{\qj\widctlpar \f41\fs28\lang2057 \snext0 Normal;}{\s1\qj\li2160\keepn\widctlpar \b\f46\fs28\lang2057 \sbasedon0\snext0 
heading 1;}{\s2\qj\keepn\widctlpar \f51\fs20\ul \sbasedon0\snext0 heading 2;}{\*\cs10 \additive Default Paragraph Font;}{\s15\qj\fi720\widctlpar \f41 \sbasedon0\snext15 Body Text 2;}{\s16\qj\widctlpar \f11\fs20 \sbasedon0\snext16 Plain Text;}{\*\cs17 
\additive\f11\fs20  Typewriter;}{\s18\qj\widctlpar \f41\fs22 \sbasedon0\snext18 Body Text;}{\s19\widctlpar\tqc\tx4320\tqr\tx8640 \f41\lang2057 \sbasedon0\snext19 footer;}{\*\cs20 \additive\sbasedon10 page number;}{\s21\widctlpar\tqc\tx4320\tqr\tx8640 
\f41\lang2057 \sbasedon0\snext21 header;}{\s22\qc\widctlpar \b\f51 \sbasedon0\snext22 Title;}{\s23\sb100\sa100\widctlpar \f41\cf1 \sbasedon0\snext23 Body Text Indent 2;}}{\*\revtbl {Unknown;}}{\info{\title c\'b8c b\'b5i to\'b8n h\'d7nh h\'e4c}{\author Chuyen Toan Tin}
{\operator ChuyenToan}{\creatim\yr2003\mo4\dy21\hr17\min14}{\revtim\yr2003\mo4\dy21\hr4\min57}{\printim\yr2003\mo4\dy21\hr4\min52}{\version3}{\edmins7}{\nofpages40}{\nofwords9314}{\nofchars53090}{\*\company DHKHTN}{\vern57431}}
\paperw11909\paperh16834\margl1728\margr1728 \widowctrl\ftnbj\aenddoc\hyphcaps0\formshade \fet0\sectd \psz9\linex0\headery432\footery1152\endnhere {\*\pnseclvl1\pnucrm\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl2
\pnucltr\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl3\pndec\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl4\pnlcltr\pnstart1\pnindent720\pnhang{\pntxta )}}{\*\pnseclvl5\pndec\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl6
\pnlcltr\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl7\pnlcrm\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl8\pnlcltr\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl9\pnlcrm\pnstart1\pnindent720\pnhang
{\pntxtb (}{\pntxta )}}\pard\plain \qc\widctlpar \f41\fs28\lang2057 {\b\f42 ch\'ad\'acng 1. c\'b8c b\'b5i to\'b8n h\'d7nh h\'e4c
\par }\pard \qj\widctlpar {\b 1. Nh\'bec l\'b9i m\'e9t s\'e8 ki\'d5n th\'f8c h\'d7nh h\'e4c
\par }Gi\'b6 s\'f6 r\'bbng \'ae\'e9c gi\'b6 \'ae\'b7 bi\'d5t c\'b8c kh\'b8i ni\'d6m c\'ac b\'b6n nh\'ad
\par {\pntext\pard\plain\f1\fs28 \'b7\tab}\pard \qj\fi-360\li360\widctlpar{\*\pn \pnlvlblt\pnf1\pnstart1\pnindent360\pnhang{\pntxtb \'b7}}\'a7i\'d3m, \'ae\'ad\'eang th\'bcng, \'aeo\'b9n th\'bcng, m\'c6t ph\'bcng, v\'de tr\'dd t\'ad\'acng \'ae\'e8i c\'f1a hai 
\'ae\'ad\'eang th\'bcng (c\'bet nhau, song song, tr\'efng nhau)
\par {\pntext\pard\plain\f1\fs28 \'b7\tab}Tr\'f4c s\'e8, h\'d6 to\'b9 \'ae\'e9 \'a7\'aa-c\'b8c tr\'aan m\'c6t ph\'bcng v\'b5 c\'b8c tr\'f4c to\'b9 \'ae\'e9, g\'e8c to\'b9 \'ae\'e9, Kho\'b6ng c\'b8ch gi\'f7a hai \'aei\'d3m, kho\'b6ng c\'b8ch t\'f5 m\'e9t \'aei
\'d3m \'ae\'d5n m\'e9t \'ae\'ad\'eang th\'bcng
\par {\pntext\pard\plain\f1\fs28 \'b7\tab}To\'b9 \'ae\'e9 \'aei\'d3m, ph\'ad\'acng tr\'d7nh \'ae\'ad\'eang th\'bcng
\par {\pntext\pard\plain\f1\fs28 \'b7\tab}Tam gi\'b8c v\'b5 h\'d7nh tam gi\'b8c, t\'f8 gi\'b8c v\'b5 h\'d7nh t\'f8 gi\'b8c, \'aea gi\'b8c v\'b5 h\'d7nh \'aea gi\'b8c, \'aea gi\'b8c l\'e5i
\par {\pntext\pard\plain\f1\fs28 \'b7\tab}\'a7\'ad\'eang tr\'dfn v\'b5 h\'d7nh tr\'dfn, c\'b8c \'ae\'ad\'eang tr\'dfn n\'e9i ti\'d5p, ngo\'b9i ti\'d5p v\'b5 b\'b5ng ti\'d5p c\'f1a m\'e9t tam gi\'b8c
\par {\pntext\pard\plain\f1\fs28 \'b7\tab}\'a7\'ad\'eang cao v\'b5 tr\'f9c t\'a9m c\'f1a m\'e9t tam gi\'b8c
\par {\pntext\pard\plain\f1\fs28 \'b7\tab}Trung tr\'f9c v\'b5 t\'a9m \'ae\'ad\'eang tr\'dfn ngo\'b9i ti\'d5p c\'f1a m\'e9t tam gi\'b8c
\par {\pntext\pard\plain\f1\fs28 \'b7\tab}Ph\'a9n gi\'b8c trong v\'b5 t\'a9m \'ae\'ad\'eang tr\'dfn n\'e9i ti\'d5p m\'e9t tam gi\'b8c, ph\'a9n gi\'b8c ngo\'b5i.
\par \pard \qj\widctlpar M\'e9t {\i \'ae\'ad\'eang g\'cap kh\'f3c} tr\'aan m\'c6t ph\'bcng g\'e5m m\'e9t d\'b7y li\'aan ti\'d5p c\'b8c \'aeo\'b9n th\'bcng [A{\sub 1},A{\sub 2}], [A{\sub 2},A{\sub 3}], . . ., [A{\sub K-1},A{\sub K}], m\'e7i \'aeo\'b9n th\'bcng 
\'ae\'ad\'eec g\'e4i l\'b5 m\'e9t {\i c\'b9nh}, c\'b8c \'ae\'c7u m\'f3t c\'f1a c\'b8c \'aeo\'b9n th\'bcng \'ae\'ad\'eec g\'e4i l\'b5 {\i \'ae\'d8nh}. M\'e9t {\i \'aea gi\'b8c} l\'b5 m\'e9t \'ae\'ad\'eang g\'cap kh\'f3c kh\'d0p k\'ddn t\'f8c l\'b5 \'aei
\'d3m A{\sub K} tr\'efng v\'edi A{\sub 1}. M\'e9t \'aea gi\'b8c \'ae\'ad\'eec g\'e4i l\'b5 {\i t\'f9 c\'bet} n\'d5u c\'e3 hai c\'b9nh kh\'abng li\'aan ti\'d5p c\'e3 \'aei\'d3m chung. M\'e9t \'aea gi\'b8c \'ae\'ad\'eec g\'e4i l\'b5 {\i l\'e5i} n\'d5u \'ae
a gi\'b8c lu\'abn n\'bbm c\'efng m\'e9t ph\'dda \'ae\'e8i v\'edi  \'ae\'ad\'eang th\'bcng \'aei qua m\'e9t c\'b9nh b\'cat k\'fa c\'f1a \'aea gi\'b8c, m\'e9t \'aea gi\'b8c l\'e5i kh\'abng t\'f9 c\'bet.
\par {\b\ul\lang1033 B\'b5i to\'b8n 7:}{\lang1033  Cho \'aea gi\'b8c g\'e5m N \'ae\'d8nh d[1],d[2],...,d[n] v\'b5 \'aei\'d3m M. H\'b7y x\'b8c \'ae\'denh v\'de tr\'dd t\'ad\'acng \'ae\'e8i c\'f1a M v\'edi mi\'d2n trong c\'f1a \'aea gi\'b8c (ngh\'dca l\'b5 x\'d0
t \'aei\'d3m M thu\'e9c hay kh\'abng thu\'e9c mi\'d2n \'aea gi\'b8c)
\par }{\i\lang1033 G\'eei \'fd}{\lang1033 
\par }\pard \qj\fi-360\li360\widctlpar\tx360 {\f1\lang1033 \'b7\tab }{\lang1033 T\'cat nhi\'aan n\'d5u M thu\'e9c m\'e9t c\'b9nh th\'d7 M thu\'e9c mi\'d2n \'aea gi\'b8c
\par }{\f1\lang1033 \'b7\tab }{\lang1033 Ng\'ad\'eec l\'b9i: K\'ce \'aeo\'b9n th\'bcng MN song song tr\'f4c ho\'b5nh sao cho ho\'b5nh \'ae\'e9 c\'f1a N l\'edn h\'acn max c\'f1a c\'b8c ho\'b5nh \'ae\'e9 \'ae\'d8nh \'aea gi\'b8c.  X\'d0t giao c\'b8c c\'b9nh c
\'f1a \'aea gi\'b8c v\'edi \'aeo\'b9n th\'bcng MN. S\'e8 giao \'aei\'d3m l\'b5 l\'ce th\'d7 M trong \'aea gi\'b8c, l\'b5  ch\'bdn th\'d7 M ngo\'b5i \'aea gi\'b8c. X\'d0t c\'b9nh (d[i], d[i+1]) c\'e3 nh\'f7ng tr\'ad\'eang h\'eep sau \'ae\'a9y \'ae\'ad\'ee
c coi nh\'ad t\'a8ng th\'aam 1 giao \'aei\'d3m:
\par }\pard\plain \s18\qj\fi-360\li1080\widctlpar\tx1080 \f41\fs22 {\fs28 1.\tab \'a7\'d8nh d[i] kh\'abng thu\'e9c \'aeo\'b9n th\'bcng MN, nh\'adng d[i+1] n\'bbm tr\'aan \'aeo\'b9n th\'bcng MN, d[i] v\'b5 d[i+2] kh\'b8c ph\'dda nhau so v\'edi \'ae\'ad\'eang th
\'bcng MN 
\par }\pard\plain \qj\fi-360\li1080\widctlpar\tx1080 \f41\fs28\lang2057 {\lang1033 2.\tab \'a7\'d8nh d[i-1], d[i+2] ngo\'b5i \'aeo\'b9n th\'bcng MN, nh\'adng \'ae\'d8nh d[i] v\'b5 d[i+1] thu\'e9c \'aeo\'b9n th\'bcng MN,  d[i-1] v\'b5 d[i+2] kh\'b8c ph\'dd
a nhau so v\'edi \'ae\'ad\'eang th\'bcng MN
\par 3.\tab \'a7\'d8nh d[i] v\'b5 d[i+1] kh\'abng thu\'e9c MN v\'b5 c\'b9nh (d[i], d[i+1]) c\'bet \'aeo\'b9n th\'bcng MN
\par }\pard\plain \s16\qj\widctlpar \f11\fs20 {\b\f45 uses   crt;
\par const  fi     = 'dagiac.inp';
\par        fo     = 'dagiac.out';
\par        maxd   = 50;
\par type   diem   = record x,y : real; end;
\par        dagiac = array[0..maxd] of diem;
\par        doanthang = record d,c : diem; end;
\par var    M,N    : diem;
\par        dg     : dagiac;
\par        sl     : byte;
\par        g      : text;
\par        dem    : integer;
\par procedure nhap;
\par     var f : text;
\par         i : byte;
\par         x_max : real;
\par     begin
\par         x_max := -maxint;
\par         assign(f,fi);
\par         reset(f);
\par         readln(f,sl);
\par         for i:=1 to sl do
\par         begin
\par             readln(f,dg[i].x,dg[i].y);
\par             if dg[i].x>x_max then x_max := dg[i].x;
\par         end;
\par         readln(f,M.x,M.y);
\par 
\par         N.x := x_max+1;
\par         if N.x <= M.x then N.x := N.x + 1;
\par         N.y := M.y;
\par         close(f);
\par     end;
\par function f(l : doanthang; d : diem): real;
\par     var a,b,c : real;
\par     begin
\par         a := l.c.y-l.d.y;
\par         b := l.d.x-l.c.x;
\par         c := l.d.y*l.c.x - l.d.x*l.c.y;
\par         f := a*d.x + b*d.y +c;
\par     end;
\par function max(a,b : real): real;
\par     begin
\par         if a>b then max:= a else max := b;
\par     end;
\par function min(a,b : real): real;
\par     begin
\par         if a<b then min:= a else min:= b;
\par     end;
\par function diem_thuoc_doanthang(d: diem;l : doanthang) : boolean;
\par     var a,b,c : real;
\par         ok,ok1,ok2 : boolean;
\par     begin
\par         ok  := f(l,d)=0;
\par         ok1 := (min(l.d.x,l.c.x)<=d.x) and (d.x<=max(l.d.x,l.c.x));
\par         ok2 := (min(l.d.y,l.c.y)<=d.y) and (d.y<=max(l.d.y,l.c.y));
\par         diem_thuoc_doanthang := ok and ok1 and ok2;
\par     end;
\par function khacphia(l1,l2 : doanthang) : boolean;
\par     begin
\par         khacphia := false;
\par         if f(l1,l2.d)=0 then exit;
\par         if f(l1,l2.c)=0 then exit;
\par         if f(l2,l1.d)=0 then exit;
\par         if f(l2,l1.c)=0 then exit;
\par         khacphia := (f(l1,l2.d)*f(l1,l2.c)<0) and (f(l2,l1.d)*f(l2,l1.c)<0);
\par     end;
\par function trong : boolean;
\par     var  canh,MN : doanthang;
\par          i     : integer;
\par     begin
\par          dem    := 0;
\par          dg[0]   := dg[sl];
\par          dg[sl+1] := dg[1];
\par          dg[sl+2] := dg[2];
\par          MN.d  := m;
\par          MN.c  := n;
\par          for i:=1 to sl do
\par          begin
\par             canh.d  := dg[i];
\par             canh.c  := dg[i+1];
\par             if diem_thuoc_doanthang(M,canh) then
\par             begin
\par                  trong:= true;
\par                  exit;
\par             end;
\par             if diem_thuoc_doanthang(dg[i],MN) and
\par                diem_thuoc_doanthang(dg[i+1],MN) and
\par               ((dg[i-1].y-dg[i].y)*(dg[i+2].y-dg[i].y)<0) then
\par                                                      inc(dem)
\par             else
\par             if diem_thuoc_doanthang(dg[i+1],MN) and
\par                ((dg[i].y-m.y)*(dg[i+2].y-m.y)<0) then
\par                                                      inc(dem)
\par             else
\par             if khacphia(canh,MN) then
\par                                                      inc(dem);
\par          end;
\par          trong:= ((dem mod 2)=1) and (dem<>0);
\par     end;
\par BEGIN
\par     nhap;
\par     assign(g,fo);
\par     rewrite(g);
\par     writeln(g,dem);
\par     if trong then
\par          write(g,'M trong da giac')
\par     else write(g,'M o ngoai da giac');
\par     close(g);
\par END.
\par }\pard\plain \qj\widctlpar \f41\fs28\lang2057 Ng\'ad\'eai ta ch\'f8ng minh \'ae\'ad\'eec r\'bbng:
\par \pard \qj\li720\widctlpar V\'edi m\'e7i t\'cbp h\'f7u h\'b9n M c\'b8c \'aei\'d3m tr\'aan m\'c6t ph\'bcng, ta lu\'abn c\'e3 th\'d3 t\'d7m \'ae\'ad\'eec m\'e9t t\'cbp con H c\'f1a M sao cho H l\'b5 t\'cbp c\'b8c \'ae\'d8nh c\'f1a m\'e9t \'aea gi\'b8c l\'e5
i P v\'b5 m\'e4i \'aei\'d3m c\'f1a M \'ae\'d2u thu\'e9c h\'d7nh \'aea gi\'b8c n\'b5y. P \'ae\'ad\'eec g\'e4i l\'b5 {\i bao l\'e5i} c\'f1a t\'cbp \'aei\'d3m M. Vi\'d6c x\'b8c \'ae\'denh P t\'ad\'acng \'ae\'ad\'acng v\'edi vi\'d6c x\'b8c \'ae\'denh H n\'aa
n \'ae\'abi khi ta c\'f2ng g\'e4i H l\'b5 bao l\'e5i c\'f1a M.
\par \pard \qj\widctlpar C\'e3 nhi\'d2u thu\'cbt to\'b8n gi\'b6i b\'b5i to\'b8n t\'d7m bao l\'e5i. B\'b5i to\'b8n n\'b5y \'ae\'ad\'eec ph\'b8t bi\'d3u nh\'ad sau:
\par \pard \qj\li720\widctlpar {\i I. T\'cbp h\'f7u h\'b9n M c\'b8c \'aei\'d3m tr\'aan m\'c6t ph\'bcng
\par O. Bao l\'e5i H c\'f1a M.
\par }\pard \qj\widctlpar Sau \'ae\'a9y ta gi\'edi thi\'d6u m\'e9t thu\'cbt to\'b8n d\'d4 c\'b5i \'ae\'c6t v\'b5 c\'f2ng kh\'b8 hi\'d6u qu\'b6.
\par {\pntext\pard\plain\f41\fs28 1.\tab}\pard \qj\fi-360\li360\widctlpar{\*\pn \pnlvlbody\pndec\pnstart1\pnindent360\pnhang{\pntxta .}}S\'bep x\'d5p c\'b8c \'aei\'d3m c\'f1a M theo tung \'ae\'e9 kh\'abng t\'a8ng
\par {\pntext\pard\plain\f41\fs28 2.\tab}L\'c7n l\'ad\'eet ch\'e4n c\'b8c \'ae\'d8nh l\'cbp th\'b5nh \'aea gi\'b8c P
\par {\pntext\pard\plain\f1\fs28 \'b7\tab}\pard \qj\fi-360\li1080\widctlpar{\*\pn \pnlvlblt\pnf1\pnstart1\pnindent360\pnhang{\pntxtb \'b7}}Kh\'ebi t\'b9o: ch\'e4n \'ae\'d8nh th\'f8 nh\'cat l\'b5 \'aei\'d3m c\'e3 tung \'ae\'e9 l\'edn nh\'cat.
\par {\pntext\pard\plain\f1\fs28 \'b7\tab}L\'c6p: Gi\'b6 s\'f6 ta \'ae\'b7 ch\'e4n \'ae\'ad\'eec c\'b8c \'aei\'d3m A{\sub 1}, A{\sub 2}, A{\sub 3}, . . .,A{\sub I} tho\'b6 m\'b7n \'aei\'d2u ki\'d6n v\'edi m\'e4i J<I, t\'cbp M n\'bbm \'eb m\'e9t ph\'dda c\'f1a 
\'ae\'ad\'eang th\'bcng \'aei qua \'aeo\'b9n [A{\sub J},A{\sub J+1}]. Ch\'e4n \'aei\'d3m A{\sub I+1} tho\'b7 m\'b7n \'aei\'d2u ki\'d6n sau: ch\'ada \'ae\'ad\'eec ch\'e4n v\'b5 M n\'bbm \'eb m\'e9t ph\'dda c\'f1a \'ae\'ad\'eang th\'bcng \'aei qua \'aeo\'b9
n [A{\sub I},A{\sub I+1}].
\par \pard \qj\widctlpar {\b 2. M\'e9t s\'e8 di\'d2u c\'c7n ch\'f3 \'fd khi l\'cbp tr\'d7nh} 
\par Khi vi\'d5t ch\'ad\'acng tr\'d7nh gi\'b6i c\'b8c b\'b5i to\'b8n h\'d7nh h\'e4c tr\'aan m\'c6t ph\'bcng, ta c\'c7n l\'adu \'fd m\'e9t s\'e8 \'aei\'d3m sau.
\par 2.1. Th\'ad\'eang ta s\'cf ch\'e4n m\'e9t h\'d6 tr\'f4c to\'b9 \'ae\'e9 th\'ddch h\'eep \'ae\'d3 \'ae\'denh v\'de ho\'c6c x\'b8c \'ae\'denh c\'b8c y\'d5u t\'e8 h\'d7nh h\'e4c li\'aan quan. Khi \'ae\'e3, m\'e7i \'aei\'d3m s\'cf \'ae\'ad\'eec th\'d3 hi\'d6
n b\'ebi m\'e9t c\'c6p s\'e8 th\'f9c l\'b5 to\'b9 \'ae\'e9 c\'f1a \'aei\'d3m. C\'b8c sai l\'c7m ph\'e6 bi\'d5n th\'ad\'eang l\'b5 khi th\'f9c hi\'d6n ph\'d0p chia kh\'abng bi\'d6n lu\'cbn tr\'ad\'eang h\'eep s\'e8 chia b\'bbng 0 n\'aan b\'de l\'e7
i chia cho kh\'abng ({\i Division by zero}). Do \'ae\'e3 khi ki\'d3m tra c\'b8c \'aei\'d2u ki\'d6n h\'d7nh h\'e4c th\'d3 hi\'d6n qua c\'b8c to\'b9 \'ae\'e9, ta n\'aan tr\'b8nh vi\'d6c th\'f9c hi\'d6n ph\'d0p chia cho s\'e8 kh\'abng lu\'abn kh\'b8c kh\'ab
ng v\'b5 t\'d7m c\'b8ch thay b\'bbng c\'b8c \'aei\'aa\'ef ki\'d6n kh\'abng d\'efng ph\'d0p chia.
\par V\'dd d\'f4, \'aei\'d2u ki\'d6n \'ae\'d3 ba \'aei\'d3m A(X{\sub 1},Y{\sub 1}), B(X{\sub 2},Y{\sub 2}), C(X{\sub 3},Y{\sub 3}) th\'bcng h\'b5ng vi\'d5t d\'ad\'edi d\'b9ng t\'fb l\'d6 th\'f8c s\'cf l\'b5
\par \pard \qc\widctlpar (X{\sub 1}-X{\sub 2})/(Y{\sub 1}-Y{\sub 2})=(X{\sub 3}-X{\sub 3})/ (Y{\sub 1}-Y{\sub 3})\tab (*)
\par \pard \qj\widctlpar nh\'adng khi l\'cbp tr\'d7nh, ta n\'aan d\'efng \'aei\'d2u ki\'d6n t\'ad\'acng \'ae\'ad\'acng
\par \pard \qc\widctlpar (X{\sub 1}-X{\sub 2})*(Y{\sub 1}-Y{\sub 3})=(X{\sub 3}-X{\sub 3})* (Y{\sub 1}-Y{\sub 2})\tab (**)
\par \pard \qj\widctlpar M\'e9t v\'dd d\'f4 kh\'b8c, m\'e9t \'ae\'ad\'eang th\'bcng c\'e3 th\'d3 c\'e3 ph\'ad\'acng tr\'d7nh ch\'ddnh t\'bec, ph\'ad\'acng tr\'d7nh v\'edi h\'d6 s\'e8 g\'e3c, ph\'ad\'acng tr\'d7nh t\'e6ng qu\'b8t v\'b5 ph\'ad\'acng tr\'d7
nh tham s\'e8. N\'d5u d\'efng hai lo\'b9i ph\'ad\'acng tr\'d7nh \'ae\'c7u, khi \'ae\'ad\'eang th\'bcng song song v\'edi c\'b8c tr\'f4c to\'b9 \'ae\'e9, ta s\'cf b\'de l\'e7i chia cho kh\'abng.
\par 2.2. Ph\'ad\'acng tr\'d7nh \'ae\'ad\'eang th\'bcng
\par Ph\'ad\'acng tr\'d7nh t\'e6ng qu\'b8t c\'f1a \'ae\'ad\'eang th\'bcng c\'e3 d\'b9ng
\par \pard \qc\widctlpar {\i AX + BY + C =0 v\'edi A v\'b5 B kh\'abng \'ae\'e5ng th\'eai b\'bbng kh\'abng}
\par \pard \qj\widctlpar Vi\'d6c th\'d3 hi\'d6n \'ae\'ad\'eang th\'bcng b\'bbng ph\'ad\'acng tr\'d7nh t\'e6ng qu\'b8t c\'e3 nhi\'d2u c\'b8i l\'eei. D\'ef \'eb v\'de tr\'dd n\'b5o tr\'aan m\'c6t ph\'bcng to\'b9 \'ae\'e9, \'ae\'ad\'eang th\'bcng c\'f2ng c\'e3 ph
\'ad\'acng tr\'d7nh d\'b9ng t\'e6ng qu\'b8t.
\par Gi\'b6 s\'f6 (d) l\'b5 \'ae\'ad\'eang th\'bcng c\'e3 ph\'ad\'acng tr\'d7nh
\par \pard \qc\widctlpar A + BY + C = 0 (*)
\par \pard \qj\widctlpar ta c\'e3 c\'b8c k\'d5t qu\'b6 sau:
\par Kho\'b6ng c\'b8ch t\'f5 \'aei\'d3m (X{\sub 0},Y{\sub 0}) \'ae\'d5n (d) \'aeu\'eec cho b\'ebi c\'abng th\'f8c
\par \pard \qc\widctlpar h = {{\field{\*\fldinst SYMBOL 189 \\f "Symbol" \\s 14}{\fldrslt\f1\fs28}}}AX{\sub 0 }+ BY{\sub 0} + C{{\field{\*\fldinst SYMBOL 189 \\f "Symbol" \\s 14}{\fldrslt\f1\fs28}}}/{{\field{\*\fldinst SYMBOL 214 \\f "Symbol" \\s 14}{\fldrslt
\f1\fs28}}}(A{\super 2}+B{\super 2})
\par \pard\plain \s15\qj\widctlpar \f41 {\fs28 \'a7\'ad\'eang th\'bcng (d) chia m\'c6t ph\'bcng l\'b5m ba ph\'c7n r\'eai nhau: m\'e9t ph\'c7n g\'e5m c\'b8c \'aei\'d3m m\'b5 khi thay to\'b9 \'ae\'e9 v\'b5o v\'d5 tr\'b8i, gi\'b8 tr\'de nh\'cbn \'ae\'ad\'eec \'a9
m, m\'e9t ph\'c7n g\'e5m c\'b8c \'aei\'d3m m\'b5 khi thay to\'b9 \'ae\'e9 v\'b5o v\'d5 ph\'b6i, gi\'b8 tr\'de nh\'cbn \'ae\'ad\'eec d\'ad\'acng; m\'e7i ph\'c7n n\'b5y \'ae\'ad\'eec g\'e4i l\'b5 m\'e9t ph\'dda c\'f1a \'ae\'ad\'eang th\'bcng, ph\'c7n th\'f8
 ba ng\'a8n c\'b8ch hai ph\'c7n \'ae\'e3 g\'e5m c\'b8c \'aei\'d3m tr\'aan \'ae\'ad\'eang th\'bcng;
\par }\pard\plain \qj\widctlpar \f41\fs28\lang2057 Ph\'ad\'acng tr\'d7nh \'ae\'ad\'eang th\'bcng qua hai \'aei\'d3m kh\'b8c nhau. Gi\'b6 s\'f6 A(X{\sub 1},Y{\sub 1}) v\'b5 B(X{\sub 2},Y{\sub 2}) l\'b5 hai \'aei\'d3m kh\'b8c nhau. Ph\'ad\'acng tr\'d7nh t\'e6
ng qu\'b8t c\'f1a \'ae\'ad\'eang th\'bcng \'aei qua A v\'b5 B l\'b5
\par \pard \qc\widctlpar (Y{\sub 1}-Y{\sub 2})X + (X{\sub 2}-X{\sub 1})Y + (X{\sub 2}Y{\sub 1}-X{\sub 1}Y{\sub 2}) = 0
\par \pard \qj\widctlpar B\'b5i t\'cbp 1. Cho b\'e8n \'aei\'d3m kh\'b8c nhau t\'f5ng \'ae\'abi A(X{\sub 1},Y{\sub 1}), B(X{\sub 2},Y{\sub 2}), C(X{\sub 3},Y{\sub 3}), D(X{\sub 4},Y{\sub 4}). H\'b7y cho bi\'d5t hai \'aeo\'b9n AB v\'b5 CD c\'e3 c\'bet nhau t\'b9
i \'aei\'d3m kh\'b8c v\'edi c\'b8c \'ae\'c7u m\'f3t kh\'abng? D\'f7 li\'d6u v\'b5o \'ae\'ad\'eec cho b\'ebi file DC.INP g\'e5m b\'e8n d\'dfng, m\'e7i d\'dfng ghi hai s\'e8 l\'b5 to\'b9 \'ae\'e9 c\'f1a m\'e9t \'aei\'d3m theo th\'f8 t\'f9 A..D. K\'d5t qu
\'b6 ghi ra file DC.OUT s\'e8 1/0 tu\'fa theo hai \'aeo\'b9n AB v\'b5 CD c\'bet/kh\'abng c\'bet nhau t\'b9i \'aei\'d3m kh\'b8c v\'edi c\'b8c \'ae\'c7u m\'f3t.
\par C\'b8ch gi\'b6i. Gi\'b6 s\'f6 d{\sub 1}/d{\sub 2} t\'ad\'acng \'f8ng l\'b5 \'ae\'ad\'eang th\'bcng \'aei qua AB/CD. \'a7i\'d2u ki\'d6n c\'c7n v\'b5 \'ae\'f1 \'ae\'d3 AB v\'b5 CD c\'e3 \'aei\'d3m chung l\'b5 hai \'aei\'d3m A, B n\'bbm \'eb hai ph\'dda c
\'f1a d{\sub 2 }v\'b5 C, D n\'bbm \'eb hai ph\'dda c\'f1a d{\sub 1}.
\par Sau \'ae\'a9y l\'b5 ch\'ad\'acng tr\'d7nh gi\'b6i b\'b5i n\'b5y. \'a7\'d3 ghi nh\'cbn to\'b9 \'ae\'e9 c\'f1a b\'e8n \'aei\'d3m A..D, ta d\'efng hai m\'b6ng X, Y v\'edi c\'b8c ch\'d8 s\'e8 l\'b5 c\'b8c k\'fd t\'f9: 'a'..'d'.
\par \pard\plain \s16\qj\widctlpar \f11\fs20 {\b const
\par      fi='gd.inp';
\par      fo='gd.out';
\par var
\par    f:text;
\par    x,y:array['a'..'d'] of real;
\par    a,b,c:real;
\par procedure nhap;
\par var
\par    c:char;
\par begin
\par assign(f,fi);reset(f);
\par for c:='a' to 'd' do readln(f,x[c],y[c]);
\par close(f);
\par end;
\par procedure ptdt(p,q:char;var a,b,c:real);
\par begin
\par a:=y[p]-y[q];b:=x[q]-x[p];c:=x[q]*y[p]-x[p]*y[q];
\par end;
\par function khacphia(p,q:char;a,b,c:real):boolean;
\par begin
\par khacphia:=(a*x[p]+b*y[p]+c)*(a*x[q]+b*y[q]+c)<0;
\par end;
\par procedure lam;
\par begin
\par assign(f,fo);rewrite(f);
\par ptdt('a','b',a,b,c);
\par if khacphia('c','d',a,b,c) then
\par    begin
\par    ptdt('c','d',a,b,c);
\par    if khacphia('a','b',a,b,c) then
\par       begin
\par       writeln(f,1);exit;
\par       end;
\par    end;
\par writeln(f,0);
\par close(f);
\par end;
\par BEGIN
\par nhap;lam;
\par END.
\par }\pard\plain \qj\widctlpar \f41\fs28\lang2057 B\'b5i t\'cbp 1\rquote . Cho b\'e8n \'aei\'d3m kh\'b8c nhau t\'f5ng \'ae\'abi A(X{\sub 1},Y{\sub 1}), B(X{\sub 2},Y{\sub 2}), C(X{\sub 3},Y{\sub 3}), D(X{\sub 4},Y{\sub 4}). H\'b7y cho bi\'d5t hai \'aeo\'b9
n AB v\'b5 CD c\'e3 \'aei\'d3m chung kh\'abng? D\'f7 li\'d6u v\'b5o \'ae\'ad\'eec cho b\'ebi file DC.INP g\'e5m b\'e8n d\'dfng, m\'e7i d\'dfng ghi hai s\'e8 l\'b5 to\'b9 \'ae\'e9 c\'f1a m\'e9t \'aei\'d3m theo th\'f8 t\'f9 A..D. K\'d5t qu\'b6
 ghi ra file DC.OUT s\'e8 1/0 tu\'fa theo hai \'aeo\'b9n AB v\'b5 CD c\'e3/kh\'abng c\'bet nhau t\'b9i \'aei\'d3m kh\'b8c v\'edi c\'b8c \'ae\'c7u m\'f3t.
\par C\'b8ch gi\'b6i b\'b5i n\'b5y c\'f2ng t\'ad\'acng t\'f9 nh\'ad c\'b8ch gi\'b6i B\'b5i t\'cbp 1 ch\'d8 c\'e3 m\'e9t ch\'e7 kh\'b8c l\'b5 trong ph\'c7n ch\'ad\'acng tr\'d7nh con h\'b5m KHACPHIA, \'aei\'d2u ki\'d6n
\par \pard\plain \s16\qc\widctlpar \f11\fs20 {\b khacphia:=(a*x[p]+b*y[p]+c)*(a*x[q]+b*y[q]+c)<0;
\par }\pard\plain \qj\widctlpar \f41\fs28\lang2057 \'ae\'ad\'eec thay b\'bbng
\par \pard\plain \s16\qc\widctlpar \f11\fs20 {\b khacphia:=(a*x[p]+b*y[p]+c)*(a*x[q]+b*y[q]+c)<=0;
\par }\pard\plain \qj\widctlpar \f41\fs28\lang2057 {\b\ul\lang1033 B\'b5i to\'b8n 4}{\lang1033 : T\'d7m giao \'aei\'d3m (n\'d5u c\'e3)}{\b\lang1033  }{\lang1033 c\'f1a  hai \'ae\'ad\'eang th\'bcng c\'e3 ph\'ad\'acng tr\'d7nh t\'e6ng qu\'b8t:
\par }\pard \qc\widctlpar {\lang1033 A}{\lang1033\sub 1}{\lang1033 x + B}{\lang1033\sub 1}{\lang1033 y + C}{\lang1033\sub 1}{\lang1033  = 0 v\'b5 A}{\lang1033\sub 2}{\lang1033 x + B}{\lang1033\sub 2}{\lang1033 y + C}{\lang1033\sub 2}{\lang1033  = 0
\par }\pard \qj\widctlpar {\lang1033 C\'b8c h\'d6 s\'e8 c\'f1a ph\'ad\'acng tr\'d7nh nh\'cbp t\'f5 b\'b5n ph\'ddm, k\'d5t qu\'b6 th\'abng b\'b8o ra m\'b5n h\'d7nh.///
\par }{\i\lang1033 Ch\'ad\'acng tr\'d7nh:
\par }\pard\plain \s16\qj\widctlpar \f11\fs20 uses   crt;
\par var    a1,b1,c1,a2,b2,c2,x,y: real;
\par procedure nhap;
\par     begin
\par         write('nhap cac he so a1,b1,c1: ');readln(a1,b1,c1);
\par         write('nhap cac he so a2,b2,c2: ');readln(a2,b2,c2);
\par     end;
\par function giaodiem(a1,b1,c1,a2,b2,c2: real; var x,y: real): integer;
\par     var d,dx,dy: real;
\par     begin
\par         giaodiem:= -1;   {\i \{}{\i\f41 Hai \'ae\'ad\'eang th\'bcng song song\}
\par }        d := a1*b2-a2*b1;
\par         dx:= c2*b1-c1*b2;
\par         dy:= a2*c1-a1*c2;
\par         if d<>0 then
\par         begin
\par             x:= dx/d; y:= dy/d;{\i\f41  \{(x, y) l\'b5 to\'b9 \'ae\'e9 giao \'aei\'d3m\}} 
\par             giaodiem:= 1; {\i \{}{\i\f41 Hai \'ae\'ad\'eang th\'bcng c\'bet nhau\}}
\par         end
\par         else
\par         if (dx=0) and (dy=0) then
\par             giaodiem:= 0; {\i \{}{\i\f41 Hai \'ae\'ad\'eang th\'bcng tr\'efng nhau\}}
\par     end;
\par procedure ketluan;
\par     var gd: byte;
\par     begin
\par         gd:= giaodiem(a1,b1,c1,a2,b2,c2,x,y);
\par         if gd=1 then
\par             write('cat nhau tai diem  (',x:10:2,',',y:10:2,')')
\par         else
\par         if gd=0 then
\par             write('hai duong thang trung nhau ')
\par         else
\par             write('hai duong thang song song voi nhau ')
\par     end;
\par BEGIN
\par     clrscr;
\par     nhap;
\par     ketluan;
\par     readln
\par END.
\par \pard\plain \qj\widctlpar \f41\fs28\lang2057 B\'b5i t\'cbp 2. Cho m\'e9t h\'d7nh ch\'f7 nh\'cbt ABCD, A(X{\sub 1},Y{\sub 1}), B(X{\sub 2},Y{\sub 2}), C(X{\sub 3},Y{\sub 3}), D(X{\sub 4},Y{\sub 4}) v\'b5 hai \'aei\'d3m kh\'b8c nhau E(X{\sub 5},Y{\sub 5}
), F(X{\sub 6},Y{\sub 6}). H\'b7y cho bi\'d5t trong ba t\'d7nh hu\'e8ng sau, t\'d7nh hu\'e8ng n\'b5o x\'b6y ra:
\par {\pntext\pard\plain\f41\fs28 1.\tab}\pard \qj\fi-360\li1080\widctlpar{\*\pn \pnlvlbody\pndec\pnstart1\pnindent360\pnhang{\pntxta .}}\'a7o\'b9n EF n\'bbm trong h\'d7nh ch\'f7 nh\'cbt
\par {\pntext\pard\plain\f41\fs28 2.\tab}\'a7o\'b9n EF c\'e3 \'aei\'d3m thu\'e9c h\'d7nh ch\'f7 nh\'cbt v\'b5 c\'e3 \'aei\'d3m kh\'abng thu\'e9c h\'d7nh ch\'f7 nh\'cbt
\par {\pntext\pard\plain\f41\fs28 3.\tab}\'a7o\'b9n EF kh\'abng c\'e3 \'aei\'d3m chung v\'edi h\'d7nh ch\'f7 nh\'cbt
\par \pard \qj\widctlpar D\'f7 li\'d6u v\'b5o \'ae\'ad\'eec cho b\'ebi file DC.INP g\'e5m s\'b8u d\'dfng, m\'e7i d\'dfng ghi hai s\'e8 l\'b5 to\'b9 \'ae\'e9 c\'f1a m\'e9t \'aei\'d3m theo th\'f8 t\'f9 A..F. K\'d5t qu\'b6 ghi ra file DC.OUT s\'e8 1/2/3 tu\'fa
 theo t\'d7nh hu\'e8ng 1/2/3 x\'b6y ra.
\par C\'b8ch gi\'b6i. T\'d7nh hu\'e8ng 1 x\'b6y ra khi v\'b5 ch\'d8 khi c\'b6 hai \'aei\'d3m A v\'b5 B \'ae\'d2u n\'bbm trong h\'d7nh ch\'f7 nh\'cbt. T\'d7nh hu\'e8ng 2 x\'b6y ra khi v\'b5 ch\'d8 khi t\'d7nh hu\'e8ng 1 kh\'abng x\'b6y ra v\'b5 \'aeo\'b9n EF c
\'bet \'ddt nh\'cat m\'e9t c\'b9nh c\'f1a h\'d7nh ch\'f7 nh\'cbt theo ngh\'dca B\'b5i t\'cbp 1\rquote . N\'d5u kh\'abng x\'b6y ra t\'d7nh hu\'e8ng 1 ho\'c6c 2 th\'d7 t\'d7nh hu\'e8ng 3 x\'b6y ra.
\par {\b B\'b5i t\'cbp 3.} {\fs30 Tr\'aan m\'c6t ph\'bcng to\'b9 \'ae\'e9 c\'e3 N \'aei\'d3m P}{\fs30\sub 1}{\fs30 , . . ., P}{\fs30\sub N}{\fs30  v\'edi c\'b8c to\'b9 \'ae\'e9 nguy\'aan v\'edi tr\'de tuy\'d6t \'ae\'e8i kh\'abng qu\'b8 1000, N}{\fs30 
{\field{\*\fldinst SYMBOL 163 \\f "Symbol" \\s 15}{\fldrslt\f1\fs30}}}{\fs30 20. M\'e9t r\'ab b\'e8t b\'bet \'ae\'c7u chuy\'d3n \'ae\'e9ng t\'f5 P}{\fs30\sub 1}{\fs30  v\'b5 mu\'e8n th\'f9c hi\'d6n m\'e9t h\'b5nh tr\'d7nh \'aei qua N \'aei\'d3m, m\'e7i 
\'aei\'d3m \'ae\'f3ng m\'e9t l\'c7n v\'b5 t\'f5 \'aei\'d3m cu\'e8i c\'efng \'aei v\'d2 P}{\fs30\sub 1}{\fs30 . C\'b8ch \'aei c\'f1a r\'ab b\'e8t nh\'ad sau: r\'ab b\'abt mu\'e8n \'aei t\'f5 A \'ae\'d5n B l\'b5 hai trong s\'e8 N \'aei\'d3m th\'d7 tr\'aan 
\'aeo\'b9n AB ph\'b6i kh\'abng c\'e3 \'aei\'d3m n\'b5o kh\'b8c trong s\'e8 N \'aei\'d3m v\'b5 khi \'ae\'d5n B, r\'ab b\'e8t bu\'e9c ph\'b6i ho\'c6c quay tr\'b8i, ho\'c6c quay ph\'b6i m\'e9t g\'e3c 90}{\fs30\super 0}{\fs30  r\'e5i m\'edi ti\'d5p t\'f4c h
\'b5nh tr\'d7nh.
\par Li\'d6u r\'ab b\'e8t c\'e3 th\'d3 hay kh\'abng c\'e3 th\'d3 th\'f9c hi\'d6n m\'e9t h\'b5nh tr\'d7nh nh\'ad v\'cby.
\par D\'f7 li\'d6u v\'b5o \'ae\'ad\'eec cho b\'ebi file RB.INP trong \'ae\'e3 d\'dfng th\'f8 nh\'cat ghi s\'e8 N, trong N d\'dfng ti\'d5p theo, d\'dfng th\'f8 I ghi to\'b9 \'ae\'e9 c\'f1a \'aei\'d3m th\'f8 I.
\par K\'d5t qu\'b6 ghi ra file RB.OUT nh\'ad sau: d\'dfng th\'f8 nh\'cat ghi s\'e8 1/0 tu\'fa theo c\'e3 hay kh\'abng c\'e3 h\'b5nh tr\'d7nh; n\'d5u d\'dfng th\'f8 nh\'cat ghi s\'e8 1, trong c\'b8c d\'dfng ti\'d5p theo l\'c7n l\'ad\'eet ghi h\'b5nh tr\'d7nh b
\'bbng c\'b8c l\'d6nh sau:
\par H U V \{h\'ad\'edng \'ae\'d5n \'aei\'d3m to\'b9 \'ae\'e9 (U,V), l\'d6nh n\'b5y ch\'d8 xu\'cat hi\'d6n m\'e9t l\'c7n duy nh\'cat ban \'ae\'c7u \'ae\'d3 kh\'ebi t\'b9o h\'b5nh tr\'d7nh\}
\par MOVETO U V \{\'aei \'ae\'d5n \'aei\'d3m to\'b9 \'ae\'e9 (U,V), l\'d6nh n\'b5y ch\'d8 xu\'cat hi\'d6n m\'e9t l\'c7n duy nh\'cat ban \'ae\'c7u \'ae\'d3 kh\'ebi t\'b9o h\'b5nh tr\'d7nh\}
\par LT/RT \{Quay tr\'b8i/quay ph\'b6i\}
\par STOP \{L\'d6nh n\'b5y ch\'d8 xu\'cat hi\'d6n m\'e9t l\'c7n duy nh\'cat \'ae\'d3 k\'d5t th\'f3c h\'b5nh tr\'d7nh\}
\par }\pard \qj\fi720\widctlpar {\b\fs30 V\'dd d\'f4
\par }\pard \qj\li2160\widctlpar {\b\f45\fs30 RB.INP\tab \tab \tab RB.OUT
\par 4\tab \tab \tab \tab 1
\par 0\tab 0\tab \tab \tab H 0 1
\par 1\tab 1\tab \tab \tab MOVETO 0 1
\par 0\tab 1\tab \tab \tab RT
\par 1\tab 0\tab \tab \tab MOVETO 1 1
\par }\pard \qj\widctlpar {\b\f45\fs30 \tab \tab \tab \tab \tab \tab \tab RT
\par \tab \tab \tab \tab \tab \tab \tab MOVETO 1 0
\par \tab \tab \tab \tab \tab \tab \tab RT
\par \tab \tab \tab \tab \tab \tab \tab MOVETO 0 0
\par \tab \tab \tab \tab \tab \tab \tab STOP
\par }{\b 
\par Ch\'f3 \'fd chung v\'d2 di\'d4n bi\'d5n c\'f1a h\'b5nh tr\'d7nh
\par }Gi\'b6 s\'f6 r\'ab b\'e8t \'aei t\'f5 \'aei\'d3m P1 \'ae\'d5n \'aei\'d3m P2 v\'b5 tr\'aan \'ae\'ad\'eang vu\'abng g\'e3c v\'edi P1P2 t\'b9i P2 c\'e3 c\'b8c \'aei\'d3m P3, P4, P5, P6 nh\'ad h\'d7nh v\'cf.
\par 
\par \pard \qc\widctlpar P6\tab P5\tab P2\tab P3\tab P4
\par x\tab x\tab x\tab x\tab x
\par 
\par 
\par      x P1
\par \pard \qj\widctlpar 
\par Theo gi\'b6 thi\'d5t v\'d2 c\'b8ch chuy\'d3n \'ae\'e9ng c\'f1a r\'ab b\'e8t, r\'ab b\'e8t ch\'d8 c\'e3 th\'d3 ch\'e4n m\'e9t trong hai \'aei\'d3m P3 ho\'c6c P5 \'ae\'d3 \'aei \'ae\'d5n. N\'e3i c\'b8ch kh\'b8c, r\'ab b\'e8t s\'cf ch\'d8 c\'e3 th\'d3 \'aei 
\'ae\'d5n hai \'aei\'d3m g\'c7n P2 nh\'cat v\'d2 hai ph\'dda tr\'aan \'ae\'ad\'eang vu\'abng g\'e3c v\'edi P1P2. Nh\'ad v\'cby trong m\'e7i b\'ad\'edc c\'f1a h\'b5nh tr\'d7nh, m\'e7i l\'c7n t\'f5 P1 \'ae\'d5n P2 ch\'ad\'acng tr\'d7nh c\'c7n t\'d7m m\'e4i 
\'aei\'d3m tr\'aan d\'ad\'eang vu\'abng g\'e3c v\'edi P1P2 v\'b5 trong s\'e8 c\'b8c \'aei\'d3m \'ae\'e3, t\'d7m (kh\'abng qu\'b8 hai \'aei\'d3m) g\'c7n nh\'cat \'eb hai ph\'dda.
\par {\b Thu\'cbt to\'b8n:} D\'efng k\'fc thu\'cbt duy\'d6t k\'d5t h\'eep v\'edi quay lui \'ae\'d3 x\'d0t m\'e4i kh\'b6 n\'a8ng l\'f9a ch\'e4n h\'b5nh tr\'d7nh. Tuy nhi\'aan, trong ch\'ad\'acng tr\'d7nh, thu\'cbt to\'b8n n\'b5y kh\'abng th\'d3 hi\'d6n b\'ebi m
\'e9t ch\'ad\'acng tr\'d7nh con \'ae\'d6 quy. Ch\'ad\'acng tr\'d7nh con kh\'abng \'ae\'d6 quy XD trong ch\'ad\'acng tr\'d7nh con XL1 d\'efng m\'b6ng PHU \'ae\'d3 ghi nh\'cbn v\'b5 xem x\'d0t c\'b8c kh\'b6 n\'a8ng ph\'b8t tri\'d3n h\'b5nh tr\'d7nh c\'f1a r
\'ab b\'e8t.
\par {\b T\'e6 ch\'f8c ch\'ad\'acng tr\'d7nh}
\par \tab Ch\'ad\'acng tr\'d7nh \'ae\'ad\'eec t\'e6 ch\'f8c nh\'ad sau:
\par \tab 1. Th\'f1 t\'f4c INIT \'ae\'d3 \'ae\'e4c d\'f7 li\'d6u.
\par \tab 2. Th\'f1 t\'f4c XL1 g\'e5m:
\par - H\'b5m KC t\'ddnh kho\'b6ng c\'b8ch gi\'f7a hai \'aei\'d3m
\par - H\'b5m QUAY x\'b8c \'ae\'denh xem g\'e3c P1P2P3 c\'e3 vu\'abng t\'b9i P2 kh\'abng
\par - Th\'f1 t\'f4c XD t\'d7m c\'b8ch ti\'d5p t\'f4c h\'b5nh tr\'d7nh: c\'e3 nhi\'d2u nh\'cat hai c\'b8ch ti\'d5p t\'f4c h\'b5nh tr\'d7nh.
\par \tab - XD d\'efng hai ch\'ad\'acng tr\'d7nh con:
\par \tab \tab + H\'b5m OK x\'b8c \'ae\'denh xem hai \'aei\'d3m C1 v\'b5 C3 c\'e3 n\'bbm \'eb hai ph\'dda c\'f1a C2 kh\'abng.
\par \tab \tab + Th\'f1 t\'f4c VIET vi\'d5t k\'d5t qu\'b6 ra file.
\par \tab - XD s\'cf ch\'e4n ra (nhi\'d2u nh\'cat l\'b5 hai) c\'b8c \'aei\'d3m c\'e3 th\'d3 \'aei \'ae\'d5n, h\'b5nh tr\'d7nh \'ae\'ad\'eec ghi nh\'cbn v\'b5o h\'bbng bi\'d5n DD ki\'d3u m\'b6ng.
\par \tab Ch\'f3 \'fd: Trong th\'f1 t\'f4c VIET, khi vi\'d5t c\'b8c l\'d6nh thu\'e9c lo\'b9i 3 hay 4, \'aei\'d2u ki\'d6n \'ae\'d3 nh\'cbn bi\'d5t l\'b5 quay tr\'b8i hay quay ph\'b6i \'ae\'ad\'eec suy ra b\'bbng c\'b8ch d\'efng t\'ddch c\'e3 h\'ad\'edng c\'f1
a hai v\'d0c t\'ac.
\par {\b Ch\'ad\'acng tr\'d7nh}
\par {\b\f45\fs20 Const dd: Array[1..20] of integer
\par }\pard \qj\fi720\widctlpar {\b\f45\fs20 =(1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);
\par }\pard \qj\widctlpar {\b\f45\fs20 mes1= 'H' ;
\par mes2= 'MOVE-TO' ;
\par mes3= 'RT' ;
\par mes4= 'LT' ;
\par mes5= 'STOP' ;
\par type thd = array[1..20,1..2] of integer;
\par th = set of byte ;
\par var fin,fout: text ;
\par sd: integer ; td: thd ;
\par \{******************************\}
\par Procedure init(var x: thd) ;
\par var ir: integer ;
\par begin
\par for ir: =1 to 20 do
\par begin x[ir,1]: = 0 ; x[ir,2]: = 0 end ;
\par for ir : = 1 to sd do readLn (fin, x[ir,1],x[ir,2];
\par end ;
\par \{******************************\}
\par Procedure xl1 (a: thd) ;
\par var i,j,nr : integer ;
\par sw: boolean ;
\par phu : array[1..2,1..20] of integer ;
\par \{************\}
\par function kc (p1,p2: integer) : real ;
\par begin
\par kc : = sqrt (sqr(a[p1,2] - a[p2,2]+sqr(a[p1,1] - a[p2,1]))
\par end ;
\par \{************\}
\par function quay(p1,p2,p3: integer):boolean;
\par var at, bt, ct : real ;
\par begin
\par at := (sqr(a[p1,1] - a[p2,1]+sqr(a[p1,2] - a[p2,2]))
\par bt := (sqr(a[p2,1] - a[p3,1]+sqr(a[p2,2] - a[p3,2]))
\par ct := (sqr(a[p1,1] - a[p3,1]+sqr(a[p1,2] - a[p3,2]))
\par quay := at+bc-ct = 0
\par end ;
\par \{************\}
\par Procedure xd (p1,p2,n : integer) ;
\par var id : integer ;
\par min, d : real ;
\par sd1 : th ;
\par swd : boolean ;
\par \tab \{************\}
\par }\pard \qj\li720\widctlpar {\b\f45\fs20 function ok (c1,c2,c3 : integer) : boolean ;
\par begin
\par if A[c2,1]<> a[c3,1]
\par then if ((a[c3,1]- a[c1,1] < 0 and (a[c1,1] - a[c2,1]> 0 )) or
\par ((a[c3,1]- a[c1,1] > 0 and (a[c1,1] - a[c2,1]< 0 ))
\par then ok : = true
\par else ok : = false
\par else if ((a[c3,2]- a[c1,2] < 0 and (a[c1,2] - a[c2,2]> 0 )) or
\par ((a[c3,2]- a[c1,2] > 0 and (a[c1,2] - a[c2,2]< 0 ))
\par then ok : = true
\par else ok : = false
\par end ;
\par \{************\}
\par }\pard \qj\widctlpar {\b\f45\fs20 begin
\par sd1 : = [] ; min : = 1.7e38 ;
\par for id : = 1 to sd do
\par if (not (id in [p1,p2])) and (quay (p1,p2,id))
\par then begin
\par sd1 := sd1+[id] ; d := kc (p2,id) ;
\par if d < min then begin min := d ; phu [1,n] := id end
\par end ;
\par sd1 := sd1 - [phu [1,n]] ; id := 2 ;
\par if sd1<> [] then
\par begin
\par swd := True ; min := 1.7e38 ;
\par While (id <= sd) do
\par begin
\par if (id in sd1) and ok (p2,phu [1,n], id)
\par and (kc (p2,id) < min)
\par then begin
\par phu [2,n] := id ; min := kc (p2,id)
\par end ;
\par id := id + 1
\par end
\par end
\par end ;
\par \{******************************\}
\par    Procedure viet;
\par    var
\par       it,u,v,z,t:integer;
\par    begin
\par    dd[sd+1]:=1;
\par    writeLn(fout,1);
\par    Write(fout,mes1,'      ');
\par    WriteLn(fout,a[dd[2],1]:4,'     ' ,a[dd[2],2]:4);
\par    Write(fout,mes2);
\par    WriteLn(fout,a[dd[2],1]:4,'     ' ,a[dd[2],2]:4);
\par    for it:=3 to sd + 1 do
\par    begin\{FOR\}
\par    u:=a[dd[it-1],1]-a[dd[it-2],1];
\par    v:=a[dd[it-1],2]-a[dd[it-2],2];
\par    z:=a[dd[it],1]-a[dd[it-1],1];
\par    t:=a[dd[it],2]-a[dd[it-1],2];
\par    if u*t>z*v then Writeln(fout,mes3) else Writeln(fout,mes4);
\par    write(fout,mes2);
\par    WriteLn(fout,a[dd[it],1]:4,'     ' ,a[dd[it],2]:4);
\par    end;
\par    end;\{VIET\}
\par    \{*************************\}
\par begin\{XULY\}
\par s:=[];qua[1]:=1;
\par nr :=2;
\par \{NR la diem thu hai tren hanh trinh\}
\par while nr< sd do
\par       begin
\par       chon:=0;
\par       for i:=2 to sd do
\par           if (i<>nr)and thang(1,i,nr) and ok(1,i,nr) then begin chon:=1;break;end;
\par       if chon=1 then inc(nr)
\par       else
\par           begin\{else\}
\par           writeln(nr);
\par           dd[2]:=nr;qua[nr]:=1;
\par           fillchar(cothe,sizeof(cothe),0);
\par           i :=2;
\par           while i>1 do
\par           begin
\par           Tim(dd[i-1],dd[i],i);
\par           if (i=sd)and(1 in [cothe[1,i],cothe[2,i]])
\par           then begin viet;found:=true;exit;end;
\par           if (cothe[1,i]<>0)and(qua[cothe[1,i]]=1) then cothe[1,i]:=0;
\par           if (cothe[2,i]<>0)and(qua[cothe[2,i]]=1) then cothe[2,i]:=0;
\par           \{Quay lui\}
\par           while (i>1)and(cothe[1,i]=0)and(cothe[2,i]=0) do
\par                 begin qua[dd[i]]:=0;dd[i]:=0;i:=i-1;end;
\par           if i>1 then
\par              begin
\par              inc(i);
\par              if cothe[1,i-1]=0 then
\par \tab         begin dd[i]:=cothe[2,i-1];qua[cothe[2,i-1]]:=1;cothe[2,i-1]:=0;end
\par              else
\par              begin dd[i]:=cothe[1,i-1];qua[cothe[1,i-1]]:=1; cothe[1,i-1]:=0 end;
\par              end;
\par           end;\{WHILE i>1\}
\par           inc(nr);
\par       end;\{else\}
\par end;\{WHILE NR<SD\}
\par end;
\par \{************************\}
\par \{MAIN\}
\par begin
\par found:=false;
\par assign(fout,fo);rewrite(fout);
\par init;xuly;
\par if found then writeLn(fout,mes5) else writeln(fout,0);
\par Close(fout)
\par end.
\par }{\b B\'b5i t\'cbp 4.} Tr\'aan m\'c6t ph\'bcng to\'b9 \'ae\'e9 m\'e9t r\'ab b\'e8t di chuy\'d3n gi\'f7a c\'b8c n\'f3t. To\'b9 \'ae\'e9 c\'f1a c\'b8c n\'f3t nguy\'aan v\'b5 c\'e3 tr\'de tuy\'d6t \'ae\'e8i kh\'abng qu\'b8 100. R\'ab b\'e8t c\'e3 th\'d3 th
\'f9c hi\'d6n b\'e8n lo\'b9i b\'ad\'edc di chuy\'d3n, m\'e7i b\'ad\'edc \'aei d\'b5i m\'e9t \'ae\'acn v\'de, v\'edi c\'b8c k\'fd hi\'d6u t\'ad\'acng \'f8ng sau:
\par {\pntext\pard\plain\f1\fs28 \'b7\tab}\pard \qj\fi-360\li1800\widctlpar{\*\pn \pnlvlblt\pnf1\pnfs28\pnstart1\pnindent360\pnhang{\pntxtb \'b7}}U K: di chuy\'d3n l\'aan tr\'aan K b\'ad\'edc.
\par {\pntext\pard\plain\f1\fs28 \'b7\tab}D K: di chuy\'d3n xu\'e8ng d\'ad\'edi K b\'ad\'edc.
\par {\pntext\pard\plain\f1\fs28 \'b7\tab}L K: di chuy\'d3n sang tr\'b8i K b\'ad\'edc.
\par {\pntext\pard\plain\f1\fs28 \'b7\tab}R K: di chuy\'d3n sang ph\'b6i K b\'ad\'edc.
\par \pard \qj\widctlpar R\'ab b\'e8t xu\'cat ph\'b8t t\'f5 \'aei\'d3m c\'e3 to\'b9 \'ae\'e9 (X,Y) v\'b5 h\'b5nh trinh k\'d5t th\'f3c t\'b9i \'aei\'d3m \'ae\'e3. Qu\'fc \'ae\'b9o c\'f1a h\'b5nh tr\'d7nh l\'b5 m\'e9t \'ae\'ad\'eang g\'cap kh\'f3c kh\'d0p k\'dd
n. Ph\'c7n c\'f1a qu\'fc \'ae\'b9o \'ae\'ad\'eec g\'e4i l\'b5 ch\'f7 nh\'cbt n\'d5u n\'e3 g\'e5m b\'e8n \'aeo\'b9n tr\'aan qu\'fc \'ae\'b9o l\'cbp th\'b5nh m\'e9t h\'d7nh ch\'f7 nh\'cbt kh\'abng t\'c7m th\'ad\'eang m\'b5 trong n\'e3 kh\'abng c\'e3 \'aeo
\'b9n qu\'fc \'ae\'b9o n\'b5o kh\'b8c. H\'b7y t\'d7m ch\'f7 nh\'cbt c\'e3 di\'d6n t\'ddch nh\'e1 nh\'cat.
\par D\'f7 li\'d6u v\'b5o \'ae\'ad\'eec cho b\'ebi file ROBOT.INP trong \'ae\'e3 d\'dfng th\'f8 nh\'cat ghi hai s\'e8 X, Y, ti\'d5p theo l\'b5 m\'e9t s\'e8 d\'dfng, m\'e7i d\'dfng ghi m\'e9t l\'d6nh di chuy\'d3n.
\par K\'d5t qu\'b6 ghi ra file ROBOT.OUT nh\'ad sau: d\'dfng th\'f8 nh\'cat ghi s\'e8 S l\'b5 di\'aan t\'ddch h\'d7nh ch\'f7 nh\'cbt nh\'e1 nh\'cat, n\'d5u S>0, d\'dfng th\'f8 hai ghi to\'b9 \'ae\'e9 \'ae\'d8nh tr\'b8i d\'ad\'edi, d\'dfng th\'f8 hai ghi to\'b9
 \'ae\'e9 \'ae\'d8nh ph\'b6i tr\'aan c\'f1a ch\'f7 nh\'cbt.
\par {\b V\'dd d\'f4
\par }\pard \qj\li2160\widctlpar {\b\f46 ROBOT.INP\tab \tab ROBOT.OUT
\par 4\tab 7\tab \tab \tab 6
\par }\pard\plain \s1\qj\li2160\keepn\widctlpar \b\f46\fs28\lang2057 R 6\tab \tab \tab \tab 7\tab 3
\par \pard\plain \qj\li2160\widctlpar \f41\fs28\lang2057 {\b\f46 D 4\tab \tab \tab \tab 10\tab 5
\par L 3
\par U 2
\par R 5
\par D 4
\par L 8
\par U 6
\par }\pard \qj\widctlpar {\b\f45\fs20 const
\par      fi='robot.in';
\par      fo='my.';
\par var
\par    f:text;
\par    a:array[-101..100,-101..100] of byte;
\par    s,shs,min:longint;
\par    tx,ty,px,py:longint;
\par    t:char;
\par procedure nhap;
\par var
\par    c:char;k,i,x,y:longint;
\par begin
\par assign(f,fi+t);reset(f);
\par fillchar(a,sizeof(a),0);
\par readln(f,x,y);
\par while not(seekeof(f)) do
\par       begin
\par       read(f,c);readln(f,k);
\par       case c of
\par       'U':
\par           for i:=1 to k do
\par           begin
\par           a[x,y]:=a[x,y] or 8;a[x-1,y]:=a[x-1,y] or 2;
\par           inc(y);
\par           end;
\par       'D':
\par           for i:=1 to k do
\par           begin
\par           a[x,y-1]:=a[x,y-1] or 8;a[x-1,y-1]:=a[x-1,y-1] or 2;
\par           dec(y);
\par           end;
\par       'L':
\par           for i:=1 to k do
\par           begin
\par           a[x-1,y]:=a[x-1,y] or 4;a[x-1,y-1]:=a[x-1,y-1] or 1;
\par           dec(x);
\par           end;
\par       'R':
\par           for i:=1 to k do
\par           begin
\par           a[x,y]:=a[x,y] or 4;a[x,y-1]:=a[x,y-1] or 1;
\par           inc(x);
\par           end;
\par       end;
\par       end;
\par close(f);
\par end;
\par procedure tim;
\par var
\par    i,j,u,v,p,q,h,k:longint;
\par begin
\par min:=maxlongint;
\par for i:=-101 to 100 do
\par for j:=-101 to 100 do
\par     begin
\par     if a[i,j]=15 then
\par        begin
\par        min:=1;tx:=i;ty:=j;px:=tx+1;py:=ty+1;
\par        exit;
\par        end;
\par     if a[i,j]=13 then
\par        begin
\par        v:=j+1;u:=i;
\par        while (v<=100)and(a[u,v]=5) do inc(v);
\par        if (v<=100)and(a[u,v]=7) then
\par           begin
\par           s:=v-j+1;
\par           if s<min then begin min:=s;tx:=i;ty:=j;px:=tx+1;py:=v+1;end;
\par           end;
\par        end;
\par     if a[i,j]=14 then
\par        begin
\par        v:=j;u:=i+1;
\par        while (u<=100)and(a[u,v]=10) do inc(u);
\par        if (u<=100)and(a[u,v]=11) then
\par           begin
\par           s:=u-i+1;
\par           if s<min then begin min:=s;tx:=i;ty:=j;px:=u+1;py:=ty+1;end;
\par           end;
\par        end;
\par     if a[i,j]=12 then
\par        begin
\par        v:=j;u:=i+1;
\par        while (u<=100)and(a[u,v]=4) do inc(u);
\par        if (i=7)and(j=3) then writeln('U = ',u);
\par        if (u<=100)and(a[u,v]=6) then
\par           begin
\par           p:=i;q:=j+1;
\par           while (q<=100)and(a[p,q]=8) do inc(q);
\par           if (i=7)and(j=3) then writeln('Q = ',q);
\par           if (q<=100)and(a[p,q]=9)and(a[u,q]=3) then
\par              begin
\par              h:=i+1;
\par              while a[h,q]=1 do inc(h);
\par              if (i=7)and(j=3) then writeln('H = ',h);
\par              if h=u then
\par                 begin
\par                 k:=j+1;
\par                 while a[u,k]=2 do inc(k);
\par                 if (i=7)and(j=3) then writeln('K = ',k);
\par                 if k=q then
\par                    begin
\par                    s:=(u-i+1)*(q-j+1);
\par                    if s<min then
\par                       begin min:=s;tx:=i;ty:=j;px:=u+1;py:=q+1;end;
\par                    end;
\par                 end;
\par              end;
\par           end;
\par        end;
\par     end;
\par end;
\par procedure viet;
\par begin
\par assign(f,fo+t);rewrite(f);
\par if min=maxlongint then min:=0;
\par writeln(f,min);
\par if min>0 then
\par    begin writeln(f,tx:5,ty:5);writeln(f,px:5,py:5);end;
\par close(f);
\par end;
\par BEGIN
\par for t:='1' to '5' do
\par begin
\par nhap;tim;viet;
\par end;
\par END.
\par }{\b B\'b5i t\'cbp 5.} Tr\'aan m\'c6t ph\'bcng to\'b9 \'ae\'e9 c\'e3 m\'e9t h\'d7nh vu\'abng V m\'e9t \'ae\'d8nh \'eb g\'e8c to\'b9 \'ae\'e9 v\'b5 m\'e9t \'ae\'d8nh c\'e3 to\'b9 \'ae\'e9 (100,100). Trong h\'d7nh vu\'abng l\'edn c\'e3 M h\'d7nh vu\'abng nh
\'e1 h\'acn l\'b5 nh\'f7ng v\'cbt c\'b6n, hai v\'cbt c\'b6n kh\'b8c nhau kh\'abng c\'e3 \'aei\'d3m chung. C\'c7n t\'d7m m\'e9t h\'b5nh tr\'d7nh ng\'ben nh\'cat kh\'abng ra ngo\'b5i V t\'f5 \'aei\'d3m (0,0) \'ae\'d5n \'aei\'d3m (100,100) sao cho h\'b5nh tr
\'d7nh \'ae\'e3 kh\'abng \'aei xuy\'aan qua c\'b8c v\'cbt c\'b6n m\'b5 c\'efng l\'bem ch\'d8 ch\'b9m v\'b5o c\'b8c \'aei\'d3m thu\'e9c c\'b9nh.
\par D\'f7 li\'d6u v\'b5o \'ae\'ad\'eec cho b\'ebi file OBSTACLE.INP trong \'ae\'e3 d\'dfng th\'f8 nh\'cat ghi s\'e8 M<=30, trong M d\'dfng ti\'d5p theo, m\'e7i d\'dfng ghi ba s\'e8 nguy\'aan d\'ad\'acng U, V, W v\'edi \'fd ngh\'dca c\'e3 v\'cbt c\'b6n m\'b5 g
\'e3c tr\'b8i d\'ad\'edi c\'e3 to\'b9 \'ae\'e9 (U,V) v\'b5 c\'b9nh b\'bbng W.
\par K\'d5t qu\'b6 ghi ra file OBSTACLE.OUT nh\'ad sau: d\'dfng th\'f8 nh\'cat ghi \'ae\'e9 d\'b5i h\'b5nh tr\'d7nh, d\'dfng th\'f8 hai ghi s\'e8 D l\'b5 s\'e8 \'aei\'d3m m\'b5 t\'b9i \'ae\'e3 h\'b5nh tr\'d7nh \'ae\'e6i h\'ad\'edng, n\'d5u D>0, trong D d\'df
ng ti\'d5p theo, m\'e7i d\'dfng ghi m\'e9t \'aei\'d3m t\'b9i \'ae\'e3 h\'b5nh tr\'d7nh \'ae\'e6i h\'ad\'edng theo tr\'d7nh t\'f9 tr\'aan h\'b5nh tr\'d7nh. S\'e8 th\'f9c l\'cay v\'edi 3 s\'e8 l\'ce sau d\'cau ph\'b6y.
\par {\b \tab V\'dd d\'f4
\par }\pard \qj\li1440\widctlpar OBSTACLE.INP\tab \tab OBSTACLE.OUT
\par 5\tab \tab \tab \tab \tab 142.980
\par 5\tab 5\tab 5\tab \tab \tab 3
\par 5\tab 15\tab 5\tab \tab \tab 5\tab 10
\par 15\tab 10\tab 5\tab \tab \tab 20\tab 20
\par 15\tab 20\tab 5\tab \tab \tab 95\tab 90
\par 90\tab 90\tab 5
\par \pard \qj\widctlpar {\i Thu\'cbt to\'b8n.} B\'bbng c\'b8ch d\'efng b\'cat \'ae\'bcng th\'f8c tam gi\'b8c, ta c\'e3 th\'d3 ch\'f8ng minh \'ae\'ad\'eec trong c\'b8c \'ae\'ad\'eang \'aei ng\'ben nh\'cat c\'e3 th\'d3 c\'e3, c\'e3 \'ae\'ad\'eang \'aei qua c
\'b8c \'ae\'d8nh c\'f1a ch\'ad\'edng ng\'b9i v\'cbt. Do \'ae\'e3 vi\'d6c gi\'b6i b\'b5i to\'b8n \'ae\'ada v\'d2 vi\'d6c t\'d7m \'ae\'ad\'eang \'aei ng\'ben nh\'cat t\'f5 \'aei\'d3m (0,0) \'ae\'d5n \'aei\'d3m (100,100) tr\'aan \'ae\'e5 th\'de v\'ab h\'ad
\'edng c\'e3 tr\'e4ng s\'e8 v\'edi c\'b8c \'ae\'d8nh g\'e5m c\'b8c \'aei\'d3m (0,0), (100,100) v\'b5 c\'b8c \'ae\'d8nh c\'f1a c\'b8c ch\'ad\'edng ng\'b9i v\'cbt; hai \'ae\'d8nh c\'f1a \'ae\'e5 th\'de n\'b5y k\'d2 nhau khi v\'b5 ch\'d8 khi \'aeo\'b9n th
\'bcng n\'e8i hai \'aei\'d3m t\'ad\'acng \'f8ng kh\'abng c\'e3 \'aei\'d3m trong chung v\'edi b\'cat k\'fa ch\'ad\'edng ng\'b9i v\'cbt n\'b5o. Trong ch\'ad\'acng tr\'d7nh d\'ad\'edi \'ae\'a9y, h\'b5m DUOC ki\'d3u Boolean c\'e3 gi\'b8 tr\'de True n\'d5u c
\'e3 th\'d3 \'aei t\'f5 \'aei\'d3m P \'ae\'d5n \'aei\'d3m Q.{\fs32 
\par }{\b\f45\fs20 const
\par      fi='obstacle.inp';
\par      fo='obstacle.out';
\par type
\par     diem=record x,y:real;end;
\par var
\par    f:text;
\par    a1,b1,c1,a2,b2,c2:real;
\par    vc:array[0..31,1..4] of diem;
\par    m,lastv,lastd:byte;g:diem;
\par    truoc1,truoc2:array[1..31,1..4] of byte;
\par    d:array[0..31,1..4] of real;
\par    chua:array[1..31,1..4] of boolean;
\par procedure nhap;
\par var
\par    x,y,z:real;i:byte;
\par begin
\par assign(f,fi);reset(f);
\par vc[0,1].x:=0;vc[0,2].x:=0;vc[0,3].x:=0;vc[0,4].x:=0;
\par vc[0,1].y:=0;vc[0,2].y:=0;vc[0,3].y:=0;vc[0,4].y:=0;
\par readln(f,m);
\par for i:=1 to m do
\par     begin
\par     readln(f,x,y,z);
\par     vc[i,1].x:=x;vc[i,1].y:=y;
\par     vc[i,2].x:=x;vc[i,2].y:=y+z;
\par     vc[i,3].x:=x+z;vc[i,3].y:=y+z;
\par     vc[i,4].x:=x+z;vc[i,4].y:=y;
\par     end;
\par close(f);
\par vc[m+1,1].x:=100;vc[m+1,2].x:=100;vc[m+1,3].x:=100;vc[m+1,4].x:=100;
\par vc[m+1,1].y:=100;vc[m+1,2].y:=100;vc[m+1,3].y:=100;vc[m+1,4].y:=100;
\par end;
\par procedure pt(p,q:diem;var a,b,c:real);
\par begin
\par a:=q.y-p.y;b:=p.x-q.x;c:=p.y*q.x-q.y*p.x;
\par end;
\par function gt(p:diem;a,b,c:real):real;
\par begin
\par gt:=a*p.x+b*p.y+c;
\par end;
\par function cat(i:byte;p,q:diem):boolean;
\par \{Doan noi P va Q cat vat can thu i\}
\par var
\par    cat1,cat2,cat3,cat4:boolean;
\par begin
\par pt(p,q,a1,b1,c1);
\par pt(vc[i,1],vc[i,3],a2,b2,c2);
\par cat1:=(gt(p,a2,b2,c2)*gt(q,a2,b2,c2)<0);
\par cat2:=(gt(vc[i,1],a1,b1,c1)*gt(vc[i,3],a1,b1,c1)<0);
\par pt(vc[i,2],vc[i,4],a2,b2,c2);
\par cat3:=(gt(p,a2,b2,c2)*gt(q,a2,b2,c2)<0);
\par cat4:=(gt(vc[i,2],a1,b1,c1)*gt(vc[i,4],a1,b1,c1)<0);
\par cat:=(cat1 and cat2) or (cat3 and cat4);
\par end;
\par function duoc(p,q:diem):boolean;
\par var
\par    i:byte;
\par begin
\par if (p.x=q.x)and(p.y=q.y) then begin duoc:=false;exit;end;
\par duoc:=true;
\par for i:=1 to m do if cat(i,p,q) then begin duoc:=false;exit;end;
\par end;
\par function kc(p,q:diem):real;
\par begin
\par kc:=sqrt(sqr(p.x-q.x)+sqr(p.y-q.y));
\par end;
\par procedure dijk;
\par var
\par    u,v:byte;
\par    min:real;
\par begin
\par fillchar(chua,sizeof(chua),true);
\par fillchar(truoc1,sizeof(truoc1),0);
\par fillchar(truoc2,sizeof(truoc2),0);
\par g.x:=0;g.y:=0;
\par for u:=1 to m do
\par for v:=1 to 4 do
\par     begin truoc1[u,v]:=0;truoc2[u,v]:=1;end;
\par for u:=1 to m do
\par for v:=1 to 4 do
\par if duoc(g,vc[u,v]) then d[u,v]:=kc(g,vc[u,v]) 
\par else d[u,v]:=1e10;
\par for v:=1 to 4 do d[m+1,v]:=1e10;
\par for v:=1 to 4 do d[0,v]:=0;
\par lastv:=0;lastd:=1;
\par while lastv<>m+1 do
\par begin
\par min:=1e20;
\par for u:=1 to m+1 do
\par for v:=1 to 4 do
\par if chua[u,v] then
\par if d[u,v]<min then begin min:=d[u,v];lastv:=u;lastd:=v;end;
\par chua[lastv,lastd]:=false;
\par if lastv<>m+1 then
\par    begin
\par    For u:=1 to m+1 do
\par    for v:=1 to 4 do
\par    if chua[u,v] and duoc(vc[lastv,lastd],vc[u,v]) then
\par    if d[u,v]>d[lastv,lastd]+kc(vc[lastv,lastd],vc[u,v]) then
\par       begin
\par       d[u,v]:=d[lastv,lastd]+kc(vc[lastv,lastd],vc[u,v]);
\par       truoc1[u,v]:=lastv;truoc2[u,v]:=lastd;
\par       end;
\par    end;
\par    end;
\par end;
\par function th(p,q,r:diem):boolean;
\par begin
\par th:=((q.x-p.x)*(q.y-r.y)=(q.y-p.y)*(q.x-r.x));
\par end;
\par procedure viet;
\par var
\par    tam:array[1..100,1..2] of real;
\par    giu:array[1..100] of boolean;
\par    h:array[0..100] of diem;
\par    sd,v,d1:byte;
\par begin
\par assign(f,fo);rewrite(f);
\par writeln(f,d[lastv,lastd]:10:3);
\par v:=lastv;d1:=lastd;sd:=0;h[sd]:=vc[lastv,lastd];
\par while v<>0 do
\par \tab begin
\par \tab v:=truoc1[lastv,lastd];d1:=truoc2[lastv,lastd];
\par         lastv:=v;lastd:=d1;
\par \tab inc(sd);h[sd]:=vc[lastv,lastd];
\par         tam[sd,1]:=vc[lastv,lastd].x;tam[sd,2]:=vc[lastv,lastd].y;
\par     end;
\par writeln(f,sd-1);
\par fillchar(giu,sizeof(giu),true);
\par for v:=1 to sd-1 do if th(h[v-1],h[v],h[v+1]) then giu[v]:=false;
\par for v:=sd-1 downto 1 do
\par     if giu[v] then writeln(f,tam[v,1]:10:0,tam[v,2]:10:0);
\par close(f);
\par end;
\par BEGIN
\par nhap;dijk;viet;
\par END.
\par }{\b B\'b5i t\'cbp 6.} M\'e9t qu\'b6 b\'e3ng r\'aci t\'f5 tr\'aan cao xu\'e8ng v\'edi t\'e8c \'ae\'e9 1m/s, khi n\'e3 ch\'b9m v\'b5o m\'e9t t\'cam v\'b8n n\'bbm ngang \'eb d\'ad\'edi (k\'d3 c\'b6 t\'b9i \'ae\'c7u m\'f3t t\'cam v\'b8n, xem test v\'dd d\'f4
), n\'e3 s\'cf l\'a8n sang ph\'b6i/tr\'b8i \'ae\'d2u v\'edi t\'e8c \'ae\'e9 1m/s tu\'fa theo s\'f9 l\'f9a ch\'e4n c\'f1a b\'b9n theo \'ae\'ad\'eang th\'bcng n\'bbm trong m\'c6t ph\'bcng vu\'abng g\'e3c v\'edi t\'cam v\'b8n v\'b5 m\'c6t ph\'bcng r\'ac
i, sau \'ae\'e3 l\'b9i ti\'d5p t\'f4c r\'aci xu\'e8ng d\'ad\'edi v\'c9n v\'edi t\'e8c \'ae\'e9 1m/s, c\'f8 ti\'d5p t\'f4c nh\'ad v\'cby cho t\'edi khi ch\'b9m t\'edi n\'d2n; n\'d2n \'ae\'ad\'eec xem l\'b5 m\'e9t t\'cam v\'b8n k\'ddch th\'ad\'edc v\'ab h
\'b9n. B\'e3ng kh\'abng \'ae\'ad\'eec r\'aci t\'f9 do qu\'b8 m\'e9t \'aeo\'b9n M cho tr\'ad\'edc. Qu\'b8 tr\'d7nh r\'aci di\'d4n ra tr\'aan m\'e9t m\'c6t ph\'bcng vu\'abng g\'e3c v\'edi n\'d2n n\'aan ta c\'e3 th\'d3 \'ae\'denh v\'de h\'d6 th\'e8ng b\'bb
ng m\'e9t h\'d6 tr\'f4c to\'b9 \'ae\'e9 m\'b5 tr\'f4c Ox l\'b5 n\'d2n, m\'e7i t\'cam v\'b8n nh\'ad m\'e9t \'aeo\'b9n th\'bcng song song v\'edi n\'d2n, qu\'b6 b\'e3ng nh\'ad m\'e9t \'aei\'d3m.
\par Cho bi\'d5t v\'de tr\'dd ban \'ae\'c7u c\'f1a qu\'b6 b\'e3ng, v\'de tr\'dd v\'b5 \'ae\'e9 d\'b5i c\'b8c t\'cam v\'b8n, h\'b7y ch\'e4n h\'b5nh tr\'d7nh r\'aci nhanh nh\'cat cho qu\'b6 b\'e3ng.
\par D\'f7 li\'d6u v\'b5o \'ae\'ad\'eec cho b\'ebi file FALL.IN trong \'ae\'e3 d\'dfng th\'f8 nh\'cat ghi b\'e8n s\'e8 N, X, Y, M trong \'ae\'e3 N l\'b5 s\'e8 t\'cam v\'b8n, (X,Y) l\'b5 to\'b9 \'ae\'e9 ban \'ae\'c7u c\'f1a qu\'b6 b\'e3ng, M l\'b5 \'aeo\'b9n gi
\'edi h\'b9n vi\'d6c r\'aci t\'f9 do, ti\'d5p theo l\'b5 N d\'dfng, d\'dfng th\'f8 I ghi ba s\'e8 X1, X2, H, hai s\'e8 \'ae\'c7u l\'b5 ho\'b5nh \'ae\'e9 c\'f1a hai \'ae\'c7u, X1<X2, s\'e8 th\'f8 ba l\'b5 tung \'ae\'e9 c\'f1a t\'cam v\'b8n th\'f8 I. M\'e4
i s\'e8 \'ae\'d2u l\'b5 nguy\'aan, 1<=N<=1000, c\'b8c ho\'b5nh \'ae\'e9 c\'e3 tr\'de tuy\'d6t \'ae\'e8i kh\'abng qu\'b8 20000, c\'b8c tung \'ae\'e9 d\'ad\'acng v\'b5 kh\'abng qu\'b8 20000. Kh\'abng c\'e3 hai t\'cam v\'b8n n\'b5o c\'e3 \'aei\'d3m chung v
\'b5 b\'b5i to\'b8n lu\'abn c\'e3 l\'eai gi\'b6i.
\par K\'d5t qu\'b6 ghi ra file FALL.OUT nh\'ad sau: d\'dfng th\'f8 nh\'cat ghi th\'eai gian t\'f5 l\'f3c b\'bet \'ae\'c7u r\'aci d\'d5n khi ch\'b9m n\'d2n, ti\'d5p theo l\'b5 m\'e9t s\'e8 d\'dfng, m\'e7i d\'dfng ghi hai s\'e8 T, H m\'b5 T l\'b5 s\'e8 hi\'d6u t
\'cam v\'b8n, H = 0/1 l\'b5 h\'ad\'edng l\'a8n \'ae\'ad\'eec ch\'e4n: 0/1 t\'ad\'acng \'f8ng v\'edi tr\'b8i/ph\'b6i.
\par {\b \tab V\'dd d\'f4
\par }\pard \qj\li2160\widctlpar FALL.IN\tab \tab \tab \tab FALL.OUT
\par 3\tab 8\tab 17\tab 20\tab \tab 23
\par 0\tab 10\tab 8\tab \tab \tab 2\tab 1
\par 0\tab 10\tab 13\tab \tab \tab 1\tab 1
\par 4\tab 14\tab 3\tab \tab \tab 3\tab 1
\par \pard \qj\widctlpar {\i C\'b8ch gi\'b6i:} X\'d0t \'ae\'e5 th\'de m\'b5 c\'b8c \'ae\'d8nh l\'b5 c\'b8c \'ae\'c7u m\'f3t c\'f1a c\'b8c t\'cam v\'b8n; khi \'ae\'e3 \'aei\'d3m xu\'cat ph\'b8t c\'f1a qu\'b6 b\'e3ng xem nh\'ad t\'cam v\'b8n th\'f8 0 v\'edi hai 
\'ae\'c7u m\'f3t tr\'efng nhau v\'b5 n\'d2n xem nh\'ad t\'cam v\'b8n v\'edi hai \'ae\'c7u m\'f3t c\'e3 ho\'b5nh \'ae\'e9 -MaxInt v\'b5 MaxInt. Do b\'e3ng ch\'d8 r\'aci t\'f5 tr\'aan cao xu\'e8ng th\'cap n\'aan ta s\'cf s\'bep x\'d5p c\'b8c t\'cam v\'b8
n theo chi\'d2u cao gi\'b6m d\'c7n (xem Procedure Sapxep; - ta c\'e3 th\'d3 d\'efng QuickSort thay cho s\'bep x\'d5p \'ae\'acn gi\'b6n d\'efng \'eb \'ae\'a9y). Sau \'ae\'e3 d\'efng thu\'cbt to\'b8n Dijkstra (xem Procedure ijk) t\'d7m \'ae\'ad\'eang \'ae
i ng\'ben nh\'cat t\'f5 \'aei\'d3m ban \'ae\'c7u c\'f1a qu\'b6 b\'e3ng \'ae\'d5n n\'d2n nh\'b5.
\par V\'edi thu\'cbt to\'b8n n\'b5y, th\'eai gian ch\'b9y ch\'ad\'acng tr\'d7nh l\'a9u h\'acn so v\'edi thu\'cbt to\'b8n d\'efng \'fd t\'ad\'ebng c\'f1a quy ho\'b9ch \'ae\'e9ng vi\'d5t trong ch\'ad\'acng tr\'d7nh 2 do em Nguy\'d4n V\'a8n Hi\'d5u, h\'e4
c sinh chuy\'aan Tin kho\'b8 1999-2002 tr\'ad\'eang \'ae\'b9i h\'e4c Khoa h\'e4c T\'f9 nhi\'aan vi\'d5t.
\par Ch\'ad\'acng tr\'d7nh 1
\par {\b\f45\fs20 const
\par      fi='fall.inp';
\par      fo='fall.out';
\par var
\par    f:text;
\par    csn,cs,t,p,h:array[0..1001] of longint;
\par    d,truocv,truoch:array[0..1001,0..1] of longint;
\par    chua:array[0..1001,0..1] of boolean;
\par    tg,n,m,b,lastv,lasth:longint;
\par procedure nhap;
\par var
\par    i:longint;
\par begin
\par assign(f,fi);reset(f);
\par readln(f,n,t[0],h[0],m);p[0]:=t[0];
\par for i:=1 to n do readln(f,t[i],p[i],h[i]);
\par close(f);
\par end;
\par procedure sapxep;
\par var
\par    i,j,k:longint;
\par begin
\par for i:=0 to n do cs[i]:=i;
\par for i:=0 to n-1 do
\par for j:=i+1 to n do if h[i]<h[j] then
\par     begin
\par     k:=h[i];h[i]:=h[j];h[j]:=k;
\par     k:=cs[i];cs[i]:=cs[j];cs[j]:=k;
\par     end;
\par b:=cs[0];
\par t[n+1]:=-maxint;p[n+1]:=maxint;h[n+1]:=0;cs[n+1]:=n+1;
\par end;
\par procedure ijk;
\par var
\par    i,j,k,miin,u:longint;dung:boolean;
\par    x:array[0..1001,0..1] of longint;
\par begin
\par for i:=b to n+1 do
\par for j:=0 to 1 do
\par     begin
\par     d[i,j]:=1000000000;chua[i,j]:=true;
\par     truocv[i,j]:=b;truoch[i,j]:=0;
\par     end;
\par lastv:=b;lasth:=0;x[lastv,lasth]:=t[b];
\par chua[lastv,lasth]:=false;
\par d[lastv,lasth]:=0;
\par while lastv<>n+1 do
\par       begin
\par       dung:=false;
\par       for i:=lastv+1 to n+1 do
\par       begin
\par       u:=cs[i];
\par       if (x[lastv,lasth]>=t[u])and (x[lastv,lasth]<=p[u]) and (h[lastv]-h[i]<=m)then begin dung:=true;break;end;
\par       end;
\par       if dung then
\par       begin\{if dung\}
\par       if i<>n+1 then
\par       begin\{if i<>n+1\}
\par       if d[i,0]>d[lastv,lasth]+h[lastv]-h[i]+x[lastv,lasth]-t[u] 
\par then
\par          begin
\par          d[i,0]:=d[lastv,lasth]+h[lastv]-h[i]+x[lastv,lasth]-t[u];
\par          truocv[i,0]:=lastv;truoch[i,0]:=lasth;
\par          end;
\par       if d[i,1]>d[lastv,lasth]+h[lastv]-h[i]+p[u]-x[lastv,lasth] then
\par          begin
\par          d[i,1]:=d[lastv,lasth]+h[lastv]-h[i]+p[u]-x[lastv,lasth];
\par          truocv[i,1]:=lastv;truoch[i,1]:=lasth;
\par          end;
\par       end
\par       else
\par       begin
\par       if d[i,0]>d[lastv,lasth]+h[lastv]-h[i] then
\par          begin
\par          d[i,0]:=d[lastv,lasth]+h[lastv]-h[i];
\par          truocv[i,0]:=lastv;truoch[i,0]:=lasth;
\par          end;
\par       if d[i,1]>d[lastv,lasth]+h[lastv]-h[i] then
\par          begin
\par          d[i,1]:=d[lastv,lasth]+h[lastv]-h[i];
\par          truocv[i,1]:=lastv;truoch[i,1]:=lasth;
\par          end;
\par       end;
\par       end;
\par       miin:=maxlongint;
\par       for i:=1 to n+1 do
\par       for j:=0 to 1 do if chua[i,j] and(d[i,j]<miin) then
\par           begin
\par           miin:=d[i,j];lastv:=i;lasth:=j;
\par           if i<>n+1 then
\par           begin
\par           u:=cs[i];
\par           if j=0 then x[lastv,lasth]:=t[u] else x[lastv,lasth]:=p[u];
\par           end;
\par           end;
\par       chua[lastv,lasth]:=false;
\par       end;
\par end;
\par procedure viet;
\par var
\par    tt,i,tv,th:longint;
\par    ht:array[1..1000,1..2] of longint;
\par begin
\par assign(f,fo);rewrite(f);
\par writeln(f,d[lastv,lasth]);
\par tt:=0;tv:=lastv;th:=lasth;
\par repeat
\par lastv:=truocv[tv,th];lasth:=truoch[tv,th];
\par inc(tt);ht[tt,1]:=lastv;ht[tt,2]:=lasth;
\par tv:=lastv;th:=lasth;
\par until tv=b;
\par dec(tt);
\par for i:=tt downto 1 do writeln(f,cs[ht[i,1]]:8,ht[i,2]:8);
\par close(f);
\par end;
\par BEGIN
\par nhap;sapxep;ijk;viet;
\par END.
\par }Ch\'ad\'acng tr\'d7nh 2
\par {\b\f45\fs20 const
\par      fi = 'fall.inp';
\par      fo = 'fall.out';
\par      nmax = 1000;
\par      limit = 20000;
\par type
\par     line = record
\par       x1,x2,y,cs : integer;
\par       minl,csl,minr,csr : integer;
\par     end;
\par var
\par    f : text;
\par    dt : array[0..nmax] of line;
\par    n,x,y,max,indst : integer;
\par    time : longint;
\par procedure nhap;
\par var i : integer;
\par begin
\par   assign(f,fi); reset(f);
\par   readln(f,n,x,y,max);
\par   for i:=1 to n do
\par   with dt[i] do
\par   begin
\par     cs:=i;
\par     readln(f,x1,x2,y);
\par   end;
\par   with dt[0] do
\par   begin
\par     cs:=0;
\par     x1:=-limit; x2:=limit;
\par     y:=0;
\par   end;
\par   close(f);
\par end;
\par procedure dc(var x,y : line);
\par var tg : line;
\par begin
\par   tg:=x; x:=y; y:=tg;
\par end;
\par procedure qusort(l,r : integer);
\par var
\par    i,j,x : integer;
\par begin
\par   i:=l; j:=r; x:=dt[(l+r) div 2].y;
\par   repeat
\par     while dt[i].y<x do inc(i);
\par     while dt[j].y>x do dec(j);
\par     if i<=j then
\par     begin
\par       dc(dt[i],dt[j]);
\par       inc(i); dec(j);
\par     end;
\par   until i>j;
\par   if l<j then qusort(l,j);
\par   if i<r then qusort(i,r);
\par end;
\par function min(a,b : integer) : integer;
\par begin
\par   if a<b then min:=a else min:=b;
\par end;
\par function giua(a,x,y : integer) : boolean;
\par begin
\par   giua:=(x<=a)and(a<=y);
\par end;
\par procedure timdtbd;
\par var i : integer;
\par begin
\par   for i:=n downto 1 do
\par     if giua(x,dt[i].x1,dt[i].x2) then begin indst:=i; exit; end;
\par end;
\par procedure chuanbi;
\par begin
\par   qusort(1,n);
\par   timdtbd;
\par end;
\par procedure tinh;
\par var
\par    i,j,in1,in2 : integer;
\par begin
\par   for i:=1 to n do
\par   begin
\par     in1:=-1; in2:=-1;
\par     for j:=i-1 downto 0 do
\par     begin
\par       if dt[i].y-dt[j].y>max then break;
\par       if (in1=-1)and(giua(dt[i].x1,dt[j].x1,dt[j].x2)) then
\par       begin
\par         in1:=j;
\par         if in2>=0 then break;
\par       end;
\par       if (in2=-1)and(giua(dt[i].x2,dt[j].x1,dt[j].x2)) then
\par       begin
\par         in2:=j;
\par         if in1>=0 then break;
\par       end;
\par     end;
\par     with dt[i] do
\par     begin
\par       csl:=in1; csr:=in2;
\par       if in1>-1 then
\par       begin
\par         if in1>0 then
\par           minl:=min(dt[i].x1-dt[in1].x1+dt[in1].minl,
\par                     dt[in1].x2-dt[i].x1+dt[in1].minr)
\par         else minl:=0;
\par       end else minl:=limit;
\par       if in2>-1 then
\par       begin
\par        if in2>0 then
\par          minr:=min(dt[i].x2-dt[in2].x1+dt[in2].minl,
\par                    dt[in2].x2-dt[i].x2+dt[in2].minr)
\par        else minr:=0;
\par       end else minr:=limit;
\par     end;
\par   end;
\par end;
\par procedure ghikq;
\par var
\par    i,j,hd,h : integer;
\par    t : longint;
\par begin
\par   assign(f,fo); rewrite(f);
\par   if indst=0 then write(f,y) else
\par   begin
\par     i:=indst;
\par     time:=y+min(dt[i].minl+x-dt[i].x1,dt[i].minr+dt[i].x2-x);
\par     writeln(f,time);
\par     t:=y-dt[i].y;
\par     hd:=x;
\par     repeat
\par       if hd-dt[i].x1+dt[i].minl<dt[i].x2-hd+dt[i].minr then h:=0 else h:=1;
\par       writeln(f,dt[i].cs,' ',h);
\par       case h of
\par        0 : begin
\par              j:=dt[i].csl;
\par              t:=t+dt[i].y-dt[j].y+hd-dt[i].x1;
\par              hd:=dt[i].x1;
\par              i:=j;
\par            end;
\par        1 : begin
\par              j:=dt[i].csr;
\par              t:=t+dt[i].y-dt[j].y+dt[i].x2-hd;
\par              hd:=dt[i].x2;
\par              i:=j;
\par            end;
\par       end;
\par     until i=0;
\par   end;
\par   close(f);
\par end;
\par BEGIN
\par      clrscr;
\par      nhap;
\par      chuanbi;
\par      tinh;
\par      ghikq;
\par END.
\par }{\b B\'b5i t\'cbp 7.} M\'e9t v\'ad\'acng qu\'e8c c\'e3 N ph\'b8o \'ae\'b5i \'ae\'b8nh s\'e8 t\'f5 1 \'ae\'d5n N, N<1000. M\'e7i ph\'b8o \'ae\'b5i l\'b5 \'ae\'ad\'eec x\'b8c \'ae\'denh b\'ebi t\'e4a \'ae\'e9 tr\'aan m\'c6t ph\'bcng t\'e4a \'ae\'e9 l\'b5
 hai s\'e8 th\'f9c, kh\'abng c\'e3 ba ph\'b8o \'ae\'b5i n\'b5o th\'bcng h\'b5ng. Vi\'d6c b\'b6o v\'d6 \'ae\'ad\'eec b\'e8 tr\'dd nh\'ad sau:
\par V\'dfng 1 g\'e5m c\'b8c ph\'b8o \'ae\'b5i m\'b5 \'aea gi\'b8c c\'e3 \'ae\'d8nh l\'b5 ch\'f3ng bao m\'e4i ph\'b8o \'ae\'b5i kh\'b8c v\'b5 c\'e3 chu vi nh\'e1 nh\'cat trong m\'e4i \'aea gi\'b8c nh\'ad v\'cby. V\'edi m\'e7i ph\'b8o \'ae\'b5i thu\'e9c v\'df
ng 1, m\'e9t l\'ddnh \'ae\'ad\'eec g\'f6i \'ae\'d5n.
\par V\'dfng 2 g\'e5m c\'b8c ph\'b8o \'ae\'b5i ch\'e4n theo c\'b8ch ch\'e4n v\'dfng 1 \'ae\'e8i v\'edi c\'b8c ph\'b8o \'ae\'b5i kh\'abng thu\'e9c v\'dfng 1. V\'edi m\'e7i ph\'b8o \'ae\'b5i thu\'e9c v\'dfng 2, hai l\'ddnh \'ae\'ad\'eec g\'f6i \'ae\'d5n. C\'f8
 nh\'ad th\'d5 cho t\'edi khi m\'e4i ph\'b8o \'ae\'b5i thu\'e9c m\'e9t v\'dfng b\'b6o v\'d6.
\par H\'b7y cho bi\'d5t m\'e7i ph\'b8o \'ae\'b5i c\'e3 bao nhi\'aau l\'ddnh \'ae\'ad\'eec g\'f6i \'ae\'d5n.
\par D\'f7 li\'d6u v\'b5o \'ae\'ad\'eec cho b\'ebi file HI.INP trong \'ae\'e3 d\'dfng th\'f8 nh\'cat ghi s\'e8 N, d\'dfng th\'f8 I trong N d\'dfng ti\'d5p theo ghi t\'e4a \'ae\'e9 ph\'b8o \'ae\'b5i th\'f8 I.
\par \pard \qj\fi720\widctlpar V\'dd d\'f4
\par \trowd \trgaph108\trleft2127\trbrdrt\brdrs\brdrw15 \trbrdrl\brdrs\brdrw15 \trbrdrb\brdrs\brdrw15 \trbrdrr\brdrs\brdrw15 \trbrdrh\brdrs\brdrw15 \trbrdrv\brdrs\brdrw15 \clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr
\brdrs\brdrw15 \cellx4253\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cellx6521 \pard \widctlpar\intbl {\cs17\f45\fs26 HI.INP\line 16\line 8 2\line 2 4\line 17 4\line 6 5\line 8 7\line 11 9\line 15 10\line 
12 18\line 5.1 16\line 4 20\line 15 18\line 7 15\line 6 14\line 11 13\line 12 13\line 13 14}{\f45\fs26 \cell HOMM.OUT\line 1\line 1\line 1\line 2\line 3\line 3\line 2\line 2\line 2\line 1\line 1\line 3\line 3\line 4\line 4\line 3\line \cell }\pard 
\widctlpar\intbl {\f45\fs26 \row }\pard \qj\widctlpar {\b\fs26 
\par }C\'b8ch gi\'b6i. B\'bbng c\'b8ch d\'efng b\'cat \'ae\'bcng th\'f8c tam gi\'b8c, ta c\'e3 th\'d3 ch\'f8ng minh \'ae\'ad\'eec v\'dfng 1 g\'e5m c\'b8c ph\'b8o \'ae\'b5i l\'cbp th\'b5nh bao l\'e5i c\'f1a t\'cbp m\'e4i ph\'b8o \'ae\'b5i, v\'dfng 2 g\'e5m c
\'b8c ph\'b8o \'ae\'b5i l\'cbp th\'b5nh bao l\'e5i c\'f1a t\'cbp m\'e4i ph\'b8o \'ae\'b5i kh\'abng thu\'e9c v\'dfng 1, t\'e6ng qu\'b8t, v\'dfng I g\'e5m c\'b8c ph\'b8o \'ae\'b5i l\'cbp th\'b5nh bao l\'e5i c\'f1a t\'cbp m\'e4i ph\'b8o \'ae\'b5i kh\'ab
ng thu\'e9c c\'b8c v\'dfng 1, . . ., I-1. Do \'ae\'e3, ta c\'e3 th\'d3 d\'efng thu\'cbt to\'b8n t\'d7m bao l\'e5i c\'f1a m\'e9t t\'cbp \'aei\'d3m \'ae\'b7 \'ae\'ad\'eec gi\'edi thi\'d6u \'eb ph\'c7n tr\'aan.
\par 
\par {\ul\lang1033 B\'b5i to\'b8n 2}{\lang1033 : \'a7i\'d3m M(x}{\lang1033\sub 0}{\lang1033 , y}{\lang1033\sub o}{\lang1033 ) c\'e3 thu\'e9c \'aeo\'b9n th\'bcng n\'e8i 2 \'aei\'d3m A(x}{\lang1033\sub 1}{\lang1033 ,y}{\lang1033\sub 1}{\lang1033 ) v\'b5 B(x}{
\lang1033\sub 2}{\lang1033 ,y}{\lang1033\sub 2}{\lang1033 ) hay kh\'abng?
\par }{\i\lang1033 G\'eei \'fd     }{\lang1033 Ph\'ad\'acng tr\'d7nh \'ae\'ad\'eang th\'bcng qua AB l\'b5 F(x,y)=(y}{\lang1033\sub 2}{\lang1033 -y}{\lang1033\sub 1}{\lang1033 )*x - (x}{\lang1033\sub 2}{\lang1033 -x}{\lang1033\sub 1}{\lang1033 )*y  + y}{
\lang1033\sub 1}{\lang1033 *x}{\lang1033\sub 2}{\lang1033  -x}{\lang1033\sub 1}{\lang1033 * y}{\lang1033\sub 2 }{\lang1033  = 0. \'a7i\'d3m M(x}{\lang1033\sub 0}{\lang1033 ,y}{\lang1033\sub o}{\lang1033 ) thu\'e9c \'aeo\'b9n th\'bcng n\'e8i 2 \'aei\'d3
m A(x}{\lang1033\sub 1}{\lang1033 ,y}{\lang1033\sub 1}{\lang1033 ) v\'b5 B(x}{\lang1033\sub 2}{\lang1033 ,y}{\lang1033\sub 2}{\lang1033 ) n\'d5u tho\'b6 m\'b7n:     
\par F(x}{\lang1033\sub 0}{\lang1033 , y}{\lang1033\sub 0}{\lang1033 )= 0 ,  Min(x}{\lang1033\sub 1}{\lang1033 ,x}{\lang1033\sub 2}{\lang1033 ) }{\lang1033 {\field{\*\fldinst SYMBOL 163 \\f "Symbol" \\s 14}{\fldrslt\f1\fs28}}}{\lang1033  x}{\lang1033\sub 0}{
\lang1033 {\field{\*\fldinst SYMBOL 163 \\f "Symbol" \\s 14}{\fldrslt\f1\fs28}}}{\lang1033  Max(x}{\lang1033\sub 1}{\lang1033 ,x}{\lang1033\sub 2}{\lang1033 ) v\'b5  Min(y}{\lang1033\sub 1}{\lang1033 ,y}{\lang1033\sub 2}{\lang1033 )}{\lang1033 
{\field{\*\fldinst SYMBOL 163 \\f "Symbol" \\s 14}{\fldrslt\f1\fs28}}}{\lang1033  y}{\lang1033\sub 0}{\lang1033  }{\lang1033 {\field{\*\fldinst SYMBOL 163 \\f "Symbol" \\s 14}{\fldrslt\f1\fs28}}}{\lang1033  Max(y}{\lang1033\sub 1}{\lang1033 , y}{
\lang1033\sub 2}{\lang1033 )
\par }\pard\plain \s16\qj\widctlpar \f11\fs20 {\f41\fs28 B\'b5i 10:. Cho N \'aeo\'b9n th\'bcng ngang ho\'c6c d\'e4c. H\'b7y t\'d7m c\'b8c giao \'aei\'d3m c\'f1a ch\'f3ng. D\'f7 li\'d6u v\'b5o t\'f5 file v\'a8n b\'b6n GIAODIEM.INP, D\'dfng \'ae\'c7u l\'b5 s\'e8
 N, N d\'dfng sau m\'e7i d\'dfng 4 s\'e8  nguy\'aan l\'b5 to\'b9 \'ae\'e9 2 \'ae\'c7u m\'f3t c\'f1a m\'e9t \'aeo\'b9n th\'bcng. K\'d5t qu\'b6 ghi ra file v\'a8n b\'b6n GIAODIEM.OUT m\'e7i d\'dfng l\'b5 2 s\'e8 th\'d3 hi\'d6n to\'b9 \'ae\'e9 m\'e9t giao 
\'aei\'d3m.
\par }{\i\f41\fs28 Thu\'cbt to\'b8n:}{\f41\fs28  \'a7\'c6t c\'b8c \'aeo\'b9n th\'bcng trong h\'d6 tr\'f4c to\'b9 \'ae\'e9 \'a7\'d2 C\'b8c. Gi\'b6 s\'f6 c\'b8c \'aeo\'b9n th\'bcng n\'bbm ngang c\'efng ph\'ad\'acng tr\'f4c ho\'b5nh, c\'b8c \'aeo\'b9n th\'bcng d
\'e4c c\'efng ph\'ad\'acng tr\'f4c tung. D\'efng m\'e9t \'ae\'ad\'eang th\'bcng }{\f4\fs28 ?}{\f41\fs28  n\'bbm ngang qu\'d0t t\'f5 d\'ad\'edi l\'aan tr\'aan (t\'f5 \'ae\'c7u m\'f3t \'aeo\'b9n th\'bcng c\'e3 tung \'ae\'e9 th\'cap nh\'cat  t\'edi \'ae\'c7
u m\'f3t \'aeo\'b9n th\'bcng c\'e3 tung \'ae\'e9 cao nh\'cat). Giao \'aei\'d3m xu\'cat hi\'d6n khi }{\f4\fs28 ?}{\f41\fs28  ch\'f8a 1 \'aeo\'b9n th\'bcng n\'bbm ngang m\'b5 \'aeo\'b9n th\'bcng n\'bbm ngang n\'b5y l\'b9i ch\'f8a 1 \'aei\'d3m c\'f1a m\'e9t 
\'aeo\'b9n d\'e4c n\'b5o \'ae\'e3. \'a7i\'d3m c\'f1a \'aeo\'b9n th\'bcng d\'e4c xu\'cat hi\'d6n tr\'aan }{\f4\fs28 ?}{\f41\fs28  khi }{\f4\fs28 ?}{\f41\fs28  b\'bet \'ae\'c7u ch\'b9m t\'edi \'ae\'c7u m\'f3t d\'ad\'edi c\'f1a \'aeo\'b9n th\'bcng d\'e4c v
\'b5 n\'e3 s\'cf bi\'d5n kh\'e1i }{\f4\fs28 ?}{\f41\fs28  khi }{\f4\fs28 ?}{\f41\fs28  \'aei qua \'aei\'d3m m\'f3t tr\'aan c\'f1a \'aeo\'b9n th\'bcng d\'e4c n\'b5y. V\'d7 v\'cby c\'e3 th\'d3 d\'efng d\'f7 li\'d6u ki\'d3u TREE \'ae\'d3 qu\'b6n l\'fd ho\'b5
nh \'ae\'e9 c\'b8c \'ae\'c7u m\'f3t c\'f1a c\'b8c \'aeo\'b9n th\'bcng d\'e4c (m\'e7i \'aeo\'b9n th\'bcng d\'e4c 2 \'ae\'c7u m\'f3t): N\'d5u }{\f4\fs28 ?}{\f41\fs28  g\'c6p \'ae\'c7u th\'cap c\'f1a \'aeo\'b9n th\'bcng d\'e4c ta th\'aam ho\'b5nh \'ae\'e9 c
\'f1a \'aeo\'b9n n\'b5y v\'b5o c\'a9y nh\'de ph\'a9n t\'d7m ki\'d5m (n\'d5u ho\'b5nh \'ae\'e9 n\'b5y nh\'e1 h\'acn ho\'b5nh \'ae\'e9 n\'f3t x v\'f5a d\'f9ng tr\'ad\'edc \'ae\'e3 th\'d7 n\'e3 l\'b5 con tr\'b8i c\'f1a n\'f3t x ng\'ad\'eec l\'b9i n\'e3 l\'b5
 con ph\'b6i c\'f1a x), n\'d5u }{\f4\fs28 ?}{\f41\fs28  g\'c6p \'ae\'c7u m\'f3t cao c\'f1a \'aeo\'b9n th\'bcng d\'e4c th\'d7 ta xo\'b8 n\'f3t l\'b5 m\'f3t th\'cap c\'f1a \'aeo\'b9n d\'e4c n\'b5y ra kh\'e1i c\'a9y. N\'d5u }{\f4\fs28 ?}{\f41\fs28  g\'c6p 
\'aeo\'b9n th\'bcng d\'e4c th\'d7 ch\'ddnh l\'b5 l\'f3c ta ph\'b6i t\'d7m ki\'d5m giao \'aei\'d3m: giao \'aei\'d3m l\'b5 \'aei\'d3m c\'e3 ho\'b5nh \'ae\'e9 b\'bbng m\'e9t n\'f3t tr\'aan c\'a9y hi\'d6n t\'b9i c\'e3 trong kho\'b6ng t\'f5 ho\'b5nh \'ae\'e9 n
\'f3t tr\'b8i c\'f1a \'aeo\'b9n th\'bcng d\'e4c cho \'ae\'d5n ho\'b5nh \'ae\'e9 n\'f3t ph\'b6i c\'f1a \'aeo\'b9n th\'bcng d\'e4c n\'b5y, c\'dfn tung \'ae\'e9 c\'f1a giao \'aei\'d3m  l\'b5 tung \'ae\'e9 c\'f1a \'aeo\'b9n d\'e4c \'aeang x\'d0t.
\par C\'b5i \'ae\'c6t c\'f4 th\'d3: 
\par S\'bep t\'a8ng c\'b8c \'aei\'d3m m\'f3t c\'b8c \'aeo\'b9n th\'bcng theo tung \'ae\'e9 c\'f1a ch\'f3ng. 
\par X\'a9y d\'f9ng hai c\'a9y nh\'de ph\'a9n: C\'a9y y ch\'f8a tung \'ae\'e9 c\'b8c \'aei\'d3m m\'f3t c\'b8c \'aeo\'b9n th\'bcng. C\'a9y x ch\'f8a ho\'b5nh \'ae\'e9 c\'b8c \'aei\'d3m m\'f3t c\'b8c \'aeo\'b9n th\'bcng d\'e4c.
\par X\'a9y d\'f9ng c\'a9y y nh\'ad sau:  M\'e7i n\'f3t c\'f1a c\'a9y t\'ad\'acng \'f8ng m\'e9t \'ae\'c7u m\'f3t c\'f1a m\'e9t \'aeo\'b9n th\'bcng, \'ae\'e3 l\'b5 m\'e9t record g\'e5m c\'b8c tr\'ad\'eang: dau (1 l\'b5 \'ae\'c7u m\'f3t d\'ad\'edi \'aeo\'b9n th
\'bcng d\'e4c, 2 l\'b5 \'ae\'c7u m\'f3t tr\'aan c\'f1a \'aeo\'b9n th\'bcng d\'e4c, 3 l\'b5 \'ae\'c7u c\'f1a \'aeo\'b9n th\'bcng n\'bbm ngang), stt (thu\'e9c \'aeo\'b9n th\'bcng th\'f8 m\'cay), key (tung \'ae\'e9 c\'f1a \'aei\'d3m m\'f3t), l (c\'a9y con tr
\'b8i), r (c\'a9y con ph\'b6i). M\'e7i khi \'ae\'e4c \'ae\'ad\'eec 4 to\'b9 \'ae\'e9 x1, y1, x2, y2 c\'f1a m\'e9t \'aeo\'b9n th\'bcng i, th\'d7 ch\'ccn v\'b5o c\'a9y nh\'de ph\'a9n y m\'e9t n\'f3t t\'ad\'acng \'f8ng}{\fs28 
\par }{\f41\fs28 Sau \'ae\'e3 duy\'d6t c\'a9y y theo ki\'d3u trung t\'f9: V\'dfng l\'c6p g\'e5m c\'b8c b\'ad\'edc: g\'e4i duy\'d6t c\'a9y tr\'b8i, x\'f6 l\'fd n\'f3t gi\'f7a, g\'e4i duy\'d6t c\'a9y ph\'b6i) \'ae\'d3 x\'a9y d\'f9ng c\'a9y x v\'b5  d\'efng x 
\'ae\'d3 t\'d7m ki\'d5m giao \'aei\'d3m: Khi x\'f6 l\'fd n\'f3t gi\'f7a n\'d5u g\'c6p n\'f3t (tr\'aan c\'a9y y) l\'b5 \'aei\'d3m m\'f3t d\'ad\'edi c\'f1a \'aeo\'b9n th\'bcng d\'e4c th\'d7 ch\'ccn v\'b5o c\'a9y x, n\'d5u g\'c6p n\'f3t (tr\'aan c\'a9y y) l
\'b5 \'aei\'d3m m\'f3t tr\'aan c\'f1a \'aeo\'b9n th\'bcng d\'e4c th\'d7 xo\'b8 n\'e3 kh\'e1i c\'a9y x, n\'d5u g\'c6p n\'f3t (tr\'aan c\'a9y y) l\'b5 \'aei\'d3m m\'f3t c\'f1a \'aeo\'b9n th\'bcng ngang th\'d7 duy\'d6t c\'a9y x hi\'d6n t\'b9i (duy\'d6t ki
\'d3u ti\'d2n t\'f9) \'ae\'d3 t\'d7m giao \'aei\'d3m.}{\fs28 
\par }{\f41\fs28 Sau \'ae\'a9y l\'b5 ch\'ad\'acng tr\'d7nh gi\'b6i b\'b5i to\'b8n n\'b5y.}{\fs28 
\par }{\f45 uses  crt;
\par const max      = 100;
\par       fi       = 'timgiao.inp';
\par       fo       = 'timgiao.out';
\par 
\par type  tree_y   = ^node;
\par       node     = record dau,stt,key: integer; l,r: tree_y end;
\par 
\par       tree_x   = ^rec;
\par       rec      = record stt: integer;l,r: tree_x end;
\par 
\par       diem     = record x,y: integer end;
\par       dthang   = record p1,p2: diem end;
\par       cacdoan  = array[0..max] of dthang;
\par 
\par var   doan    : cacdoan;
\par       cay_y   : tree_y;
\par       cay_x   : tree_x;
\par       n       : integer;
\par       f       : text;
\par 
\par function  taonut_y(dau,stt,key: integer;l,r: tree_y): tree_y;
\par       var t: tree_y;
\par       begin
\par            new(t);
\par            t^.dau := dau;
\par            t^.key := key;
\par            t^.stt := stt;
\par            t^.r   := r;
\par            t^.l   := l;
\par            taonut_y := t;
\par       end;
\par 
\par procedure chen_y(dau,stt,key: integer;var y:tree_y);
\par       begin
\par            if y=nil then y:= taonut_y(dau,stt,key,nil,nil)
\par            else
\par            if key<y^.key then chen_y(dau,stt,key,y^.l)
\par            else chen_y(dau,stt,key,y^.r);
\par       end;
\par 
\par function  taonut_x(stt: integer;l,r: tree_x): tree_x;
\par       var t: tree_x;
\par       begin
\par            new(t);
\par            t^.stt:= stt;
\par            t^.r   := r;
\par            t^.l   := l;
\par            taonut_x := t;
\par       end;
\par 
\par procedure chen_x(stt: integer;var x:tree_x);
\par       var p,x1: tree_x;
\par       begin
\par            if x=nil then x:= taonut_x(stt,nil,nil)
\par            else
\par            if doan[stt].p1.x<doan[x^.stt].p1.x then
\par            chen_x(stt,x^.l)
\par            else chen_x(stt,x^.r);
\par       end;
\par 
\par function tim(t: tree_x;stt: integer;var t1,t2: tree_x): boolean;
\par        begin
\par             t2:= t;
\par             t1:= nil;
\par             while (t2<>nil) do
\par             begin
\par                  if stt<>t2^.stt then t1:= t2;
\par                  if doan[stt].p2.x<doan[t2^.stt].p2.x then
\par                     t2:= t2^.l
\par                  else
\par                  if doan[stt].p2.x>doan[t2^.stt].p2.x then
\par                     t2:= t2^.r
\par                  else
\par                  begin
\par                       tim:= true;
\par                       exit;
\par                  end;
\par             end;
\par             tim:= false;
\par        end;
\par 
\par procedure xoa_x(stt: integer;var t: tree_x);
\par        var t1,t2,t3,t4  : tree_x;
\par            c            : integer;
\par            co           : boolean;
\par        begin
\par             if not tim(t,stt,t1,t2)
\par             then writeln('Cay rong  ')
\par             else
\par             begin
\par                if (t2^.l<>nil) and (t2^.r<>nil) then
\par                begin
\par                    t4:= t2^.r;
\par                    t1:= t2;
\par                    while (t4^.l<>nil) do
\par                    begin
\par                        t1:= t4;
\par                        t4:= t4^.l;
\par                    end;
\par                    t2^.stt:= t4^.stt;
\par                    t2:= t4;
\par                end;
\par                if (t2^.l<>nil) and (t2^.r=nil) then
\par                begin
\par                     if t1=nil then t:= t2^.l
\par                     else
\par                     begin
\par                         if t1^.l=t2 then t1^.l:= t2^.l
\par                            else if t1^.r=t2 then t1^.r:= t2^.l;
\par                     end;
\par                end
\par                else
\par                if (t2^.l=nil) and (t2^.r<>nil) then
\par                begin
\par                     if t1=nil then t:= t2^.r
\par                     else
\par                     begin
\par                         if t1^.l=t2 then t1^.l:= t2^.r
\par                            else if t1^.r=t2 then t1^.r:= t2^.r;
\par                     end;
\par                end
\par 
\par                else
\par                begin
\par                    if t1<>nil then
\par                    begin
\par                        if t1^.l = t2 then t1^.l:= nil;
\par                        if t1^.r = t2 then t1^.r:= nil;
\par                    end
\par                    else t:= nil;
\par                end;
\par             end;
\par        end;
\par 
\par procedure dungcay_y;
\par       var x1,x2,y1,y2: integer;
\par           f          : text;
\par       begin
\par            assign(f,fi);
\par            reset(f);
\par            cay_y := nil;
\par            n  := 0;
\par            doan[n].p1.x:= 0;
\par            doan[n].p1.y:= 0;
\par            doan[n].p2.x:= 0;
\par            doan[n].p2.y:= 0;
\par            repeat
\par                  inc(n);
\par                  readln(f,x1,y1,x2,y2);
\par                  doan[n].p1.x:= x1;
\par                  doan[n].p1.y:= y1;
\par                  doan[n].p2.x:= x2;
\par                  doan[n].p2.y:= y2;
\par                  if y2<>y1 then
\par                  begin
\par                       chen_y(1,n,y1,cay_y);
\par                       chen_y(2,n,y2,cay_y)
\par                  end
\par                  else chen_y(3,n,y1,cay_y);;
\par            until eof(f);
\par            close(f);
\par       end;
\par 
\par procedure timgiaodiem(y,a,b: integer;var t: tree_x);
\par       var ok1,ok2: boolean;
\par       begin
\par             if t^.stt<>0 then
\par             begin
\par                  ok1:= doan[t^.stt].p1.x<a;
\par                  ok2:= doan[t^.stt].p1.x>b;
\par                  if ok1 then timgiaodiem(y,a,b,t^.r);
\par                  if (not ok1) and (not ok2) then
\par                  begin
\par                       writeln(f,'(',doan[t^.stt].p1.x,',',y,')');
\par                       timgiaodiem(y,a,b,t^.l);
\par                       timgiaodiem(y,a,b,t^.r);
\par                  end;
\par                  if ok2 then hien(y,a,b,t^.l);
\par             end;
\par       end;
\par 
\par procedure scan(cay_y : tree_y);
\par       var t          : tree_y;
\par           stt,y,a,b  : integer;
\par       begin
\par            new(t);
\par            t:= cay_y;
\par            if t<>nil then
\par            begin
\par                  scan(t^.l);
\par                  if t^.dau=1 then chen_x(t^.stt,cay_x)
\par                  else
\par                  if t^.dau=2 then xoa_x(t^.stt,cay_x)
\par                  else
\par                  begin
\par                       a:= doan[t^.stt].p1.x;
\par                       b:= doan[t^.stt].p2.x;
\par                       y:= doan[t^.stt].p2.y;
\par                       hien(y,a,b,cay_x);
\par                  end;
\par                  scan(t^.r);
\par            end;
\par       end;
\par BEGIN
\par       clrscr;
\par       dungcay_y;
\par       cay_x := nil;
\par       assign(f,fo);
\par       rewrite(f);
\par       scan(cay_y);
\par       dispose(cay_y);
\par       close(f);
\par END.
\par }\pard \s16\qj\sl360\slmult1\widctlpar {\b\f41\fs24\ul B\'b5i 11. }{\f41\fs28 Tr\'aan m\'c6t ph\'bcng to\'b9 \'ae\'e9 m\'e9t h\'d7nh ch\'f7 nh\'cbt v\'edi c\'b8c c\'b9nh song song v\'edi c\'b8c tr\'f4c to\'b9 \'ae\'e9 \'ae\'ad\'eec x\'b8c \'ae\'denh b\'eb
i hai \'ae\'d8nh \'ae\'e8i t\'a9m. Trong b\'b5i n\'b5y, m\'e4i h\'d7nh ch\'f7 nh\'cbt \'ae\'d2u c\'e3 c\'b8c c\'b9nh song song v\'edi c\'b8c tr\'f4c to\'b9 \'ae\'e9. Nh\'cbp t\'f5 file v\'a8n b\'b6n }{\b\f41\fs28 CN.INP}{\f41\fs28  s\'e8 nguy\'aan d\'ad
\'acng N}{\f41\fs28 {\field{\*\fldinst SYMBOL 163 \\f "Symbol" \\s 14}{\fldrslt\f1\fs28}}}{\f41\fs28 30 ghi \'eb d\'dfng th\'f8 nh\'cat. Trong N d\'dfng ti\'d5p theo m\'e7i d\'dfng ghi 4 s\'e8 l\'b5 to\'b9 \'ae\'e9 c\'f1a hai \'ae\'d8nh \'ae\'e8i t\'a9m c
\'f1a m\'e9t h\'d7nh ch\'f7 nh\'cbt, c\'b8c s\'e8 n\'b5y l\'b5 nguy\'aan c\'e3 gi\'b8 tr\'de tuy\'d6t \'ae\'e8i kh\'abng qu\'b8 100.
\par }\pard\plain \qj\fi720\widctlpar \f41\fs28\lang2057 a) H\'b7y x\'b8c \'ae\'denh h\'d7nh ch\'f7 nh\'cbt nh\'e1 nh\'cat S ch\'f8a N h\'d7nh ch\'f7 nh\'cbt \'ae\'b7 cho. Th\'abng b\'b8o ra m\'b5n h\'d7nh 4 s\'e8 l\'b5 to\'b9 \'ae\'e9 c\'f1a hai \'ae\'d8nh 
\'ae\'e8i t\'a9m c\'f1a h\'d7nh ch\'f7 nh\'cbt n\'b5y.
\par b) T\'d7m di\'d6n t\'ddch c\'f1a ph\'c7n h\'d7nh S kh\'abng n\'bbm trong h\'d7nh ch\'f7 nh\'cbt n\'b5o trong s\'e8 N h\'d7nh tr\'aan. Th\'abng b\'b8o k\'d5t qu\'b6 ra m\'b5n h\'d7nh.
\par \pard\plain \s16\qj\widctlpar \f11\fs20 {\i\f41\fs28\ul H\'ad\'edng d\'c9n}{\i\f41\fs28 : }{\f41\fs28 K\'d0o d\'b5i c\'b8c c\'b9nh c\'f1a c\'b8c c\'b8c h\'d7nh ch\'f7 nh\'cbt. Khi \'ae\'e3 tr\'aan m\'c6t ph\'bcng to\'b9 \'ae\'e9 xu\'cat hi\'d6n c\'b8c 
\'ab (h\'d7nh ch\'f7 nh\'cbt) thu\'e9c hai kh\'b6 n\'a8ng : ho\'c6c \'ab n\'b5y thu\'e9c m\'e9t h\'d7nh ch\'f7 nh\'cbt n\'b5o \'ae\'e3 trong c\'b8c h\'d7nh ch\'f7 nh\'cbt \'ae\'b7 cho ho\'c6c \'ab n\'b5y kh\'abng thu\'e9c b\'cat k\'fa h\'d7nh ch\'f7 nh
\'cbt \'ae\'b7 cho n\'b5o. Sau \'ae\'a9y l\'b5 ch\'ad\'acng tr\'d7nh gi\'b6i b\'b5i to\'b8n.
\par }{\fs24 uses   crt;const  maxn  = 100;       fi    = 'HCN.INP';
\par        fo    = 'HCN.OUT';
\par type   hcn   = record x1,x2,y1,y2 : integer; end;
\par        m1    = array[1..2*maxn] of integer;
\par        m2    = array[1..maxn] of hcn;
\par var    n,i,j,k  : integer;
\par        minx,maxx,miny,maxy : integer;
\par        x,y      : m1;
\par        a        : m2;
\par        s        : longint;
\par        f        : text;
\par procedure nhap;
\par     var  f : text;
\par          x1,x2,y1,y2 : integer;
\par     function min(x,y:integer):integer;
\par         begin
\par              if x<y then min := x else min := y;
\par         end;
\par     function max(x,y:integer):integer;
\par         begin
\par              if x>y then max := x else max := y;
\par         end;
\par     begin
\par         assign(f,fi);
\par         reset(f);
\par         readln(f,n);
\par         minx := maxint;
\par         miny := maxint;
\par         maxx := -maxint;
\par         maxy := -maxint;
\par         for i:=1 to n do
\par         begin
\par             readln(f,x1,y1,x2,y2);
\par             a[i].x1 := min(x1,x2);
\par             a[i].x2 := max(x1,x2);
\par             a[i].y1 := min(y1,y2);
\par             a[i].y2 := max(y1,y2);
\par             if x1>maxx then maxx := x1;
\par             if x1<minx then minx := x1;
\par             if x2>maxx then maxx := x2;
\par             if x2<minx then minx := x2;
\par             if y1>maxy then maxy := y1;
\par             if y1<miny then miny := y1;
\par             if y2>maxy then maxy := y2;
\par             if y2<miny then miny := y2;
\par         end;
\par         close(f);
\par     end;
\par procedure sort(var b : m1;k : integer);
\par     var i,j,c : integer;
\par     begin
\par          for i:= 1 to 2*k-1 do
\par              for j:=i+1 to 2*k do
\par                 if b[i]>b[j] then
\par                 begin
\par                       c    := b[i];
\par                       b[i] := b[j];
\par                       b[j] := c;
\par                 end;
\par     end;
\par function kiemtra(i1,j1,sl : integer): boolean;
\par     begin
\par         kiemtra := true;
\par         for k:=1 to sl do
\par         if  (a[k].x1<=x[i1-1]) and (x[i1]<= a[k].x2)
\par         and (a[k].y1<=y[j1-1]) and (y[j1]<= a[k].y2) then exit;
\par         kiemtra := false;
\par     end;
\par function dientich(k : integer) : integer;
\par     var s : integer;
\par     begin
\par          for i:=1 to k do
\par               begin
\par                     x[2*i-1] := a[i].x1;
\par                     x[2*i]   := a[i].x2;
\par                     y[2*i-1] := a[i].y1;
\par                     y[2*i]   := a[i].y2;
\par               end;
\par          sort(x,k);
\par          sort(y,k);
\par          s := 0;
\par          for i:=2 to 2*k do
\par          for j:=2 to 2*k do
\par          if kiemtra(i,j,k) then
\par              s := s +(x[i]-x[i-1])*(y[j]-y[j-1]);
\par          dientich := s;
\par     end;
\par BEGIN
\par     nhap;
\par     assign(f,fo);
\par     rewrite(f);
\par     writeln(f,minx,' ',miny,' ',maxx,' ',maxy);
\par     s := (maxy-miny)*(maxx-minx);
\par     s := s-dientich(n);
\par     writeln(f,s);
\par     close(f);
\par }\pard\plain \qj\widctlpar \f41\fs28\lang2057 END.
\par \pard\plain \s16\qj\sl360\slmult1\widctlpar \f11\fs20 {\b\f41\fs28 B\'b5i 12. }{\f41\fs28 C\'e3 N b\'b6ng qu\'b6ng c\'b8o, m\'e7i b\'b6ng c\'e3 d\'b9ng h\'d7nh ch\'f7 nh\'cbt. B\'b6ng th\'f8 i x\'b8c \'ae\'denh b\'ebi to\'b9 \'ae\'e9 tr\'aan tr\'b8i (X}{
\f41\fs28\sub i}{\f41\fs28 ,Y}{\f41\fs28\sub i}{\f41\fs28 ) v\'b5 to\'b9 \'ae\'e9 d\'ad\'edi ph\'b6i (U}{\f41\fs28\sub i}{\f41\fs28 ,V}{\f41\fs28\sub i}{\f41\fs28 ). C\'b8c to\'b9 \'ae\'e9 nguy\'aan kh\'abng \'a9m, kh\'abng v\'ad\'eet qu\'b8 32767. C\'b8
c b\'b6ng qu\'b6ng c\'b8o \'ae\'ad\'eec hi\'d3n th\'de tr\'aan m\'e9t b\'b6ng th\'abng tin \'aei\'d6n t\'f6 l\'c7n l\'ad\'eet t\'f5 1 \'ae\'d5n N theo ch\'d5 \'ae\'e9 c\'b8c c\'f6a s\'e8 \'ae\'cc l\'aan nhau, b\'b6ng 1 n\'bbm d\'ad\'edi, b\'b6ng N n\'bb
m tr\'aan c\'efng. \'a7\'d3 \'aei\'d2u khi\'d3n b\'b6ng qu\'b6ng c\'b8o ng\'ad\'eai ta d\'efng c\'b8c l\'d6nh :
\par }\pard\plain \qj\widctlpar \f41\fs28\lang2057 {\b T i}  \tab : \'ae\'ada b\'b6ng i l\'aan \'ae\'c7u.
\par {\b B  i \tab }: \'ae\'ada b\'b6ng i v\'d2 cu\'e8i.
\par {\b U  i  j}  : \'ae\'ada b\'b6ng i l\'aan tr\'ad\'edc b\'b6ng i+j, n\'d5u i+j>N th\'d7 ph\'d0p n\'b5y t\'ad\'acng \'ae\'ad\'acng T i
\par {\b D  i  j}  : \'ae\'ada b\'b6ng i xu\'e8ng sau b\'b6ng i-j, n\'d5u i-j<1 th\'d7 ph\'d0p n\'b5y t\'ad\'acng \'ae\'ad\'acng B i
\par {\b R  i } \tab : xoay b\'b6ng i g\'e3c 90{\super 0} , t\'a9m quay l\'b5 g\'e3c tr\'aan ph\'b6i.
\par {\b C  i }  \tab : t\'ddnh di\'d6n t\'ddch ph\'c7n nh\'d7n th\'cay \'ae\'ad\'eec c\'f1a b\'b6ng i.
\par Sau m\'e7i c\'a9u l\'d6nh ( tr\'f5 c\'a9u l\'d6nh C ) d\'b7y c\'b8c b\'b6ng \'ae\'ad\'eec \'ae\'b8nh s\'e8 l\'b9i theo chi\'d2u t\'f5 d\'ad\'edi l\'aan tr\'aan l\'b5 1 \'ae\'d5n N.
\par H\'b7y l\'cbp tr\'d7nh nh\'cbp N, to\'b9 \'ae\'e9 c\'b8c b\'b6ng, c\'b8c l\'d6nh \'aei\'d2u khi\'d3n, \'ae\'ada ra k\'d5t qu\'b6 th\'f9c hi\'d6n c\'b8c l\'d6nh C, v\'edi m\'e7i l\'d6nh C c\'c7n \'ae\'ada ra di\'d6n t\'ddch ph\'c7n nh\'d7n th\'cay \'ae\'ad
\'eec v\'b5 t\'fb l\'d6 ph\'c7n tr\'a8m nh\'d7n th\'cay so v\'edi to\'b5n b\'b6ng.
\par {\b D\'f7 li\'d6u v\'b5o file RECLAM.INP
\par {\pntext\pard\plain\f1\fs28 \'b7\tab}}\pard \qj\fi-360\li360\widctlpar\tx360{\*\pn \pnlvlblt\pnf1\pnstart56\pnindent360\pnhang{\pntxtb \'b7}}D\'dfng \'ae\'c7u ghi s\'e8 nguy\'aan N
\par {\pntext\pard\plain\f1\fs28 \'b7\tab}N d\'dfng ti\'d5p theo m\'e7i d\'dfng 4 s\'e8 nguy\'aan X,Y,U,V
\par {\pntext\pard\plain\f1\fs28 \'b7\tab}C\'b8c d\'dfng ti\'d5p theo m\'e7i d\'dfng m\'e9t l\'d6nh \'aei\'d2u khi\'d3n.
\par \pard \qj\widctlpar {\b K\'d5t qu\'b6 ghi ra file RECLAM.OUT }m\'e7i d\'dfng \'f8ng v\'edi 1 l\'d6nh C c\'f1a file d\'f7 li\'d6u v\'b5o, g\'e5m 1 s\'e8 nguy\'aan v\'b5 m\'e9t s\'e8 th\'f9c v\'edi 2 ch\'f7 s\'e8 ph\'c7n th\'cbp ph\'a9n (di\'d6n t\'ddch v
\'b5 t\'fb l\'d6 ph\'c7n tr\'a8m )
\par {\b H\'b9n ch\'d5 :}{\i  N<=100
\par }\pard \qj\li1260\widctlpar {\b RECLAM.INP\tab \tab RECLAM.OUT
\par }800 3\tab \tab \tab \tab 800 66.67{\b 
\par }10 30  40  10
\par 20  20  60  0
\par 0    40  30  0
\par U  1  2 
\par C   2
\par \pard\plain \s16\qj\widctlpar \f11\fs20 {\i\f41\fs28 H\'ad\'edng d\'c9n:}{\f41\fs28  }{\f42\fs28 \'b8}{\f41\fs28 p d\'f4ng b\'b5i to\'b8n 7, d\'d4 d\'b5ng t\'ddnh \'ae\'ad\'eec S1=di\'d6n t\'ddch h\'d7nh do i-1 h\'d7nh n\'bbm ph\'dda tr\'aan h\'d7nh i t
\'b9o th\'b5nh, v\'b5 t\'ddnh \'ae\'ad\'eec S2=di\'d6n t\'ddch h\'d7nh do i h\'d7nh  n\'b5y t\'b9o th\'b5nh. T\'f5 \'ae\'e3 suy ra ph\'c7n h\'d7nh nh\'d7n th\'cay (nh\'d7n t\'f5 tr\'aan xu\'e8ng ) c\'f1a h\'d7nh th\'f8 i l\'b5 S2-S1.
\par }{\b\f45 uses  crt;
\par const max  = 100;
\par       fi   = 'reclamp.ina';
\par       fo   = 'reclamp.gva';
\par type  kcn  = record  left,up,right,down  : integer; end;
\par       m1   = array[1..max] of kcn;
\par       m2   = array[1..max*2] of integer;
\par       kl   = record tl,s1,s2 : byte; end;
\par var   n,sx      : byte;
\par       f         : text;
\par       a         : m1;
\par       x,y,b     : m2;
\par       l         : array [1..5000] of kl;
\par       sl        : integer;
\par       ds        : longint;
\par Procedure readinp;
\par     var i : byte;
\par         p : char;
\par     begin
\par         assign(f,fi);reset(f);
\par         readln(f,n);
\par         for i:=1 to n do
\par             with a[i] do readln(f,left,up,right,down);
\par         sl:=0;
\par         while not seekeof(F) do
\par         begin
\par                  inc(sl);
\par                  read(f,p);
\par                  with l[sl] do
\par                  case p of
\par                       'T':begin read(f,s1);tl:=1;end;
\par                       'B':begin read(f,s1);tl:=2;end;
\par                       'U':begin read(f,s1,s2);tl:=3;end;
\par                       'D':begin read(f,s1,s2);tl:=4;end;
\par                       'R':begin read(f,s1);tl:=5;end;
\par                       'C':begin read(f,s1);tl:=6;end;
\par                  end;
\par                  readln(f);
\par         end;
\par         close(f);
\par     end;
\par function trong(trai1,tren1,phai1,duoi1,trai2,tren2,phai2,duoi2:integer):boolean
\par     begin
\par          trong:=(trai1>=trai2)and(duoi1>=duoi2)
\par          and(phai1<=phai2)and(tren1<=tren2);
\par     end;
\par function co(trai,tren,phai,duoi:integer;k:byte):byte;
\par     var i : byte;
\par     begin
\par          co:=0;
\par          for i:=k to n do
\par          with a[i] do
\par          if trong(trai,tren,phai,duoi,left,up,right,down) then
\par          begin co:=1;exit;end;
\par     end;
\par procedure nap(k : byte);
\par     var i,j : byte;
\par         c   : integer;
\par     begin
\par         for i:=1 to (n-k+1) do
\par         begin
\par              x[i] := a[k-1+i].left;
\par              y[i] := a[k-1+i].up;
\par              x[n-k+1+i] := a[k-1+i].right;
\par              y[n-k+1+i] := a[k-1+i].down;
\par         end;
\par         sx := 2*(n-k+1);
\par         for i:=1 to sx-1 do
\par         for j:=i+1 to sx do
\par         if x[i]>x[j] then
\par         begin
\par              c:=x[i];x[i]:=x[j];x[j]:=c;
\par         end;
\par         for i:=1 to sx-1 do
\par         for j:=i+1 to sx do
\par         if y[i]>y[j] then
\par         begin
\par              c:=y[i];y[i]:=y[j];y[j]:=c;
\par         end;
\par     end;
\par function timdt(k : byte): longint;
\par     var i,j  : integer;
\par     begin
\par         nap(k);
\par         ds:=0;
\par         for i:=1 to sx-1 do
\par         for j:=1 to sx-1 do
\par         ds:=ds+co(x[i],y[j+1],x[i+1],y[j],k)*(x[i+1]-x[i])*(y[j+1]-y[j]);
\par         timdt:= ds;
\par     end;
\par function dthi(i:byte):longint;
\par     begin
\par          dthi:=timdt(i)-timdt(i+1);
\par     end;
\par procedure thl(s : byte);
\par     var i,j : integer;
\par         c   : kcn;
\par     procedure ch(s,k:byte);
\par     var i : byte;
\par         begin
\par              c:=a[s];
\par              if k>s then for i:=s to k-1 do a[i]:=a[i+1]
\par              else for i:=s downto k+1 do a[i]:=a[i-1];
\par              a[k]:=c;
\par         end;
\par     procedure xoay(s:byte);
\par         begin
\par             c:=a[s];
\par             with a[s] do
\par             begin
\par                  left:=c.right;
\par                  right:=c.right+c.up-c.down;
\par                  down:=c.up-c.right+c.left;
\par             end;
\par         end;
\par     procedure tinh(s:byte);
\par         var ds,toanthe : longint;
\par         begin
\par             ds:=dthi(s);
\par             toanthe := (a[s].right-a[s].left)*(a[s].up-a[s].down);
\par             writeln(f,ds,' ',((ds/toanthe)*100):4:2);
\par         end;
\par     begin
\par          with l[s] do
\par          case tl of
\par               1:ch(s1,n);
\par               2:ch(s1,1);
\par               3:if s1+s2>n then ch(s1,n) else ch(s1,s1+s2);
\par               4:if s1-s2<1 then ch(s1,1) else ch(s1,s1-s2);
\par               5:xoay(s1);
\par               6:tinh(s1);
\par          end;
\par     end;
\par procedure done;
\par     var i,j : integer;
\par     begin
\par         assign(f,fo);rewrite(f);
\par         for i:=1 to sl do thl(i);
\par         close(f);
\par     end;
\par BEGIN
\par     readinp;
\par     done;
\par }\pard \s16\qj\sl360\slmult1\widctlpar {\b\f45 END.
\par }\pard \s16\qj\widctlpar {\b\f41\fs28 B\'b5i 13. }{\f41\fs28 Cho m\'e9t l\'ad\'edi \'ab vu\'abng k\'ddch th\'ad\'edc MxN (M}{\f41\fs28 {\field{\*\fldinst SYMBOL 163 \\f "Symbol" \\s 14}{\fldrslt\f1\fs28}}}{\f41\fs28 50, N}{\f41\fs28 {\field{\*\fldinst 
SYMBOL 163 \\f "Symbol" \\s 14}{\fldrslt\f1\fs28}}}{\f41\fs28 8). M\'e7i \'ab vu\'abng \'ae\'ad\'eec chia th\'b5nh 4 mi\'d2n b\'bbng hai \'ae\'ad\'eang ch\'d0o, m\'e7i mi\'d2n \'ae\'ad\'eec t\'ab \'aeen ho\'c6c tr\'beng. V\'edi b\'cat c\'f8 m\'e9t \'ab n
\'b5o, c\'e3 th\'d3 l\'cay giao \'aei\'d3m hai \'ae\'ad\'eang ch\'d0o c\'f1a \'ab \'ae\'e3 l\'b5m t\'a9m v\'b5 xoay \'ab \'ae\'e3 \'aei m\'e9t g\'e3c 90}{\f41\fs28\super 0}{\f41\fs28 , 180}{\f41\fs28\super 0}{\f41\fs28  ho\'c6c 270}{\f41\fs28\super 0}{
\f41\fs28 . T\'f5 m\'e9t b\'b6ng ban \'ae\'c7u, ng\'ad\'eai ta mu\'e8n xoay c\'b8c \'ab sao cho hai mi\'d2n chung c\'b9nh ph\'b6i c\'e3 c\'efng m\'b5u. T\'cat nhi\'aan l\'b5 c\'e3 nhi\'d2u c\'b8ch xoay c\'b8c \'ab \'ae\'d3 \'ae\'b9t \'ae\'ad\'eec mong mu
\'e8n nh\'adng y\'aau c\'c7u \'ae\'c6t ra l\'b5 t\'d7m m\'e9t c\'b8ch xoay c\'b8c \'ab sao cho t\'e6ng s\'e8 \'ab ph\'b6i th\'f9c hi\'d6n ph\'d0p xoay l\'b5 nh\'e1 nh\'cat c\'e3 th\'d3 \'ae\'ad\'eec.
\par D\'f7 li\'d6u v\'b5o t\'f5 file v\'a8n b\'b6n XOAY.INP bao g\'e5m: D\'dfng \'ae\'c7u l\'b5 hai ss\'e8 M v\'b5 N, TRONG M d\'dfng ti\'d5p theo, d\'dfng th\'f8 i g\'e5m N b\'e9 4 s\'e8 (x}{\f41\fs28\sub ij1}{\f41\fs28 , x}{\f41\fs28\sub ij2,}{\f41\fs28 , x}
{\f41\fs28\sub ij3}{\f41\fs28 , x}{\f41\fs28\sub ij4}{\f41\fs28 ) th\'d3 hi\'d6n t\'d7nh tr\'b9ng c\'b8c mi\'d2n t\'b9i \'ab (i, j) tr\'aan b\'b6ng v\'edi quy \'ad\'edc: 1: mi\'d2n t\'ab \'aeen, 0: mi\'d2n t\'ab tr\'beng v\'b5 x}{\f41\fs28\sub ij1}{
\f41\fs28 :mi\'d2n tr\'aan, x}{\f41\fs28\sub ij2,}{\f41\fs28 :mi\'d2n tr\'b8i, x}{\f41\fs28\sub ij3 }{\f41\fs28 :mi\'d2n d\'ad\'edi, x}{\f41\fs28\sub ij4 }{\f41\fs28 :mi\'d2n ph\'b6i.
\par K\'d5t qu\'b6 ghi ra file XOAY.OUT nh\'ad sau: n\'d5u kh\'abng xoay th\'d7 ghi s\'e8 0, n\'d5u t\'e5n t\'b9i nghi\'d6m th\'d7 d\'dfng \'ae\'c7u ti\'aan ghi t\'e6ng s\'e8 ph\'d0p xoay, ti\'d5p theo l\'b5 M d\'dfng, m\'e7i d\'dfng N b\'e9 s\'e8 cho bi\'d5
t t\'d7nh tr\'b9ng c\'f1a b\'b6ng sau khi th\'f9c hi\'d6n c\'b8c ph\'d0p xoay.
\par }{\i\f41\fs28 V\'dd d\'f4:}{\f41\fs28 
\par }\trowd \trgaph108\trleft810\trbrdrt\brdrs\brdrw15 \trbrdrl\brdrs\brdrw15 \trbrdrb\brdrs\brdrw15 \trbrdrr\brdrs\brdrw15 \trbrdrh\brdrs\brdrw15 \trbrdrv\brdrs\brdrw15 \clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr
\brdrs\brdrw15 \cellx4320\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cellx7740 \pard \s16\qc\widctlpar\intbl {\f41\fs24 XOAY.INP\cell XOAY.OUT\cell }\pard\plain \widctlpar\intbl \f41\fs28\lang2057 \row 
\trowd \trgaph108\trleft810\trbrdrt\brdrs\brdrw15 \trbrdrl\brdrs\brdrw15 \trbrdrb\brdrs\brdrw15 \trbrdrr\brdrs\brdrw15 \trbrdrh\brdrs\brdrw15 \trbrdrv\brdrs\brdrw15 \clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr
\brdrs\brdrw15 \cellx4320\clbrdrt\brdrs\brdrw15 \clbrdrl\brdrs\brdrw15 \clbrdrb\brdrs\brdrw15 \clbrdrr\brdrs\brdrw15 \cellx7740 \pard\plain \s16\qj\widctlpar\intbl \f11\fs20 {\f41\fs24 2  2
\par 1  0  0  0  1  0  1  0
\par 0  0  0  1  0  0  0  1\cell 2
\par 1  0  0  0  1  0  1  0
\par 0  1  0  0  1  0  0  0\cell }\pard\plain \widctlpar\intbl \f41\fs28\lang2057 \row \pard\plain \s23\qj\widctlpar \f41\cf1 {\i 
\par }{\i\fs28 Thu\'cbt to\'b8n: }{\fs28 Theo quy \'ad\'edc: T\'ab m\'b5u \'aeen \'f8ng v\'edi m\'b7 s\'e8 1, t\'ab m\'b5u tr\'beng \'f8ng v\'edi s\'e8 0. Gi\'b6 s\'f6 ta \'aeang x\'d0t m\'e9t d\'dfng n\'b5o \'ae\'e3, c\'b8c \'ab tr\'aan c\'f1a d\'dfng n\'b5
y theo th\'f8 t\'f9 t\'f5 tr\'b8i qua ph\'b6i t\'b9o n\'aan m\'e9t d\'b7y nh\'de ph\'a9n, c\'b8c \'ab d\'ad\'edi c\'f1a d\'dfng n\'b5y c\'f2ng t\'b9o n\'aan m\'e9t d\'b7y nh\'de ph\'a9n. Do c\'b8c mi\'d2n chung c\'b9nh \'ab ph\'b6i c\'efng m\'b5u n\'aan d
\'b7y nh\'de ph\'a9n c\'b8c \'ab d\'ad\'edi c\'f1a m\'e9t d\'dfng ch\'ddnh l\'b5 d\'b7y nh\'de ph\'a9n c\'f1a c\'b8c \'ab tr\'aan c\'f1a d\'dfng ti\'d5p theo trong b\'b6ng. \'a7\'e9 d\'b5i m\'e9t d\'dfng kh\'abng qu\'b8 8 \'ab n\'aan m\'e7i d\'b7y nh\'de
 ph\'a9n n\'b5y \'f8ng v\'edi m\'e9t s\'e8 trong h\'d6 th\'cbp ph\'a9n  n\'bbm trong kho\'b6ng (0, 2}{\fs28\super 8}{\fs28 ).
\par B\'a9y gi\'ea ta x\'d0t m\'e9t b\'b5i to\'b8n con: T\'d7m c\'b8ch xoay m\'e9t s\'e8 \'ddt nh\'cat c\'b8c \'ab n\'b5o tr\'aan d\'dfng sao cho  c\'b8c mi\'d2n tr\'aan c\'f1a d\'dfng t\'b9o th\'b5nh s\'e8 x, c\'b8c mi\'d2n d\'ad\'edi t\'b9o th\'b5nh s\'e8
 y, c\'b8c mi\'d2n c\'dfn l\'b9i n\'d5u chung c\'b9nh \'ab th\'d7 ph\'b6i c\'efng m\'b5u. C\'e3 th\'d3 gi\'b6i b\'b5i to\'b8n con b\'bbng ph\'ad\'acng ph\'b8p duy\'d6t (n\'d5u N}{\fs28 {\field{\*\fldinst SYMBOL 163 \\f "Symbol" \\s 14}{\fldrslt\f1\fs28}}}
{\fs28 8) ho\'c6c b\'bbng quy ho\'b9ch \'ae\'e9ng khi N l\'edn h\'acn 8. 
\par B\'b5i to\'b8n c\'f1a ch\'f3ng ta, ph\'b6i k\'d5t h\'eep tr\'b9ng th\'b8i c\'b8c d\'dfng. T\'e6 ch\'f8c m\'b6ng hai chi\'d2u D[1..M, 1..2}{\fs28\super N}{\fs28 ], m\'b5 D[i, j] cho bi\'d5t s\'e8 \'ab t\'e8i thi\'d3u  \'ae\'b7 xoay \'ae\'d3 i d\'dfng \'ae
\'c7u ti\'aan c\'f1a m\'b6ng tho\'b6 m\'b7n y\'aau c\'c7u \'ae\'d2 b\'b5i v\'b5 mi\'d2n d\'ad\'edi c\'f1a d\'dfng th\'f8 i t\'b9o n\'aan s\'e8 j (i=1..M, j=1..2}{\fs28\super N}{\fs28 ). Nh\'cbn th\'cay:
\par }\pard \s23\qj\li720\widctlpar {\fs28 D[i, j] = Min\{ D[i-1,k] + X }{\fs28\sub ikj}{\fs28  \}   i=1.. M, j = 1.. 2}{\fs28\super N}{\fs28 ,  k = 1.. 2}{\fs28\super N }{\fs28  \}
\par }\pard \s23\qj\widctlpar {\fs28 X}{\fs28\sub ikj}{\fs28  l\'b5 s\'e8 t\'e8i thi\'d3u c\'b8c \'ab tr\'aan d\'dfng i \'ae\'ad\-\'eec xoay \'ae\'d3 d\'dfng i c\'e3 mi\'d2n tr\'aan t\'ad\-\'acng \'f8ng k, mi\'d2n d\-\'ad\'edi t\'ad\'acng \'f8ng l\'b5 j (k\'d5
t qu\'b6 b\'b5i to\'b8n con n\'aau tr\'aan).
\par G\'e4i Kq l\'b5 k\'d5t qu\'b6 t\'e8i \-\'adu nh\'cat t\'f8c l\'b5 s\'e8 t\'e8i thi\'d3u c\'b8c \'ab ph\'b6i xoay \'ae\'e8i v\'edi c\'b6 b\'b6ng M d\'dfng th\'d7:
\par }\pard \s23\qc\widctlpar {\fs28 Kq = Min \{ D[M,k] , k=1..2}{\fs28\super N}{\fs28  \}
\par }\pard \s23\qj\widctlpar {\fs28 \'a7\'d3 qu\'b6n l\'fd nh\'f7ng \'ab \'ae\'ad\-\'eec xoay, ta t\'e6 ch\'f8c m\'b6ng hai chi\'d2u Pre[1..M,1..2}{\fs28\super N}{\fs28 ]. Ta bi\'d5t D[i,j] = Min \{ D[i-1,k] + X}{\fs28\sub ikj}{\fs28  \} n\'aan ta g\'b8
n Pre[i,j]=k trong \'ae\'e3 k l\'b5 gi\'b8 tr\'de m\'b5 D[i-1,k] + X}{\fs28\sub ikj}{\fs28  nh\'e1 nh\'cat. L\'c7n ng\'ad\-\'eec trong m\'b6ng Pre s\'cf t\'d7m \'ae\'ad\'eec c\'b8c \'ab \'ae\'b7 xoay.
\par }\pard\plain \s16\qj\widctlpar \f11\fs20 {\b\f45 uses crt;
\par  const
\par       inp='xoay.in';
\par       out='xoay.out';
\par       mmax=50;
\par       nmax=8;
\par       tt :array[1..8]of byte=(1,3,7,15,31,63,127,255);
\par       x  :array[1..4]of byte=(0,1,1,1);
\par  type
\par      m_int=array[0..mmax,0..255]of word;
\par      m_byt=array[0..mmax,0..255]of byte;
\par      tto=array[1..4]of byte;           \{trang thai o\}
\par  var
\par     f:text;
\par     m,n,ttmax:byte;                 \{trang thai max\}
\par     a:array[1..mmax,1..nmax]of tto; \{trang thai dau nhap tu input\}
\par     pre:m_byt;              \{so ung voi cac mien tren tren 1 dong\}
\par     d:m_int;
\par         \{d[i,j] - so o xoay it nhat de dua dong i ve trang thai j\}
\par     \{danh cho tim cach xoay\}
\par     bt,bd :byte;                              \{bit tren, bit duoi\}
\par     xmo   :array[1..4]of tto;         \{xet 4 trang thai tai mot o\}
\par     trai,sbd,prex:array[1..nmax,1..4]of word;  \{sbd - so bien doi\}
\par   procedure nhap;
\par     var i,j,k:byte;
\par    begin
\par     assign(f,inp);
\par     reset(f);
\par     readln(f,m,n);
\par     for i:=1 to m do
\par       begin
\par        for j:=1 to n do
\par          for k:=1 to 4 do read(f,a[i,j,k]);
\par        readln(f);
\par       end;
\par     close(f);
\par    end;
\par   procedure khoitao;
\par     var i:byte;
\par    begin
\par     ttmax:=tt[n];
\par     for i:=0 to ttmax do
\par       begin
\par         d[0,i]:=0;
\par         pre[0,i]:=0;
\par       end;
\par    end;
\par   procedure getbit(so,vt:byte;var bit:byte);
\par    begin
\par     bit:=(so shr vt) and 1;
\par    end;
\par   procedure xoay90(tto1:tto;var tto2:tto);\{trang thai o1 -> trang thai o2\}
\par    begin
\par     tto2[1]:=tto1[2];    tto2[2]:=tto1[3];
\par     tto2[3]:=tto1[4];    tto2[4]:=tto1[1];
\par    end;
\par   procedure xoay180(tto1:tto;var tto2:tto);
\par    begin
\par     tto2[1]:=tto1[3];    tto2[2]:=tto1[4];
\par     tto2[3]:=tto1[1];    tto2[4]:=tto1[2];
\par    end;
\par   procedure xoay270(tto1:tto;var tto2:tto);
\par    begin
\par     tto2[1]:=tto1[4];    tto2[2]:=tto1[1];
\par     tto2[3]:=tto1[2];    tto2[4]:=tto1[3];
\par    end;
\par   procedure tinh_xoay(i,st,sd:byte;var temp:integer;var ttc:byte);
\par     var  k,t,s:byte;\{xoay cac o dong i sao cho so tren=st, so duoi=sd\}
\par    begin
\par     xmo[1]:=a[i,1];           xoay90(a[i,1],xmo[2]);
\par     xoay180(a[i,1],xmo[3]);   xoay270(a[i,1],xmo[4]);
\par     getbit(st,0,bt); getbit(sd,0,bd);
\par     for t:=1 to 4 do
\par      if (xmo[t,1]=bt)and(xmo[t,3]=bd) then
\par        begin
\par         trai[1,t]:=xmo[t,4]; sbd[1,t]:=x[t];
\par        end
\par       else trai[1,t]:=2;
\par     \{\}
\par     for k:=2 to n do
\par      begin
\par       xmo[1]:=a[i,k];           xoay90(xmo[1],xmo[2]);
\par       xoay90(xmo[2],xmo[3]);    xoay90(xmo[3],xmo[4]);
\par       getbit(st,k-1,bt); getbit(sd,k-1,bd);
\par       for t:=1 to 4 do
\par         begin
\par            sbd[k,t]:=maxint;
\par            for s:=1 to 4 do
\par             if (xmo[t,1]=bt)and(xmo[t,2]=trai[k-1,s])and(xmo[t,3]=bd)
\par                          and(sbd[k,t]>sbd[k-1,s]+x[t]) then
\par                  begin
\par                      sbd[k,t]:=sbd[k-1,s]+x[t];
\par                      trai[k,t]:=xmo[t,4];
\par                      prex[k,t]:=s;
\par                   end;
\par         end;
\par      end;
\par     temp:=maxint;
\par     for k:=1 to 4 do
\par      if temp>sbd[n,k] then
\par       begin
\par        temp:=sbd[n,k]; \{so lan bien doi (xoay o) it nhat\}
\par        ttc:=k;
\par       end;
\par    end;
\par   procedure xuly;
\par     var i,j,k,ttc:byte;
\par         temp:integer;
\par    begin
\par     for i:=1 to m do
\par      begin
\par       for j:=0 to ttmax do
\par        begin
\par         d[i,j]:=maxint;
\par         for k:=0 to ttmax do
\par           begin
\par             tinh_xoay(i,k,j,temp,ttc);
\par             if d[i,j]>d[i-1,k]+temp then
\par               begin
\par                   d[i,j]:=d[i-1,k]+temp;
\par                   pre[i,j]:=k;
\par               end;
\par           end;
\par        end;
\par      end;
\par    end;
\par   procedure sua_mang(i,ttc:byte);
\par     var k,t:byte;
\par    begin
\par     for k:=n downto 1 do
\par       begin
\par         case ttc of
\par            2:xoay90(a[i,k],a[i,k]);
\par            3:xoay180(a[i,k],a[i,k]);
\par            4:xoay270(a[i,k],a[i,k]);
\par          end;
\par         ttc:=prex[k,ttc];
\par       end;
\par    end;
\par   procedure inkq;
\par     var
\par        min,temp:integer;
\par        i,j,k,ttc,vt:byte;
\par    begin
\par     min:=maxint;
\par     for i:=0 to ttmax do
\par      if d[m,i]<min then
\par       begin
\par        min:=d[m,i];
\par        vt:=i;
\par       end;
\par     assign(f,out);
\par     rewrite(f);
\par     if min<>maxint then
\par     begin
\par        writeln(f,min);
\par        for i:=m downto 1 do
\par        begin
\par           tinh_xoay(i,pre[i,vt],vt,temp,ttc);
\par           sua_mang(i,ttc);
\par           vt:=pre[i,vt];
\par        end;
\par        for i:=1 to m do
\par        begin
\par           for j:=1 to n do
\par            for k:=1 to 4 do write(f,a[i,j,k]:2);
\par           writeln(f);
\par        end;
\par     end
\par     else writeln(f,0);
\par     close(f);
\par    end;
\par  BEGIN
\par   clrscr;
\par   nhap;
\par   khoitao;
\par   xuly;
\par   inkq;
\par  END.
\par }\pard\plain \qj\widctlpar \f41\fs28\lang2057 
\par }