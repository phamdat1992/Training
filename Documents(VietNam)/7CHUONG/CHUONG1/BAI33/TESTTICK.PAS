{$A+,B-,D+,E+,F-,G-,I+,L+,N-,O-,P-,Q-,R-,S+,T-,V+,X+}
{$M 16384,0,655360}

 (*   Cham bai Xep hang mua ve TICK  *)
program        Hoa_Tra_My ;
uses crt;
const
     fin: string = 'TICK.INP';
     fou: string = 'TICK.OUT';
     dapso: array['0'..'9'] of longint =
     (390290,
	 3044,
	 8373,
	 40850,
	 393544,
	 97806,
     92221,
     227912,
     281177,
     288893);

var
    n: longint;
    sopt, sum: real;
    cx: array[0..3000] of boolean;
    t, r: array[0..3000] of longint;
    fopt, ds: longint;
    f   : text;
    chon: char;
    diem: integer;

procedure Cham;
var    i: longint;
begin
    diem:=0;
    assign(f,fin); reset(f);
    readln(f,n);
    for i:=1 to n do read(f,t[i]);
    for i:=1 to n-1 do read(f,r[i]);
    close(f);

    assign(f,fou); reset(f);
    readln(f,ds);
    fillchar(cx, sizeof(cx), false);
    while not seekeoln(f) do
    begin
        read(f,i);
        if (i<1) or (i>n) then
        begin
            writeln('???????????????????????????????????????????????????');
            writeln('        E R R O R:  Khong co chi so: ',i);
            writeln('???????????????????????????????????????????????????');
            exit;
        end;
        cx[i]:=true;
    end;
    close(f);

    for i:=n downto 2 do
        if ( cx[i]) and (cx[i-1]) then
        begin
            writeln('???????????????????????????????????????????????????');
            writeln(' E R R O R:  ');
            writeln('           Nguoi ',i,' va ',i+1,' cung doi khoi hang ');
            writeln('???????????????????????????????????????????????????');
            exit;
        end;

    fopt:=0;
    for i:=1 to n do fopt:=fopt+t[i];
    for i:=1 to n do
       if cx[i] then
          fopt:=fopt-t[i]-t[i-1]+r[i-1];

    if ds<> fopt then
    begin
       writeln('???????????????????????????????????????????????????');
       writeln('    ERROR: Tinh khong dung thoi gian');
	   writeln('                 Ghi o file        : ',ds:16);
	   writeln('                 Tinh theo loi giai: ',fopt:16);
       writeln('???????????????????????????????????????????????????');
       exit;
    end;

    if fopt > dapso[chon] then
    begin
           writeln('???????????????????????????????????????????????????');
           writeln('    ERROR: Khong dung dap so: Tong tim duoc = ',fopt:16);
           writeln('                                     Dap so = ',dapso[chon]: 16);
           writeln('???????????????????????????????????????????????????');
           exit;
    end;
    writeln; writeln;writeln;
    writeln('***********************************************');
    writeln('        C O R R E C T !   C O R R E C T!');
    writeln('***********************************************');
    diem:=1;
end;

BEGIN
   Clrscr;
   writeln('            ===========================================');
   writeln('                  CHUONG TRINH CHAM BAI: TICK');
   writeln('            ===========================================');
   write  ('                  Cho ten file test: TICK.IN');
   chon:=readkey; writeln(chon);
   fin:= 'TICK.IN'+chon;
   Cham;
   writeln; writeln;
   writeln('            ====================================');
   writeln('                       Diem: ',diem);
   writeln('            ====================================');
   readln;
End.
