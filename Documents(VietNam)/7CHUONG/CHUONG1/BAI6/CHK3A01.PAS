{$Q+,R+,N+}
{   CHUONG TRINH CHAM BAI 3: VONG QUANH THE GIOI - VOI 2001 }
uses    crt;
const
   fin     : string = 'BL3.INP';
   fou     : string = 'BL3.OUT';
   dapso   : array ['1'..'8'] of comp =
   (3871,
    5874624,
    24749200,
    57071,
    1932232,
    2449638525.,
    3688648809.0,
    949273164524.0);

type
        arrlong  = array [0..10000] of longint;
        arrint   = array [0..10000] of integer;
var
   f   : text;
   a   : arrlong;
   path: arrint;
   n   : integer;
   diem: real;
   p   : comp;
   chon: char;
   ds1, ds2: boolean;

procedure ReadInput;
var
   i: integer;
begin
   assign(f, fin); reset(f);
   readln(f, n);
   readln(f, p);
   a[0]:= 0;
   for i:= 1 to n do read(f, a[i]);
   close(f);
end;

procedure Cham;
var
   i, ns    : integer;
   q, ans, ans1: comp;
begin
    ReadInput;
    ds1:=false; ds2:=false;
    assign(f, fou); reset(f);
    readln(f, ans);
    readln(f, ns);
    diem:=0;
    if ans = dapso[chon] then
    begin
       diem:= diem+0.5;
       ds1:=true;
    end
    else
    begin
       writeln;
       writeln('      ?????????????????????????????????????????????');
       writeln('           Error:   Luong phat khong dung dap so?');
       writeln('      ?????????????????????????????????????????????');
    end;
    path[0] := 0;
    for i := 1 to ns do
    begin
       if seekeof(f) then
       begin
          writeln;
          writeln('      ?????????????????????????????????????????????');
          writeln('           Error:   Khong du diem dung?');
          writeln('      ?????????????????????????????????????????????');
          exit;
       end;
       read(f, path[i]);
       if (path[i]>n) or (path[i]<=0) then
       begin
          writeln;
          writeln('      ???????????????????????????????????????????????');
          writeln('           Error: Chi so diem dung ngoai lai?');
          writeln('      ???????????????????????????????????????????????');
          exit;
       end;
       if path[i] < path[i-1] then
       begin
          writeln;
          writeln('     ??????????????????????????????????????????????');
          writeln('           Error: Diem dung khong theo thu tu?');
          writeln('     ??????????????????????????????????????????????');
          exit;
       end;
    end;
    if path[ns] <> n then
    begin
         writeln;
         writeln('      ????????????????????????????????????????????');
         writeln('            Error: Khong dung o dia diem dich?');
         writeln('      ????????????????????????????????????????????');
         exit;
    end;
    ans1:= 0;
    for i:= 1 to ns do
    begin
        q:= p - a[path[i]] + a[path[i-1]];
        ans1:= ans1 + q*q;
    end;
    if  ans1 = dapso[chon] then
    begin
        diem:=diem+0.5;
        ds2:=true;
    end
    else
    begin
       writeln;
       writeln('      ?????????????????????????????????????????????????????????');
       writeln('           Error:  Duong di khong toi uu?');
       writeln('           Luong phat tinh theo loi giai: ',ans1:16:0);
       writeln('                                  Dap so: ',dapso[chon]:16:0);
       writeln('      ?????????????????????????????????????????????????????????');
    end;
    close(f);
end;

BEGIN
     clrscr;
     writeln;
     writeln('        CHUONG TRINH CHAM BAI 3: VONG QUANH THE GIOI - VOI 2001');
     writeln('        =======================================================');
     write('                 Cho ten file du lieu: BL3.IN');
     chon := readkey;  writeln(chon);
     fin := 'BL3.IN' + chon;
     Cham;
     writeln; writeln;
     TextColor(LightRed);
     if ds1 or ds2 then
        writeln('           ####################################');
     if ds1 and ds2 then
        writeln('                       P E R F E C T !')
     else
     begin
        if ds1 then
           writeln('                Chi tra loi dung tong phat !');
        if ds2 then
           writeln('                Chi tra loi dung cach di !');
     end;
     if ds1 or ds2 then
           writeln('           ####################################');
     writeln; writeln; writeln; writeln;
     TextColor(Yellow);
     writeln('           $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$');
     writeln('                       Diem: ', diem:3:1);
     writeln('           $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$');
     TextColor(White);
     readln;
END.