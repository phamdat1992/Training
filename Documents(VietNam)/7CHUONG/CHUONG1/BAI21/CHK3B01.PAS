{$Q+,R+}
{   CHUONG TRINH CHAM BAI 3 'TRUYEN TIN'  KHOI B - VOI 2001 }
uses    crt;
const
   fin     : string = 'BL3.IN3';
   fou     : string = 'BL3.OUT';
   dapso   : array ['1'..'5'] of longint = (32, 16000, 12, 31, 71);
   halfpoint: array ['1'..'5'] of real = ( 1, 1, 1, 0.5, 0.5);

type
   arrn  =  array[0..100, 0..100] of integer;
var
   n, m : integer;
   s    : arrn;
   xopt : array[0..100] of integer;
   f    : text;
   diem : real;
   chon : char;
   ds1, ds2: boolean;

procedure ReadInput;
var
   i, j: integer;
begin
    fillchar(s, sizeof(s), 0);
    assign(f,fin); reset(f);
    readln(f, n, m);
    for i:=1 to m  do
      for j:=1 to n do read(f,s[i,j]);
    close(f);
    for i:=1 to m  do
      for j:=1 to n do
        if (s[i,j]<=0) or (s[i,j]>32760) then
                          writeln('Data Error:',s[i,j]);
end;

procedure Cham;
var
   i, ns    : integer;
   sum, ans, sogoitin: longint;
begin
    ReadInput;
    ds1:=false; ds2:=false;
    assign(f, fou); reset(f);
    readln(f,ans);
    diem:=0;
    if ans = dapso[chon] then
    begin
       diem:= diem+ halfpoint[chon];
       ds1:=true;
    end
    else
    begin
       writeln;
       writeln('      ?????????????????????????????????????????????');
       writeln('           Error:   Chi phi khong dung dap so?');
       writeln('      ?????????????????????????????????????????????');
    end;
    sum:=0; sogoitin:=0;
    for i := 1 to m do
    begin
       if seekeof(f) then
       begin
          writeln;
          writeln('      ?????????????????????????????????????????????');
          writeln('           Error:   Loi giai in khong du?');
          writeln('      ?????????????????????????????????????????????');
          exit;
       end;
       read(f, xopt[i]);
       sogoitin:=sogoitin+xopt[i];
       if (xopt[i]>n) or (xopt[i]<0) then
       begin
          writeln;
          writeln('      ???????????????????????????????????????????????????');
          writeln('           Error: So luong goi tin vuot khoang [0,n]?');
          writeln('      ???????????????????????????????????????????????????');
          exit;
       end;
       sum:=sum+s[i,xopt[i]];
    end;
    if sogoitin <> n then
    begin
         writeln;
         writeln('      ???????????????????????????????????????????????????');
         writeln('            Error: Tong so goi tin duoc truyen <> n ?');
         writeln('      ???????????????????????????????????????????????????');
         exit;
    end;
    if  sum = dapso[chon] then
    begin
        diem:=diem+ halfpoint[chon];
        ds2:=true;
    end
    else
    begin
       writeln;
       writeln('      ?????????????????????????????????????????????????????????');
       writeln('           Error:  Chi phi khong toi uu?');
       writeln('                   Tinh theo loi giai: ', sum:6);
       writeln('                               Dap so: ',dapso[chon]:6);
       writeln('      ?????????????????????????????????????????????????????????');
    end;
    close(f);
end;

BEGIN
     clrscr;
     writeln;
     writeln('        CHUONG TRINH CHAM BAI 3 "TRUYEN TIN"  KHOI B - VOI 2001');
     writeln('        =======================================================');
     write('                 Cho ten file du lieu: BL3.IN');
     chon := readkey;  writeln(chon);
     fin := 'BL3.IN' + chon;
     Cham;
     writeln; writeln;
     TextColor(LightRed);
     if ds1 or ds2 then
        writeln('           ####################################');
     if ds1 and ds2 then
        writeln('                       P E R F E C T !')
     else
     begin
        if ds1 then
           writeln('                Chi tra loi dung chi phi !');
        if ds2 then
           writeln('                Chi tra loi dung loi giai !');
     end;
     if ds1 or ds2 then
           writeln('           ####################################');
     writeln; writeln; writeln; writeln;
     TextColor(Yellow);
     writeln('           $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$');
     writeln('                       Diem: ', diem:3:1);
     writeln('           $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$');
     TextColor(White);
     readln;
END.