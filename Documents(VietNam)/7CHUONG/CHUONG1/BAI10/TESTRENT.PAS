{$R+,B-}
(**********************************************************)
(*          Cham bai: Cho thue phong                      *)
(**********************************************************)
uses crt;
const
   fi: string   =  'RENTING.INP';
   fo           =  'RENTING.OUT';
   max          =  1000;
   dapso: array['0'..'9'] of longint
         = (29348721,172051, 428670, 516676, 748505, 1576388,
            11027614,12104064,17845858,20030680);

type
   arr          =  array[0..max] of longint;
var
   f            :  text;
   d, c, viec, a  :  arr;
   n            :  integer;
   chon: char;
   diem: integer;

procedure Cham;
var i, j, k, n0, n1, vi, cost: longint;
begin
   assign(f,fi); reset(f);
   readln(f,n);
   for i:=1 to n do read(f,d[i],c[i],a[i]);
   close(f);
   diem:=0;
   assign(f,fo); reset(f);
   readln(f,n0,n1);
   writeln('Ket qua ghi o file: Loi nhuan: ',n1:10);
   writeln('                       Dap so: ', dapso[chon]:10);
   for i:=1 to n do viec[i]:=0;
   cost:=0;
   for i:=1 to n0 do
   begin
       read(f,vi);
       if (vi<0) or (vi>n) then
       begin
           writeln('????????????????????????????????????????');
           writeln('   ERROR:  Khong co khach hang: ', vi);
           writeln('????????????????????????????????????????');
           exit;
       end;
       if (viec[vi]<>0) then
       begin
           writeln('????????????????????????????????????????');
           writeln('   ERROR:  Khach hang: ', vi,' lap lai!');
           writeln('????????????????????????????????????????');
           exit;
       end;
       viec[vi]:=1; cost:=cost+a[vi];
   end;
   close(f);
   for i:=1 to n do
      if viec[i]<>0 then
          for j:= i+1 to n do
             if (viec[j]<>0)  then
                if ((d[i]>=d[j]) and (d[i]<= c[j]))
                   or ((d[j]>=d[i]) and (d[j]<=c[i]))
                then
                begin
                    writeln('????????????????????????????????????????');
                    writeln('   ERROR:  Khoang thoi gian giao nhau:');
                    writeln('Khach hang: ', i,' va ',j);
                    writeln('(',d[i],', ',c[i],') ');
                    writeln('(',d[j],', ',c[j]);
                    writeln('????????????????????????????????????????');
                    exit;
                end;
   writeln('Ket qua tim theo cach phuc vu: ',cost:10); writeln;
   if cost <> n1 then
   begin
       writeln('????????????????????????????????????????????');
       writeln('    ERROR:  Khong khop voi ket qua cong bo!!!');
       writeln('????????????????????????????????????????????');
       exit;
   end;
   if (cost< dapso[chon]) then
   begin
           writeln('????????????????????????????????????????????');
           writeln('          ERROR:  Khong toi uu !');
           writeln('????????????????????????????????????????????');
           exit;
   end;
   diem:=1;
   writeln;
   writeln('$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$');
   writeln('        C O R R E C T!');
   writeln('$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$');
end;

BEGIN
     clrscr;
     writeln('     CHUONG TRINH CHAM BAI: RENTING ROOM');
     writeln('     ===============================');
     write  ('        Cho ten file: RENTING.IN'); chon:=readkey;
     writeln(chon); fi:='RENTING.IN'+chon;
     Cham;
     writeln;
     writeln('                  ***************************');
     writeln('                           Diem: ',diem);
     writeln('                  ***************************');
     readln;
END.
