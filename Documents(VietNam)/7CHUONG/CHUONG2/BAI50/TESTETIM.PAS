{$R+,B-}
{$M 65520,0,655360}
Uses Crt ;
Const
   fi: string   =  'ETIME.INP';
   fo           =  'ETIME.OUT';
   max          =  100;
   dapso: array['0'..'9'] of longint =
   (100200,
    10593,
    11327,
    15928,
    27069,
    31856,
    41311,
    54851,
    69633,
    81676);
type
   mang         =  array[1..max] of integer;
Var
  p, r, ind, tt :  mang;
  n,time        :  longint;
  a             :  array[0..max,0..max] of byte;
  f             :  text;
  chon          :  char;
  diem          : integer;

Procedure Nhapdl;
var i, c: integer ;
Begin
   fillchar(a,sizeof(a),0);
   assign(f,fi);  reset(f);
   readln(f,n);
   for i:=1 to n do read(f,p[i]);
   for i:=1 to n do read(f,r[i]);
   readln(f);
   for i:=1 to n do
   begin
      while not seekeoln(f) do
      begin
          read(f,c);
          a[i,c]:=1;
      end;
      readln(f);
   end;
   close(f);
End;

procedure Cham;
var  i, j: integer;
     s, time: longint;
begin
    Nhapdl;
    assign(f,fo); reset(f);
    readln(f,s);
    if s<>dapso[chon] then
    begin
        writeln('??????????????????????????????????????????????');
        writeln('    ERROR:  Khong toi uu! ', s);
        writeln('            Tinh duoc: ',s);
        writeln('            Dap so   : ',dapso[chon]);
        writeln('???????????????????????????????????????????????');
        exit;
    end;
    for i:=1 to n do ind[i]:=0;
    for i:=1 to n do
    begin
        read(f,j);
        if (j<0) or (j>n) then
        begin
            writeln('??????????????????????????????????????????????');
            writeln('    ERROR:  Khong co chi so viec: ', j);
            writeln('???????????????????????????????????????????????');
            exit;
        end;
        if ind[j]<>0 then
        begin
            writeln('??????????????????????????????????????????????');
            writeln('    ERROR:  Cong viec: ', j, ' bi lap lai!');
            writeln('???????????????????????????????????????????????');
            exit;
        end;
        ind[j]:=1;
        tt[i]:=j;
    end;
    for i:=1 to n-1 do
    begin
       for j:=i+1 to n do
           if a[tt[i],tt[j]]=1 then
           begin
               writeln('??????????????????????????????????????????????');
               writeln('    ERROR:  Cong viec: ', tt[j], ' phai thuc hien sau ', tt[i],' !');
               writeln('???????????????????????????????????????????????');
               exit;
           end;
    end;
    time:=r[tt[1]]+p[tt[1]];
    for i:=2 to n do
    begin
        if time<r[tt[i]] then time:=r[tt[i]];
        time:= time+p[tt[i]];
    end;
    if time<>s then
    begin
        writeln('???????????????????????????????????????????????????????????????');
        writeln('    ERROR:  Tinh thoi diem hoan thanh khong khop lich! ');
        writeln('            Cong bo       : ',s);
        writeln('            Tinh theo lich: ',time);
        writeln('???????????????????????????????????????????????????????????????');
    end;


    writeln;
    writeln('$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$');
    writeln('        C O R R E C T!');
    writeln('$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$');
    diem:=1;
end;

BEGIN
     clrscr;
     writeln('     CHUONG TRINH CHAM BAI: ETIME');
     writeln('     ==============================');
     write  ('        Cho ten file: ETIME.IN'); chon:=readkey;
     writeln(chon); fi:='ETIME.IN'+chon;
     Cham;
     writeln;
     writeln('                  ***************************');
     writeln('                           Diem: ', diem:3);
     writeln('                  ***************************');
     readln;
END.

