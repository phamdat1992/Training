

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="vn"
xml:lang="vn">

<head>
<title>VNOI - Olympic tin học Việt Nam - Các phương pháp giải bài toán LCA</title>
<meta name="title" content="Các phương pháp giải bài toán LCA" />
<meta name="author" content="Ngô Minh Đức" />
<meta name="description" content="vnoi.info - Olympic tin học Việt Nam, trang web được xây dựng và phát triển bởi cựu học sinh các khối chuyên toán - tin học trên cả nước, với mong muốn trở thành nơi giao lưu, trao đổi, lưu trữ những tài liệu về toán tin cho mọi người." />
<meta name="keywords" content="thuật toán,olympic tin học,VNOI,VOI,IOI,ioicamp,hsgqg,thi quốc gia,thi quốc tế" />
<meta name="robots" content="index, follow" />
		<script src="http://vnoi.info/includes/js/joomla.javascript.js" type="text/javascript"></script>
			<link rel="shortcut icon" href="http://vnoi.info/images/favicon.ico" />
	<meta name="google-site-verification" content="phbjWUHoYBbyO5aU0szJB-_0EI16innG1CClcj86mTA" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta property="fb:app_id" content="236244595457" />

<script src='http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js'></script>
<script src='http://vnoi.info/components/com_voj2/static/js/voj.php'></script>
<script src='http://vnoi.info/components/com_voj2/static/js/php.default.min.js'></script>
<script src='http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js'></script>
<script src='includes/js/jquery.cookie.js'></script>
<link href="http://vnoi.info/templates/Simple/css/template_css.php" rel="stylesheet" type="text/css" />
<link href='http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/themes/redmond/jquery-ui.css' rel='stylesheet' type='text/css'>
<link href='http://vnoi.info/components/com_voj2/static/css/simple.css' rel='stylesheet' type='text/css'>
<link href="https://plus.google.com/116784799773001234591/" rel="publisher" />
<script language="javascript" type="text/javascript" src="http://vnoi.info/templates/Simple/scripts/ja.script.js.php"></script>
<link href="http://vnoi.info/templates/Simple/css/colors/default.css" rel="stylesheet" type="text/css" />
		<script type="text/javascript">
		var currentFontSize = 3;
		</script>
	<link href="http://vnoi.info/templates/Simple/ja_cssmenu/ja-sosdmenu.css.php" rel="stylesheet" type="text/css" />
					<script language="javascript" type="text/javascript" src="http://vnoi.info/templates/Simple/ja_cssmenu/ja.cssmenu.js"></script>


<!--[if lte IE 6]>
<style type="text/css">
.clearfix {	height: 1%;}
</style>
<![endif]-->

<!--[if gte IE 7.0]>
<style type="text/css">
.clearfix {	display: inline-block;}
</style>
<![endif]-->

</head>

<body id="bd" class="auto fs3">

<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=236244595457";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<a title="Skip to content" href="#Content" style="display: none;">Skip to content</a>

<!-- BEGIN: HEADER -->
<a name="Top" id="Top"></a>
<div id="ja-headerwrap">

<div id="ja-header" class="clearfix" style="background: url(http://vnoi.info/templates/Simple/images/default/header-deco//header-deco2.gif) no-repeat bottom right;">

<table id='ja-header-table'>
<tr>	
	<td width='30%'>
				<div id="ja-usertoolswrap">
			<div id="ja-usertools">
						<span class="ja-usertools">
	    <a href="#Narrow" onclick="setScreenType('narrow');return false;"><img title="Narrow screen" src="http://vnoi.info/templates/Simple/images/default/user-screen1.gif" alt="Narrow screen resolution" id="ja-tool-narrow" onclick="changeToolHilite(curtool, this);curtool=this;" /></a>
	    <a href="#Wide" onclick="setScreenType('wide');return false;"><img title="Wide screen" src="http://vnoi.info/templates/Simple/images/default/user-screen2.gif" alt="Wide screen resolution" id="ja-tool-wide" onclick="changeToolHilite(curtool, this);curtool=this;" /></a>
	    <a href="#Auto" onclick="setScreenType('auto');return false;"><img title="Auto adjust screen size" src="http://vnoi.info/templates/Simple/images/default/user-screen3-hilite.gif" alt="Auto adjust screen size" id="ja-tool-auto" onclick="changeToolHilite(curtool, this);curtool=this;" /></a>
		<a href="#Increase" onclick="changeFontSize(1); return false;"><img title="Increase font size" src="http://vnoi.info/templates/Simple/images/default/user-increase.gif" alt="Increase font size" id="ja-tool-increase" /></a>
	    <a href="#Decrease" onclick="changeFontSize(-1); return false;"><img title="Decrease font size" src="http://vnoi.info/templates/Simple/images/default/user-decrease.gif" alt="Decrease font size" id="ja-tool-decrease" /></a>
	    <a href="#Default" onclick="revertStyles(3); return false;"><img title="Default size" src="http://vnoi.info/templates/Simple/images/default/user-reset.gif" alt="Default font size" id="ja-tool-reset" /></a>
    </span>
	<script type="text/javascript">
	var curtool = document.getElementById('ja-tool-auto');
	</script>
						    <span class="ja-colorthemes">
	     	<a href="#default" onclick="setActiveStyleSheet('default');"><img style="cursor: pointer;" src="http://vnoi.info/templates/Simple/images/default/default-hilite.gif" title="default color" alt="default color" id="ja-tool-defaultcolor" onclick="changeToolHilite(curcolor, this);curcolor=this;return false;" /></a>
	     	<a href="#grey" onclick="setActiveStyleSheet('grey');"><img style="cursor: pointer;" src="http://vnoi.info/templates/Simple/images/default/grey.gif" title="grey color" alt="grey color" id="ja-tool-greycolor" onclick="changeToolHilite(curcolor, this);curcolor=this;return false;" /></a>
	    </span>
	<script type="text/javascript">
	var curcolor = document.getElementById('ja-tool-defaultcolor');
	</script>
						
			</div>
		</div>
			</td>
	<td width='40%' style='text-align:center'>		
		<div style="width:100%; overflow: hidden; padding:0px; border-width:0px; margin:0px;">
<form action="http://vnoi.info/index.php?option=com_comprofiler&amp;task=logout" method="post" id="mod_login_logoutform" style="margin:0px;">
<span id="mod_login_greeting">Xin chào, phamdat1992 (<a href="index.php?option=com_voj2&page=user&user=avanti" class="userLink"><span class='coderTextViolet'>avanti</span></a>)</span>&nbsp;&nbsp;<input type="submit" name="Submit" class="button" value="Đăng xuất" />
<input type="hidden" name="op2" value="logout" />
<input type="hidden" name="lang" value="vietnam" />
<input type="hidden" name="return" value="http://vnoi.info/index.php" />
<input type="hidden" name="message" value="0" />
<input type="hidden" name="j992066ec2cdfc557158260ac94225189" value="1" />
</form></div><link rel="stylesheet" href="http://vnoi.info/components/com_uddeim/templates/default/css/uddemodule.css" type="text/css" /><div id='uddeim-module'><p class='uddeim-module-head'><a href='http://vnoi.info/index.php?option=com_uddeim&task=inbox&Itemid=108'>Hộp tin nhắn</a> <a href='http://vnoi.info/index.php?option=com_uddeim&task=inbox&Itemid=108'><img border='0' src='http://vnoi.info/components/com_uddeim/templates/default/images/env.gif' alt='' /></a>: không có tin mới</p></div>		
	</td>	
	<td width='20%' style='text-align:center'>		
				
	</td>	
	<td width='10%' style='text-align:right'>		
		<form method="get" action="http://www.google.com.vn/custom" target="_top">	<input type="hidden" name="domains" value="vnoi.info"></input>	<label for="sbi" style="display: none">Nhập các thuật ngữ tìm kiếm của bạn</label>	<input type="text" class='inputbox' name="q" size="20" maxlength="255" value="Tìm kiếm..." id="sbi" onblur="if(this.value=='') { this.value='Tìm kiếm...'; return false; }" onfocus="if (this.value=='Tìm kiếm...') this.value=''"></input>	<input type="radio" name="sitesearch" value="" id="ss0"></input>		<label for="ss0" title="Tìm kiếm trên Web"><font size="-1" color="#000000">Web</font></label>	<input type="radio" name="sitesearch" value="vnoi.info" checked id="ss1"></input>	<label for="ss1" title="Tìm kiếm trên VNOI"><font size="-1" color="#000000">VNOI</font></label>	<label for="sbb" style="display: none">Nộp mẫu đơn tìm kiếm</label>		<input type="hidden" name="client" value="partner-pub-8920598838256811:i68u0a-v74o"></input>	<input type="hidden" name="forid" value="1"></input>	<input type="hidden" name="ie" value="UTF-8"></input>	<input type="hidden" name="oe" value="UTF-8"></input>	<input type="hidden" name="safe" value="active"></input>	<input type="hidden" name="cof" value="GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:FFFFFF;LBGC:FFFFFF;ALC:0000FF;LC:0000FF;T:000000;GFNT:0000FF;GIMP:0000FF;LH:120;LW:600;L:http://vnoi.info/templates/Simple/images/VNOI-vn.gif;S:http://vnoi.info;FORID:1"></input>	<input type="hidden" name="hl" value="vi"></input></form>		
	</td>		
</tr>
<tr>
	<td colspan='2'>
		<a href="index.php"><img width='400' src="http://vnoi.info/templates/Simple/images/VNOI-vn.gif" alt="VNOI - Olympic tin học Việt Nam" /></a>		
	</td>
	</td>
<td>

			
</td>
</tr>
</table>

<!-- BEGIN: MAIN NAVIGATION -->
<div id="ja-mainnav">
<div class="sfmenu-inner"><!-- Begin menu -->
<ul id="ja-cssmenu" class="clearfix">

<li class="havechild">
   <a href="http://vnoi.info/index.php?option=com_fireboard&amp;Itemid=26"  id="menu26" title="Diễn đàn"><span>Diễn đàn</span></a>
   <ul>
   <li>
      <a href="http://vnoi.info/index.php?option=com_comprofiler&amp;Itemid=28"  id="menu28" title="Hồ sơ"><span>Hồ sơ</span></a>
   </li>
   <li>
      <a href="http://vnoi.info/index.php?option=com_comprofiler&amp;task=usersList "  id="menu68" title="Danh sách thành viên"><span>Danh sách thành viên</span></a>
   </li>
   <li>
      <a href="http://vnoi.info/index.php?option=com_uddeim&amp;Itemid=108"  id="menu108" title="Gửi tin nhắn"><span>Gửi tin nhắn</span></a>
   </li>
   <li>
      <a href="http://vnoi.info/index.php?option=com_content&amp;task=category&amp;sectionid=5&amp;id=54&amp;Itemid=145"  id="menu145" title=" Phỏng vấn"><span> Phỏng vấn</span></a>
   </li>
   <li class="havesubchild">
      <a href="http://vnoi.info/#"  id="menu134" title="Games"><span>Games</span></a>
      <ul>
      <li>
         <a href="http://vnoi.info/index.php?option=com_games&amp;task=sudoku"  id="menu135" title="Sudoku"><span>Sudoku</span></a>
      </li>
      <li>
         <a href="http://vnoi.info/index.php?option=com_games&amp;task=mario"  id="menu136" title="Mario"><span>Mario</span></a>
      </li>
      <li>
         <a href="http://vnoi.info/index.php?option=com_games&amp;task=battleships"  id="menu137" title="Battleships"><span>Battleships</span></a>
      </li>
      <li>
         <a href="http://vnoi.info/index.php?option=com_games&amp;task=gomoku"  id="menu138" title="Gomoku (cờ Carô)"><span>Gomoku (cờ Carô)</span></a>
      </li>
      <li>
         <a href="http://vnoi.info/index.php?option=com_puarcade&amp;Itemid=143"  id="menu143" title="PU Arcade"><span>PU Arcade</span></a>
      </li>
      </ul>
   </li>
   </ul>
</li>
<li class="havechild active">
   <a href="http://vnoi.info/index.php?option=com_docman&amp;Itemid=27" class = "active" id="menu27" title="Thư viện"><span>Thư viện</span></a>
   <ul>
   <li class="havesubchild">
      <a href="http://vnoi.info/index.php?option=com_content&amp;task=section&amp;id=4&amp;Itemid=69"  id="menu69" title="Đề thi"><span>Đề thi</span></a>
      <ul>
      <li class="havesubchild">
         <a href="http://vnoi.info/index.php?option=com_content&amp;task=blogcategory&amp;id=0&amp;Itemid=70"  id="menu70" title="VOI (thi quốc gia)"><span>VOI (thi quốc gia)</span></a>
         <ul>
         <li>
            <a href="http://vnoi.info/index.php?option=com_content&amp;task=category&amp;sectionid=4&amp;id=58&amp;Itemid=183"  id="menu183" title="2010"><span>2010</span></a>
         </li>
         <li>
            <a href="http://vnoi.info/index.php?option=com_content&amp;task=category&amp;sectionid=4&amp;id=56&amp;Itemid=156"  id="menu156" title="2009"><span>2009</span></a>
         </li>
         <li>
            <a href="http://vnoi.info/index.php?option=com_content&amp;task=category&amp;sectionid=4&amp;id=13&amp;Itemid=71"  id="menu71" title="2008"><span>2008</span></a>
         </li>
         <li>
            <a href="http://vnoi.info/index.php?option=com_content&amp;task=category&amp;sectionid=4&amp;id=14&amp;Itemid=72"  id="menu72" title="2007"><span>2007</span></a>
         </li>
         <li>
            <a href="http://vnoi.info/index.php?option=com_content&amp;task=category&amp;sectionid=4&amp;id=15&amp;Itemid=74"  id="menu74" title="2006"><span>2006</span></a>
         </li>
         <li>
            <a href="http://vnoi.info/index.php?option=com_content&amp;task=category&amp;sectionid=4&amp;id=16&amp;Itemid=76"  id="menu76" title="2005"><span>2005</span></a>
         </li>
         <li>
            <a href="http://vnoi.info/index.php?option=com_content&amp;task=category&amp;sectionid=4&amp;id=17&amp;Itemid=78"  id="menu78" title="2004"><span>2004</span></a>
         </li>
         <li>
            <a href="http://vnoi.info/index.php?option=com_content&amp;task=category&amp;sectionid=4&amp;id=18&amp;Itemid=77"  id="menu77" title="2003"><span>2003</span></a>
         </li>
         <li>
            <a href="http://vnoi.info/index.php?option=com_content&amp;task=category&amp;sectionid=4&amp;id=19&amp;Itemid=101"  id="menu101" title="2002"><span>2002</span></a>
         </li>
         </ul>
      </li>
      <li class="havesubchild">
         <a href="http://vnoi.info/index.php?option=com_content&amp;task=blogcategory&amp;id=0&amp;Itemid=117"  id="menu117" title="VOI2 (thi vòng 2)"><span>VOI2 (thi vòng 2)</span></a>
         <ul>
         <li>
            <a href="http://vnoi.info/index.php?option=com_content&amp;task=category&amp;sectionid=4&amp;id=49&amp;Itemid=119"  id="menu119" title="2008"><span>2008</span></a>
         </li>
         <li>
            <a href="http://vnoi.info/index.php?option=com_content&amp;task=category&amp;sectionid=4&amp;id=48&amp;Itemid=118"  id="menu118" title="2007"><span>2007</span></a>
         </li>
         <li>
            <a href="http://vnoi.info/index.php?option=com_content&amp;task=category&amp;sectionid=4&amp;id=28&amp;Itemid=73"  id="menu73" title="2006"><span>2006</span></a>
         </li>
         <li>
            <a href="http://vnoi.info/index.php?option=com_content&amp;task=category&amp;sectionid=4&amp;id=29&amp;Itemid=75"  id="menu75" title="2005"><span>2005</span></a>
         </li>
         </ul>
      </li>
      <li class="havesubchild">
         <a href="http://vnoi.info/index.php?option=com_content&amp;task=blogcategory&amp;id=0&amp;Itemid=97"  id="menu97" title="IOI (thi quốc tế)"><span>IOI (thi quốc tế)</span></a>
         <ul>
         <li>
            <a href="http://vnoi.info/index.php?option=com_content&amp;task=category&amp;sectionid=4&amp;id=37&amp;Itemid=103"  id="menu103" title="2006"><span>2006</span></a>
         </li>
         <li>
            <a href="http://vnoi.info/index.php?option=com_content&amp;task=category&amp;sectionid=4&amp;id=36&amp;Itemid=99"  id="menu99" title="2005"><span>2005</span></a>
         </li>
         <li>
            <a href="http://vnoi.info/index.php?option=com_content&amp;task=category&amp;sectionid=4&amp;id=39&amp;Itemid=104"  id="menu104" title="2004"><span>2004</span></a>
         </li>
         <li>
            <a href="http://vnoi.info/index.php?option=com_content&amp;task=category&amp;sectionid=4&amp;id=40&amp;Itemid=105"  id="menu105" title="2003"><span>2003</span></a>
         </li>
         <li>
            <a href="http://vnoi.info/index.php?option=com_content&amp;task=category&amp;sectionid=4&amp;id=41&amp;Itemid=106"  id="menu106" title="2002"><span>2002</span></a>
         </li>
         <li>
            <a href="http://vnoi.info/index.php?option=com_content&amp;task=category&amp;sectionid=4&amp;id=42&amp;Itemid=107"  id="menu107" title="2001"><span>2001</span></a>
         </li>
         </ul>
      </li>
      <li class="havesubchild">
         <a href="http://vnoi.info/index.php?option=com_content&amp;task=blogcategory&amp;id=31&amp;Itemid=90"  id="menu90" title="OLPSV"><span>OLPSV</span></a>
         <ul>
         <li>
            <a href="http://vnoi.info/index.php?option=com_content&amp;task=category&amp;sectionid=5&amp;id=31&amp;Itemid=91"  id="menu91" title="2005"><span>2005</span></a>
         </li>
         <li>
            <a href="http://vnoi.info/index.php?option=com_content&amp;task=category&amp;sectionid=5&amp;id=35&amp;Itemid=96"  id="menu96" title="2004"><span>2004</span></a>
         </li>
         </ul>
      </li>
      <li class="havesubchild">
         <a href="http://vnoi.info/index.php?option=com_content&amp;task=blogcategory&amp;id=22&amp;Itemid=79"  id="menu79" title="vCoder"><span>vCoder</span></a>
         <ul>
         <li>
            <a href="http://vnoi.info/index.php?option=com_content&amp;task=category&amp;sectionid=4&amp;id=22&amp;Itemid=80"  id="menu80" title="vCoder.08"><span>vCoder.08</span></a>
         </li>
         </ul>
      </li>
      <li>
         <a href="http://vnoi.info/index.php?option=com_docman&amp;task=cat_view&amp;gid=34&amp;Itemid=27"  id="menu95" title="PTNK"><span>PTNK</span></a>
      </li>
      <li>
         <a href="http://vnoi.info/index.php?option=com_docman&amp;task=cat_view&amp;gid=33&amp;Itemid=27"  id="menu127" title="ACM"><span>ACM</span></a>
      </li>
      </ul>
   </li>
   <li class="havesubchild active">
      <a href="http://vnoi.info/index.php?option=com_content&amp;task=blogcategory&amp;id=0&amp;Itemid=81" class = "active" id="menu81" title="Bài viết"><span>Bài viết</span></a>
      <ul>
      <li>
         <a href="http://vnoi.info/index.php?option=com_content&amp;task=category&amp;sectionid=5&amp;id=25&amp;Itemid=82" class = "active" id="menu82" title="Thuật toán"><span>Thuật toán</span></a>
      </li>
      <li>
         <a href="http://vnoi.info/index.php?option=com_content&amp;task=category&amp;sectionid=5&amp;id=27&amp;Itemid=83"  id="menu83" title="Ngôn ngữ lập trình"><span>Ngôn ngữ lập trình</span></a>
      </li>
      <li>
         <a href="http://vnoi.info/index.php?option=com_content&amp;task=category&amp;sectionid=5&amp;id=26&amp;Itemid=84"  id="menu84" title="Khác"><span>Khác</span></a>
      </li>
      </ul>
   </li>
   <li>
      <a href="http://vnoi.info/index.php?option=com_docman&amp;task=cat_view&amp;gid=20&amp;Itemid=27"  id="menu66" title="Ebooks"><span>Ebooks</span></a>
   </li>
   <li>
      <a href="http://vnoi.info/index.php?option=com_bookmarks&amp;Itemid=102"  id="menu102" title="Danh bạ"><span>Danh bạ</span></a>
   </li>
   <li class="havesubchild">
      <a href="http://vnoi.info/index.php?option=com_voj&amp;task=viewCodeLib"  id="menu133" title="CodeLib"><span>CodeLib</span></a>
      <ul>
      <li>
         <a href="http://vnoi.info/index.php?option=com_voj&amp;task=addCode"  id="menu170" title="Thêm mã nguồn mới"><span>Thêm mã nguồn mới</span></a>
      </li>
      </ul>
   </li>
   <li>
      <a href="http://vnoi.info/index.php?option=com_expose&amp;Itemid=185"  id="menu185" title="Hình ảnh hoạt động"><span>Hình ảnh hoạt động</span></a>
   </li>
   </ul>
</li>
<li class="havechild">
   <a href="http://vnoi.info/index.php?option=com_voj2&amp;page=problem_list"  id="menu123" title="VOJ"><span>VOJ</span></a>
   <ul>
   <li>
      <a href="http://vnoi.info/index.php?option=com_voj2&amp;page=problem_list"  id="menu126" title="Danh sách bài tập"><span>Danh sách bài tập</span></a>
   </li>
   <li>
      <a href="http://vnoi.info/index.php?option=com_voj2&amp;page=submission_list"  id="menu177" title="Danh sách bài nộp"><span>Danh sách bài nộp</span></a>
   </li>
   <li>
      <a href="http://vnoi.info/index.php?option=com_voj2&amp;page=contest_list"  id="menu162" title="Danh sách kỳ thi"><span>Danh sách kỳ thi</span></a>
   </li>
   <li>
      <a href="http://vnoi.info/index.php?option=com_voj2&amp;page=prize_list"  id="menu180" title="Giải thưởng"><span>Giải thưởng</span></a>
   </li>
   <li class="havesubchild">
      <a href="http://vnoi.info/voj/rank/"  id="menu157" title="Bảng xếp hạng"><span>Bảng xếp hạng</span></a>
      <ul>
      <li>
         <a href="http://vnoi.info/index.php?option=com_voj2&amp;page=rank_list"  id="menu124" title="Thành viên"><span>Thành viên</span></a>
      </li>
      <li>
         <a href="http://vnoi.info/index.php?option=com_voj2&amp;page=school_list"  id="menu125" title="Trường"><span>Trường</span></a>
      </li>
      <li>
         <a href="http://vnoi.info/index.php?option=com_voj2&amp;page=ps_list"  id="menu139" title="Người gửi bài"><span>Người gửi bài</span></a>
      </li>
      <li>
         <a href="http://vnoi.info/index.php?option=com_voj2&amp;page=activity_rank"  id="menu184" title="Danh tiếng"><span>Danh tiếng</span></a>
      </li>
      </ul>
   </li>
   <li>
      <a href="http://vnoi.info/index.php?option=com_voj2&amp;page=score_table"  id="menu179" title="Bảng điểm chi tiết"><span>Bảng điểm chi tiết</span></a>
   </li>
   <li class="havesubchild">
      <a href="http://vnoi.info/index.php&amp;Itemid=158"  id="menu158" title="Hướng dẫn"><span>Hướng dẫn</span></a>
      <ul>
      <li>
         <a href="http://vnoi.info/index.php?option=com_voj2&amp;page=scoring"  id="menu178" title="Cách tính điểm"><span>Cách tính điểm</span></a>
      </li>
      <li>
         <a href="http://vnoi.info/index.php?option=com_content&amp;task=view&amp;id=171&amp;Itemid=140"  id="menu140" title="Cách tạo bài tập"><span>Cách tạo bài tập</span></a>
      </li>
      </ul>
   </li>
   <li>
      <a href="http://vnoi.info/index.php?option=com_voj2&amp;page=stat"  id="menu182" title="Thống kê"><span>Thống kê</span></a>
   </li>
   <li>
      <a href="http://vnoi.info/index.php?option=com_voj&amp;task=classify&amp;site=voj"  id="menu172" title="Phân loại bài tập"><span>Phân loại bài tập</span></a>
   </li>
   </ul>
</li>
<li class="havechild">
   <a href="http://vnoi.info/index.php?option=com_voj&amp;task=viewNProblemList"  id="menu146" title="N"><span>N</span></a>
   <ul>
   <li>
      <a href="http://vnoi.info/index.php?option=com_voj&amp;task=viewNProblemList"  id="menu147" title="Danh sách bài tập"><span>Danh sách bài tập</span></a>
   </li>
   <li>
      <a href="http://vnoi.info/index.php?option=com_voj&amp;task=viewNRankList"  id="menu148" title="Bảng xếp hạng"><span>Bảng xếp hạng</span></a>
   </li>
   <li>
      <a href="http://vnoi.info/index.php?option=com_content&amp;task=view&amp;id=178&amp;Itemid=149"  id="menu149" title="Giới thiệu"><span>Giới thiệu</span></a>
   </li>
   </ul>
</li>
<li class="havechild">
   <a href="http://vnoi.info/#"  id="menu174" title="Tools"><span>Tools</span></a>
   <ul>
   <li>
      <a href="http://vnoi.info/index.php?option=com_voj&amp;task=viewUsacoContestList"  id="menu175" title="USACO"><span>USACO</span></a>
   </li>
   <li>
      <a href="http://vnoi.info/index.php?option=com_voj&amp;task=viewCOCIContestList"  id="menu176" title="COCI"><span>COCI</span></a>
   </li>
   <li class="havesubchild">
      <a href="http://spoj.pl" target="_blank"  id="menu160" title="SPOJ"><span>SPOJ</span></a>
      <ul>
      <li>
         <a href="http://vnoi.info/index.php?option=com_voj&amp;task=spojStat"  id="menu161" title="View user statistics"><span>View user statistics</span></a>
      </li>
      <li>
         <a href="http://vnoi.info/index.php?option=com_voj&amp;task=classify&amp;site=spoj"  id="menu173" title="Problems Classification"><span>Problems Classification</span></a>
      </li>
      </ul>
   </li>
   </ul>
</li>

</ul><!-- End menu -->
</div></div>
<!-- END: MAIN NAVIGATION -->

</div>

</div>
<!-- END: HEADER -->


<div id="ja-containerwrap" class="clearfix">
<div id="ja-container">




<!-- BEGIN: LEFT COLUMN -->
<div id="ja-leftcol">
		<div class="module">
			<div>
				<div>
					<div>
						<h3>Hồ sơ VOJ của tôi</h3><div class='content'><table class='listTable'><tr><td class='fieldTitle' width='70%'>Hạng:</td><td>293</td></tr><tr><td class='fieldTitle' width='70%'>Điểm:</td><td>20.2</td></tr><tr><td class='fieldTitle' width='70%'>Danh tiếng:</td><td>+0</td></tr><tr><td class='fieldTitle' width='70%'>Số bài giải được / đã làm:</td><td>104 / 113</td></tr></table><table class="welcome"><tr><td><a href="index.php?option=com_voj2&page=user&user=avanti" class="userLink"><span class='coderTextViolet'>avanti</span></a></td><td><table><td style='padding-left:2px; padding-top: 2px;'><div id = 'progressBar_48174' style='width:50px; height:8px' class='question' title='Bạn đã đạt được 1.5 / 1.8 điểm cần để lên cấp bậc 21'></div><script>$('#progressBar_48174').progressbar({value:81.4326777627});</script></td><td style='padding-left:2px'><span class='coderTextViolet'>20</span></td></table></td><td style='padding-left:5px'><input type="submit" class="fbButton" value="Thoát" onclick="vojLogOut('<span class=\'coderTextViolet\'>avanti</span>');"/></td></tr></table></div>					</div>
				</div>
			</div>
		</div>
				<div class="module">
			<div>
				<div>
					<div>
						<h3>Điểm tin VOJ</h3><div class='content'><table class='listTable'><tr><td class='fieldTitle' width='50%'>Số thành viên:</td><td><a href="index.php?option=com_voj2&page=rank_list" title="Bảng xếp hạng">6831</a></td></tr><tr><td class='fieldTitle' width='50%'>Số bài tập:</td><td><a href="index.php?option=com_voj2&page=problem_list" title="Danh sách bài tập">1035</a></td></tr><tr><td class='fieldTitle' width='50%'>Số bài nộp:</td><td><a href="index.php?option=com_voj2&page=submission_list" title="Danh sách bài nộp">913743</a></td></tr><tr><td class='fieldTitle' width='50%'>Bài nộp hôm nay:</td><td>0</td></tr><tr><td class='fieldTitle' width='50%'>Thành viên xuất sắc trong ngày (31-08-2013):</td><td><a href="index.php?option=com_voj2&page=user&user=gawry" class="userLink"><span class='coderTextGray'>gawry</span></a> (0.0)</td></tr><tr><td class='fieldTitle' width='50%'>Thành viên xuất sắc trong tháng (08-2013):</td><td><a href="index.php?option=com_voj2&page=user&user=xinzhao" class="userLink"><span class='coderTextBlue'>xinzhao</span></a> (+143.8)</td></tr></table></div>					</div>
				</div>
			</div>
		</div>
				<div class="module">
			<div>
				<div>
					<div>
						<h3>Top 10 thành viên xuất sắc</h3><div class='content'><div class='widgetContent'>

<table class='dataTable'><tr><th width='20%'>Hạng</th><th width=''>Thành viên</th><th width='20%'>Điểm</th></tr><tr class = 'row0'><td class='center'>1</td><td class='left'><a href="index.php?option=com_voj2&page=user&user=mr_invincible" class="userLink"><span class='coderTextRed'>mr_invincible <img src="http://vnoi.info/components/com_voj2/static/images/internal/star.png" width="10" height="10"/></span></a></td><td class='center'>676.8</td></tr><tr class = 'row1'><td class='center'>2</td><td class='left'><a href="index.php?option=com_voj2&page=user&user=con_nha_ngheo" class="userLink"><span class='coderTextRed'>con_nha_ngheo</span></a></td><td class='center'>504.7</td></tr><tr class = 'row0'><td class='center'>3</td><td class='left'><a href="index.php?option=com_voj2&page=user&user=hieult" class="userLink"><span class='coderTextRed'>hieult</span></a></td><td class='center'>485.4</td></tr><tr class = 'row1'><td class='center'>4</td><td class='left'><a href="index.php?option=com_voj2&page=user&user=vodanh9x" class="userLink"><span class='coderTextRed'>vodanh9x</span></a></td><td class='center'>475.0</td></tr><tr class = 'row0'><td class='center'>5</td><td class='left'><a href="index.php?option=com_voj2&page=user&user=hiepsieunhan" class="userLink"><span class='coderTextPink'>hiepsieunhan</span></a></td><td class='center'>459.8</td></tr><tr class = 'row1'><td class='center'>6</td><td class='left'><a href="index.php?option=com_voj2&page=user&user=white_cobra" class="userLink"><span class='coderTextPink'>white_cobra</span></a></td><td class='center'>398.4</td></tr><tr class = 'row0'><td class='center'>7</td><td class='left'><a href="index.php?option=com_voj2&page=user&user=flash_mt" class="userLink"><span class='coderTextPink'>flash_mt</span></a></td><td class='center'>382.3</td></tr><tr class = 'row1'><td class='center'>8</td><td class='left'><a href="index.php?option=com_voj2&page=user&user=yenthanh132" class="userLink"><span class='coderTextOrange'>yenthanh132</span></a></td><td class='center'>377.4</td></tr><tr class = 'row0'><td class='center'>9</td><td class='left'><a href="index.php?option=com_voj2&page=user&user=royalsilver16" class="userLink"><span class='coderTextOrange'>royalsilver16</span></a></td><td class='center'>331.6</td></tr><tr class = 'row1'><td class='center'>10</td><td class='left'><a href="index.php?option=com_voj2&page=user&user=conankudo" class="userLink"><span class='coderTextOrange'>conankudo</span></a></td><td class='center'>317.7</td></tr></table>
</div>

<div class='right'>
  <a href="index.php?option=com_voj2&page=rank_list">Xem đầy đủ</a></div>

</div>					</div>
				</div>
			</div>
		</div>
		</div>
<!-- END: LEFT COLUMN -->



<!-- BEGIN: CONTENT -->
<div id="ja-mainbody-fr">
<a name="Content" id="Content"></a>

<div id="ja-content">


<div id="ja-pathway">
<span class="pathway"><a href="http://vnoi.info/index.php" class="pathway">Diễn đàn</a> <img src="http://vnoi.info/templates/Simple/images/arrow.png" border="0" alt="arrow" /> <a href="http://vnoi.info/index.php?option=com_docman&amp;Itemid=27" class="pathway">Thư viện</a> <img src="http://vnoi.info/templates/Simple/images/arrow.png" border="0" alt="arrow" /> <a href="http://vnoi.info/index.php?option=com_content&amp;task=blogcategory&amp;id=0&amp;Itemid=81" class="pathway">Bài viết</a> <img src="http://vnoi.info/templates/Simple/images/arrow.png" border="0" alt="arrow" /> <a href="http://vnoi.info/index.php?option=com_content&amp;task=category&amp;sectionid=5&amp;id=25&amp;Itemid=82" class="pathway">Thuật toán</a> <img src="http://vnoi.info/templates/Simple/images/arrow.png" border="0" alt="arrow" />   Các phương pháp giải bài toán LCA </span></div>
			<table class="contentpaneopen">
			<tr>
								<td class="contentheading" width="100%">
					Các phương pháp giải bài toán LCA									</td>
								<td align="right" width="100%" class="buttonheading">
					<a href="http://vnoi.info/index2.php?option=com_content&amp;task=view&amp;id=33&amp;pop=1&amp;page=0&amp;Itemid=82" target="_blank" onclick="window.open('http://vnoi.info/index2.php?option=com_content&amp;task=view&amp;id=33&amp;pop=1&amp;page=0&amp;Itemid=82','win2','status=no,toolbar=no,scrollbars=yes,titlebar=no,menubar=no,resizable=yes,width=640,height=480,directories=no,location=no'); return false;" title="In">
						<img src="http://vnoi.info/templates/Simple/images/printButton.png"  alt="In" name="In" align="middle" border="0" /></a>
				</td>
							<td align="right" width="100%" class="buttonheading">
				<a href="http://vnoi.info/index2.php?option=com_content&amp;task=emailform&amp;id=33&amp;itemid=82" target="_blank" onclick="window.open('http://vnoi.info/index2.php?option=com_content&amp;task=emailform&amp;id=33&amp;itemid=82','win2','status=no,toolbar=no,scrollbars=yes,titlebar=no,menubar=no,resizable=yes,width=400,height=250,directories=no,location=no'); return false;" title="E-mail">
					<img src="http://vnoi.info/templates/Simple/images/emailButton.png"  alt="E-mail" name="E-mail" align="middle" border="0" /></a>
			</td>
						</tr>
			</table>
			
<!-- JW AJAX Vote Plugin v1.1 starts here -->
<style type="text/css" media="screen">
	@import "http://vnoi.info/mambots/content/plugin_jw_ajaxvote/css/ajaxvote.css";
</style>	
<script type="text/javascript">
	var live_site = 'http://vnoi.info';
	var jwajaxvote_lang = new Array();
	jwajaxvote_lang['UPDATING'] = 'Updating...';
	jwajaxvote_lang['THANKS'] = 'Thanks for voting!';
	jwajaxvote_lang['ALREADY_VOTE'] = 'You have already voted for this item!';
	jwajaxvote_lang['VOTES'] = 'votes';
	jwajaxvote_lang['VOTE'] = 'vote';
</script>
<script type="text/javascript" src="http://vnoi.info/mambots/content/plugin_jw_ajaxvote/js/ajaxvote.php"></script>
<!-- JW AJAX Vote Plugin v1.1 ends here -->

<!-- JW AJAX Vote Plugin v1.1 starts here -->
<div class="jwajaxvote-inline-rating">
  <ul class="jwajaxvote-star-rating">
    <li id="rating33" class="current-rating" style="width:90.6%;"></li>
    <li><a href="javascript:void(null)" onclick="javascript:jwAjaxVote(33,1,308,68);" title="1 star out of 5" class="one-star">1</a></li>
    <li><a href="javascript:void(null)" onclick="javascript:jwAjaxVote(33,2,308,68);" title="2 stars out of 5" class="two-stars">2</a></li>
    <li><a href="javascript:void(null)" onclick="javascript:jwAjaxVote(33,3,308,68);" title="3 stars out of 5" class="three-stars">3</a></li>
    <li><a href="javascript:void(null)" onclick="javascript:jwAjaxVote(33,4,308,68);" title="4 stars out of 5" class="four-stars">4</a></li>
    <li><a href="javascript:void(null)" onclick="javascript:jwAjaxVote(33,5,308,68);" title="5 stars out of 5" class="five-stars">5</a></li>
  </ul>
  <div id="jwajaxvote33" class="jwajaxvote-box">
    (68 votes)  </div>
</div>
<div class="jwajaxvote-clr"></div>
<!-- JW AJAX Vote Plugin v1.1 ends here -->


		<table class="contentpaneopen">
					<tr>
				<td width="70%" align="left" valign="top" colspan="2">
					<span class="small">
						 Người viết:  Khúc Anh Tuấn					</span>
					&nbsp;&nbsp;
				</td>
			</tr>
						<tr>
				<td valign="top" colspan="2" class="createdate">
					24/03/2008				</td>
			</tr>
					<tr>
			<td valign="top" colspan="2">
				<div class="Section1">
<div align="center">
  
</div>
<h1 align="center"><span style="font-family: Arial">C&aacute;c phương ph&aacute;p giải b&agrave;i to&aacute;n LCA</span></h1>  
<p class="MsoTitle" align="center">
<span style="font-weight: normal; font-size: 10pt; font-family: Arial">This document was written by Khuc Anh Tuan-a member of VietNam&rsquo;s IOI team 2006</span>
</p>
    
<p class="MsoBodyText">
<span style="font-family: Arial">Như đ&atilde; tr&igrave;nh b&agrave;y ở mục &ldquo;Sự li&ecirc;n hệ giữa b&agrave;i to&aacute;n LCA v&agrave; b&agrave;i to&aacute;n RMQ&rdquo;, để giải b&agrave;i to&aacute;n LCA ta c&oacute; thể chuyển sang b&agrave;i to&aacute;n RMQ tương ứng v&agrave; c&oacute; thể giải bằng một số c&aacute;ch kh&aacute;c nhau. <span class="GramE">Trong mục n&agrave;y ch&uacute;ng ta sẽ đề cập tới một số phương ph&aacute;p giải b&agrave;i to&aacute;n LCA một c&aacute;ch trực tiếp.</span></span>
</p>
    
<p class="MsoBodyText">
<span style="font-family: Arial">B&agrave;i to&aacute;n LCA <span class="GramE">( Least</span> Common Ancestor ) :</span>
</p>
  
<p class="MsoBodyText">
<span style="font-family: Arial">Đầu <span class="GramE">v&agrave;o :</span> 1 c&acirc;y với n đỉnh.</span>
</p>
  
<p class="MsoBodyText">
<span style="font-family: Arial">Chất vấn : với 2 n&uacute;t u, v bất kỳ của c&acirc;y T, chất vấn LCA(u,v) cho biết cha chung gần nhất của 2 đỉnh u,v trong c&acirc;y T, tức l&agrave; cho biết đỉnh xa gốc nhất l&agrave; cha của cả u, v.</span>
</p>
</div>
   
<p>
<span style="font-size: 12pt">C&aacute;ch 1 :</span>
</p>
  
<p>
Từ c&acirc;y đầu v&agrave;o ta c&oacute; thể x&acirc;y dựng được mảng F[1&hellip;n] với F[i] cho ta biết n&uacute;t cha của n&uacute;t i. Sau đ&oacute; ta c&oacute; thể x&acirc;y dựng mảng A[1&hellip;n][0&hellip;logN] với A[i][j] cho ta biết n&uacute;t tổ ti&ecirc;n thứ 2^j của n&uacute;t i. X&acirc;y dựng mảng A mất NlogN sử dụng phương ph&aacute;p QHĐ. Gọi d(i) l&agrave; khoảng c&aacute;ch tới gốc của n&uacute;t i. Để x&aacute;c định LCA(u,v) ta thực hiện c&aacute;c bước sau :
</p>
  
<p style="margin-left: 21pt; text-indent: -18pt" class="MsoNormal">
<!--[if !supportLists]-->-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Giả sử d(u) &gt; d(v), ta thay u bằng một n&uacute;t tổ ti&ecirc;n của u đến khi d(u)=d(v).<!--[endif]-->
</p>
  
<p style="margin-left: 21pt; text-indent: -18pt" class="MsoNormal">
<!--[if !supportLists]-->-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Khi d(u)=d(v) ta thay u v&agrave; v bằng 2 n&uacute;t tổ ti&ecirc;n tương ứng sao cho vẫn thỏa m&atilde;n d(u)=d(v) đến khi u=v. Khi đ&oacute; ta c&oacute; được kết quả cần t&igrave;m.<!--[endif]-->
</p>
  
<p>
Tất nhi&ecirc;n trong qu&aacute; tr&igrave;nh thay một n&uacute;t bằng n&uacute;t tổ ti&ecirc;n của n&oacute;, ta sẽ sử dụng mảng A để c&oacute; thể nhảy một lần được nhiều bước. Khi đ&oacute; độ phức tạp của thuật to&aacute;n sẽ l&agrave; &lt;NlogN,LogN&gt;.
</p>
    
<p>
<span style="font-size: 12pt">C&aacute;ch 2 :</span>
</p>
  
<p>
Từ c&acirc;y đầu v&agrave;o ta sử dụng thủ tục DFS để x&acirc;y dựng 2 mảng :
</p>
  
<p style="margin-left: 21pt; text-indent: -18pt" class="MsoNormal">
<!--[if !supportLists]-->-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; prevnum[1&hellip;n] với prevnum[i] cho ta biết thứ tự gọi thủ tục DFS cho đỉnh i.<!--[endif]-->
</p>
  
<p style="margin-left: 21pt; text-indent: -18pt" class="MsoNormal">
<!--[if !supportLists]-->-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; postnum[1&hellip;n] với postnum[i] cho ta biết thứ tự tho&aacute;t khỏi thủ tục DFS cho đỉnh i.<!--[endif]-->
</p>
  
<p>
Từ 2 mảng prevnum v&agrave; postnum ta c&oacute; thể thấy điều kiện cần v&agrave; đủ để u l&agrave; cha của v l&agrave; prevnum[u]&lt;=prevnum[v] &amp; postnum[u]&gt;=postnum[v]. Do đ&oacute; thao t&aacute;c chất vấn LCA(u,v) thực chất l&agrave; t&igrave;m một đỉnh i sao cho :
</p>
  
<p style="margin-left: 21pt; text-indent: -18pt" class="MsoNormal">
<!--[if !supportLists]-->-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; prevnum[i]&lt;=Min(prevnum[u],prevnum[v])<!--[endif]-->
</p>
  
<p style="margin-left: 21pt; text-indent: -18pt" class="MsoNormal">
<!--[if !supportLists]-->-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; postnum[i]&gt;=Max(postnum[u],postnum[v])<!--[endif]-->
</p>
  
<p style="margin-left: 21pt; text-indent: -18pt" class="MsoNormal">
<!--[if !supportLists]-->-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; prevnum[i] lớn nhất c&oacute; thể ( hoặc postnum[i] nhỏ nhất c&oacute; thể ).<!--[endif]-->
</p>
  
<p>
2 điều kiện đầu đảm bảo i sẽ l&agrave; cha chung của u v&agrave; v, điều kiện thứ 3 đảm bảo i sẽ l&agrave; đỉnh xa gốc nhất, tức i = LCA(u,v).
</p>
  
<p>
X&acirc;y dựng mảng A[1&hellip;n] với A[i] cho ta biết postnum[k] với k l&agrave; đỉnh sao cho prevnum[k]=i. Ta ho&agrave;n to&agrave;n c&oacute; thể x&acirc;y dựng mảng A trong thời gian O(N). Như vậy ta cần t&igrave;m trong mảng con A[1&hellip;Min(prevnum[u],prevnum[v])] phần tử cuối c&ugrave;ng sao cho gi&aacute; trị của n&oacute; kh&ocirc;ng nhỏ hơn Max(postnum[u],postnum[v]). Ta c&oacute; thể sử dụng cấu tr&uacute;c dữ liệu Interval Tree để l&agrave;m việc n&agrave;y, mỗi n&uacute;t của c&acirc;y Interval sẽ lưu gi&aacute; trị lớn nhất của một đoạn v&agrave; khi thực hiện thủ tục DFS tr&ecirc;n c&acirc;y Interval ta ưu ti&ecirc;n đi sang c&acirc;y con b&ecirc;n phải. Khi biết được gi&aacute; trị postnum ( v&agrave; cả prevnum) của đỉnh cần t&igrave;m rồi ta sẽ dễ d&agrave;ng biết được đỉnh đ&oacute;.
</p>
  
<p>
Độ phức tạp của thuật to&aacute;n n&agrave;y cũng giống như thuật to&aacute;n 1 với thời gian l&agrave; &lt;NlogN,LogN&gt; như chỉ mất O(N) bộ nhớ.
</p>
    
<p>
<span style="font-size: 12pt">C&aacute;ch 3 :</span>
</p>
  
<p>
Cũng tương tự c&aacute;ch 2 ta khởi tạo c&aacute;c mảng prevnum[1&hellip;n] v&agrave; postnum[1&hellip;n]. Mảng A[1&hellip;n] với A[i] cho ta biết đỉnh k sao cho prevnum[k] = i. Như vậy ta cần t&igrave;m LCA(u,v) trong mảng con A[1&hellip;Min(prevnum[u],prevnum[v])]. Ta c&oacute; thể sử dụng phương ph&aacute;p chặt nhị ph&acirc;n kết hợp đệ quy để l&agrave;m cận ( kh&aacute; tốt ) như sau : X&eacute;t thủ tục Find_LCA( left, right, u, v : Integer ) t&igrave;m cha chung gần nhất của u,v trong mảng con A[left&hellip;right]. Kh&ocirc;ng mất t&iacute;nh tổng qu&aacute;t giả sử prevnum[u]&lt;prevnum[v], nếu postnum[u]&gt;postnum[v] th&igrave; LCA(u,v)=u v&agrave; đ&acirc;y l&agrave; trường hợp dễ d&agrave;ng t&igrave;m ra đ&aacute;p &aacute;n. Nếu postnum[u]&lt;postnum[v], gọi mid = (left+right)/2. X&eacute;t phần tử ch&iacute;nh giữa đoạn i = A[mid] sẽ c&oacute; c&aacute;c khả năng sau :
</p>
  
<p style="margin-left: 21pt; text-indent: -18pt" class="MsoNormal">
<!--[if !supportLists]-->-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; postnum[i]&gt;postnum[v] : i sẽ l&agrave; cha chung của u v&agrave; v như chưa chắc đ&atilde; l&agrave; LCA(u,v). Hiển nhi&ecirc;n prevnum[i]&lt;=prevnum[LCA(u,v)] n&ecirc;n ta gọi đệ quy : Find_LCA( mid, right, u, v).<!--[endif]-->
</p>
  
<p style="margin-left: 21pt; text-indent: -18pt" class="MsoNormal">
<!--[if !supportLists]-->-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; postnum[v]&gt;postnum[i]&gt;postnum[u] : i l&agrave; cha của u nhưng kh&ocirc;ng phải l&agrave; cha của v. V&igrave; vậy LCA(u,v) = LCA(i,v), ta gọi đệ quy : Find_LCA( left, mid, i, v).<!--[endif]-->
</p>
  
<p style="margin-left: 21pt; text-indent: -18pt" class="MsoNormal">
<!--[if !supportLists]-->-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; postnum[i]&lt;postnum[u] : đỉnh i l&agrave; đỉnh được rẽ nh&aacute;nh ra từ một n&uacute;t cha n&agrave;o đ&oacute; của u, nhưng ta ho&agrave;n to&agrave;n chưa biết n&uacute;t cha n&agrave;y nằm dưới hay tr&ecirc;n LCA(u,v). Ta c&oacute; thể xử l&yacute; theo 2 c&aacute;ch : gọi đệ quy Find_LCA(left,right,cha(u),cha(v)) hoặc lấy j = Find_LCA(left,mid,i,u) v&agrave; j sẽ rơi v&agrave;o 2 trường hợp đầu.<!--[endif]-->
</p>
  
<p>
Thuật to&aacute;n tr&ecirc;n nếu chỉ thực hiện 2 trường hợp đầu th&igrave; độ phức tạp cho mỗi lần chất vấn l&agrave; LogN, c&ograve;n nếu chỉ thực hiện trường hợp 3 th&igrave; độ phức tạp sẽ l&agrave; N. Qua khảo s&aacute;t bằng việc chạy chương tr&igrave;nh cho thấy thời gian thực hiện trung b&igrave;nh của thuật to&aacute;n n&agrave;y ngang với c&aacute;c thuật to&aacute;n với độ phức tạp &lt;NlogN,LogN&gt;. Thuật to&aacute;n n&agrave;y tuy c&oacute; độ phức tạp lớn nhưng lại l&agrave; phương ph&aacute;p tiết kiệm bộ nhớ v&agrave; c&agrave;i đặt dễ d&agrave;ng n&ecirc;n đ&acirc;y l&agrave; thuật to&aacute;n c&oacute; ứng dụng cao trong l&agrave;m b&agrave;i.
</p>
    
<p>
<span style="font-size: 12pt">C&aacute;ch 4 :</span>
</p>
    
<p class="MsoNormal">
Sử dụng Dynamic Tree. Xuất ph&aacute;t từ trường hợp suy biến của c&acirc;y : mỗi n&uacute;t của c&acirc;y chỉ c&oacute; đ&uacute;ng 1 con ( trừ 1 n&uacute;t l&aacute; kh&ocirc;ng c&oacute; con ). Với một c&acirc;y suy biến ta ho&agrave;n to&agrave;n c&oacute; thể t&igrave;m LCA(u,v) trong thời gian O(1) ( đỉnh n&agrave;o gần gốc hơn trong 2 đỉnh u,v sẽ l&agrave; LCA(u,v) ). Tư tưởng của Dynamic Tree sẽ l&agrave; chia c&acirc;y ban đầu ra th&agrave;nh nhiều c&acirc;y suy biến. H&igrave;nh vẽ dưới đ&acirc;y m&ocirc; tả trực quan hơn về &yacute; tưởng n&agrave;y :&nbsp;  
</p>
<p class="MsoNormal">
<!--[if gte vml 1]><v:group id="_x0000_s1026" style='position:absolute;  margin-left:9pt;margin-top:6.1pt;width:414pt;height:351pt;z-index:1'  coordorigin="3076,624" coordsize="2469,1968">  <v:line id="_x0000_s1027" style='position:absolute;flip:y;mso-wrap-style:none;   v-text-anchor:middle' from="3168,2064" to="3360,2496" strokeweight="2.25pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>  </v:line><v:line id="_x0000_s1028" style='position:absolute;flip:y;   mso-wrap-style:none;v-text-anchor:middle' from="3360,1632" to="3552,2064"   strokeweight="2.25pt">   <v:stroke dashstyle="dash" startarrowwidth="narrow" startarrowlength="short"    endarrowwidth="narrow" endarrowlength="short"/>   <v:shadow color="white"/>  </v:line><v:line id="_x0000_s1029" style='position:absolute;flip:y;   mso-wrap-style:none;v-text-anchor:middle' from="3600,1200" to="3792,1632"   strokeweight="2.25pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>  </v:line><v:line id="_x0000_s1030" style='position:absolute;flip:y;   mso-wrap-style:none;v-text-anchor:middle' from="3840,720" to="4464,1152"   strokeweight="2.25pt">   <v:stroke dashstyle="dash" startarrowwidth="narrow" startarrowlength="short"    endarrowwidth="narrow" endarrowlength="short"/>   <v:shadow color="white"/>  </v:line><v:line id="_x0000_s1031" style='position:absolute;flip:y;   mso-wrap-style:none;v-text-anchor:middle' from="4464,720" to="4464,1152"   strokeweight="2.25pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>  </v:line><v:line id="_x0000_s1032" style='position:absolute;flip:x y;   mso-wrap-style:none;v-text-anchor:middle' from="5160,1152" to="5328,1632"   strokeweight="2.25pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>  </v:line><v:line id="_x0000_s1033" style='position:absolute;mso-wrap-style:none;   v-text-anchor:middle' from="3600,1680" to="3936,2112" strokeweight="2.25pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>  </v:line><v:line id="_x0000_s1034" style='position:absolute;flip:x y;   mso-wrap-style:none;v-text-anchor:middle' from="4512,720" to="5184,1152"   strokeweight="2.25pt">   <v:stroke dashstyle="dash" startarrowwidth="narrow" startarrowlength="short"    endarrowwidth="narrow" endarrowlength="short"/>   <v:shadow color="white"/>  </v:line><v:line id="_x0000_s1035" style='position:absolute;flip:y;   mso-wrap-style:none;v-text-anchor:middle' from="4464,1632" to="4464,2064"   strokeweight="2.25pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>  </v:line><v:line id="_x0000_s1036" style='position:absolute;flip:y;   mso-wrap-style:none;v-text-anchor:middle' from="4464,1104" to="4464,1536"   strokeweight="2.25pt">   <v:stroke dashstyle="dash" startarrowwidth="narrow" startarrowlength="short"    endarrowwidth="narrow" endarrowlength="short"/>   <v:shadow color="white"/>  </v:line><v:line id="_x0000_s1037" style='position:absolute;flip:y;   mso-wrap-style:none;v-text-anchor:middle' from="4032,1152" to="4416,1632"   strokeweight="2.25pt">   <v:stroke dashstyle="dash" startarrowwidth="narrow" startarrowlength="short"    endarrowwidth="narrow" endarrowlength="short"/>   <v:shadow color="white"/>  </v:line><v:line id="_x0000_s1038" style='position:absolute;flip:x y;   mso-wrap-style:none;v-text-anchor:middle' from="4512,1152" to="4848,1536"   strokeweight="2.25pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>  </v:line><v:oval id="_x0000_s1039" style='position:absolute;left:3511;top:1536;   width:143;height:192;mso-wrap-style:none;v-text-anchor:middle' fillcolor="#cff"   strokeweight="1pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>   <v:textbox>    <![if !mso]>    
<table cellpadding=0 cellspacing=0 width="100%">
	     
	<tr>
		      
		<td><![endif]>      
		<div>
		      
		<p class=MsoNormal align=center style='text-align:center;mso-layout-grid-align:      none;text-autospace:none'>
		<span class=GramE><i><span lang=EN-US      style='font-size:20.0pt;color:black'>i</span></i></span><span lang=EN-US      style='font-size:18.0pt;color:black'><o:p></o:p></span>
		</p>
		      
		</div>
		      <![if !mso]></td>     
	</tr>
	    
</table>
    <![endif]></v:textbox>  </v:oval><v:shapetype id="_x0000_t202" coordsize="21600,21600" o:spt="202"   path="m,l,21600r21600,l21600,xe">   <v:stroke joinstyle="miter"/>   <v:path gradientshapeok="t" o:connecttype="rect"/>  </v:shapetype><v:shape id="_x0000_s1040" type="#_x0000_t202" style='position:absolute;   left:3708;top:1555;width:49;height:114;mso-wrap-style:none' filled="f"   fillcolor="#9ff" stroked="f" strokeweight="1pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>   <v:textbox style='mso-fit-shape-to-text:t' inset="0,0,0,0">    <![if !mso]>    
<table cellpadding=0 cellspacing=0 width="100%">
	     
	<tr>
		      
		<td><![endif]>      
		<div>
		      
		<p class=MsoNormal align=center style='text-align:center;mso-layout-grid-align:      none;text-autospace:none'>
		<span lang=EN-US style='font-size:18.0pt;      color:black'><o:p>&nbsp;</o:p></span>
		</p>
		      
		</div>
		      <![if !mso]></td>     
	</tr>
	    
</table>
    <![endif]></v:textbox>  </v:shape><v:oval id="_x0000_s1041" style='position:absolute;left:4806;top:1536;   width:143;height:192;mso-wrap-style:none;v-text-anchor:middle' fillcolor="#cff"   strokeweight="1pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>   <v:textbox>    <![if !mso]>    
<table cellpadding=0 cellspacing=0 width="100%">
	     
	<tr>
		      
		<td><![endif]>      
		<div>
		      
		<p class=MsoNormal align=center style='text-align:center;mso-layout-grid-align:      none;text-autospace:none'>
		<span class=GramE><i><span lang=EN-US      style='font-size:20.0pt;color:black'>l</span></i></span><span lang=EN-US      style='font-size:18.0pt;color:black'><o:p></o:p></span>
		</p>
		      
		</div>
		      <![if !mso]></td>     
	</tr>
	    
</table>
    <![endif]></v:textbox>  </v:oval><v:shape id="_x0000_s1042" type="#_x0000_t202" style='position:absolute;   left:5004;top:1555;width:49;height:114;mso-wrap-style:none' filled="f"   fillcolor="#9ff" stroked="f" strokeweight="1pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>   <v:textbox style='mso-fit-shape-to-text:t' inset="0,0,0,0">    <![if !mso]>    
<table cellpadding=0 cellspacing=0 width="100%">
	     
	<tr>
		      
		<td><![endif]>      
		<div>
		      
		<p class=MsoNormal align=center style='text-align:center;mso-layout-grid-align:      none;text-autospace:none'>
		<span lang=EN-US style='font-size:18.0pt;      color:black'><o:p>&nbsp;</o:p></span>
		</p>
		      
		</div>
		      <![if !mso]></td>     
	</tr>
	    
</table>
    <![endif]></v:textbox>  </v:shape><v:oval id="_x0000_s1043" style='position:absolute;left:4364;top:1536;   width:224;height:192;mso-wrap-style:none;v-text-anchor:middle' fillcolor="#cff"   strokeweight="1pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>   <v:textbox>    <![if !mso]>    
<table cellpadding=0 cellspacing=0 width="100%">
	     
	<tr>
		      
		<td><![endif]>      
		<div>
		      
		<p class=MsoNormal align=center style='text-align:center;mso-layout-grid-align:      none;text-autospace:none'>
		<span class=GramE><i><span lang=EN-US      style='font-size:20.0pt;color:black'>m</span></i></span><span lang=EN-US      style='font-size:18.0pt;color:black'><o:p></o:p></span>
		</p>
		      
		</div>
		      <![if !mso]></td>     
	</tr>
	    
</table>
    <![endif]></v:textbox>  </v:oval><v:shape id="_x0000_s1044" type="#_x0000_t202" style='position:absolute;   left:4608;top:1555;width:49;height:114;mso-wrap-style:none' filled="f"   fillcolor="#9ff" stroked="f" strokeweight="1pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>   <v:textbox style='mso-fit-shape-to-text:t' inset="0,0,0,0">    <![if !mso]>    
<table cellpadding=0 cellspacing=0 width="100%">
	     
	<tr>
		      
		<td><![endif]>      
		<div>
		      
		<p class=MsoNormal align=center style='text-align:center;mso-layout-grid-align:      none;text-autospace:none'>
		<span lang=EN-US style='font-size:18.0pt;      color:black'><o:p>&nbsp;</o:p></span>
		</p>
		      
		</div>
		      <![if !mso]></td>     
	</tr>
	    
</table>
    <![endif]></v:textbox>  </v:shape><v:oval id="_x0000_s1045" style='position:absolute;left:3942;top:1536;   width:155;height:192;mso-wrap-style:none;v-text-anchor:middle' fillcolor="#cff"   strokeweight="1pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>   <v:textbox>    <![if !mso]>    
<table cellpadding=0 cellspacing=0 width="100%">
	     
	<tr>
		      
		<td><![endif]>      
		<div>
		      
		<p class=MsoNormal align=center style='text-align:center;mso-layout-grid-align:      none;text-autospace:none'>
		<span class=GramE><i><span lang=EN-US      style='font-size:20.0pt;color:black'>f</span></i></span><span lang=EN-US      style='font-size:18.0pt;color:black'><o:p></o:p></span>
		</p>
		      
		</div>
		      <![if !mso]></td>     
	</tr>
	    
</table>
    <![endif]></v:textbox>  </v:oval><v:shape id="_x0000_s1046" type="#_x0000_t202" style='position:absolute;   left:4176;top:1555;width:49;height:114;mso-wrap-style:none' filled="f"   fillcolor="#9ff" stroked="f" strokeweight="1pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>   <v:textbox style='mso-fit-shape-to-text:t' inset="0,0,0,0">    <![if !mso]>    
<table cellpadding=0 cellspacing=0 width="100%">
	     
	<tr>
		      
		<td><![endif]>      
		<div>
		      
		<p class=MsoNormal align=center style='text-align:center;mso-layout-grid-align:      none;text-autospace:none'>
		<span lang=EN-US style='font-size:18.0pt;      color:black'><o:p>&nbsp;</o:p></span>
		</p>
		      
		</div>
		      <![if !mso]></td>     
	</tr>
	    
</table>
    <![endif]></v:textbox>  </v:shape><v:oval id="_x0000_s1047" style='position:absolute;left:5259;top:1536;   width:178;height:192;mso-wrap-style:none;v-text-anchor:middle' fillcolor="#cff"   strokeweight="1pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>   <v:textbox>    <![if !mso]>    
<table cellpadding=0 cellspacing=0 width="100%">
	     
	<tr>
		      
		<td><![endif]>      
		<div>
		      
		<p class=MsoNormal align=center style='text-align:center;mso-layout-grid-align:      none;text-autospace:none'>
		<span class=GramE><i><span lang=EN-US      style='font-size:20.0pt;color:black'>g</span></i></span><span lang=EN-US      style='font-size:18.0pt;color:black'><o:p></o:p></span>
		</p>
		      
		</div>
		      <![if !mso]></td>     
	</tr>
	    
</table>
    <![endif]></v:textbox>  </v:oval><v:shape id="_x0000_s1048" type="#_x0000_t202" style='position:absolute;   left:5496;top:1555;width:49;height:114;mso-wrap-style:none' filled="f"   fillcolor="#9ff" stroked="f" strokeweight="1pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>   <v:textbox style='mso-fit-shape-to-text:t' inset="0,0,0,0">    <![if !mso]>    
<table cellpadding=0 cellspacing=0 width="100%">
	     
	<tr>
		      
		<td><![endif]>      
		<div>
		      
		<p class=MsoNormal align=center style='text-align:center;mso-layout-grid-align:      none;text-autospace:none'>
		<span lang=EN-US style='font-size:18.0pt;      color:black'><o:p>&nbsp;</o:p></span>
		</p>
		      
		</div>
		      <![if !mso]></td>     
	</tr>
	    
</table>
    <![endif]></v:textbox>  </v:shape><v:oval id="_x0000_s1049" style='position:absolute;left:5041;top:1056;   width:181;height:192;mso-wrap-style:none;v-text-anchor:middle' fillcolor="#cff"   strokeweight="1pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>   <v:textbox>    <![if !mso]>    
<table cellpadding=0 cellspacing=0 width="100%">
	     
	<tr>
		      
		<td><![endif]>      
		<div>
		      
		<p class=MsoNormal align=center style='text-align:center;mso-layout-grid-align:      none;text-autospace:none'>
		<span class=GramE><i><span lang=EN-US      style='font-size:20.0pt;color:black'>n</span></i></span><span lang=EN-US      style='font-size:18.0pt;color:black'><o:p></o:p></span>
		</p>
		      
		</div>
		      <![if !mso]></td>     
	</tr>
	    
</table>
    <![endif]></v:textbox>  </v:oval><v:shape id="_x0000_s1050" type="#_x0000_t202" style='position:absolute;   left:5304;top:1075;width:49;height:114;mso-wrap-style:none' filled="f"   fillcolor="#9ff" stroked="f" strokeweight="1pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>   <v:textbox style='mso-fit-shape-to-text:t' inset="0,0,0,0">    <![if !mso]>    
<table cellpadding=0 cellspacing=0 width="100%">
	     
	<tr>
		      
		<td><![endif]>      
		<div>
		      
		<p class=MsoNormal align=center style='text-align:center;mso-layout-grid-align:      none;text-autospace:none'>
		<span lang=EN-US style='font-size:18.0pt;      color:black'><o:p>&nbsp;</o:p></span>
		</p>
		      
		</div>
		      <![if !mso]></td>     
	</tr>
	    
</table>
    <![endif]></v:textbox>  </v:shape><v:oval id="_x0000_s1051" style='position:absolute;left:4393;top:1056;   width:181;height:192;mso-wrap-style:none;v-text-anchor:middle' fillcolor="#cff"   strokeweight="1pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>   <v:textbox>    <![if !mso]>    
<table cellpadding=0 cellspacing=0 width="100%">
	     
	<tr>
		      
		<td><![endif]>      
		<div>
		      
		<p class=MsoNormal align=center style='text-align:center;mso-layout-grid-align:      none;text-autospace:none'>
		<span class=GramE><i><span lang=EN-US      style='font-size:20.0pt;color:black'>b</span></i></span><span lang=EN-US      style='font-size:18.0pt;color:black'><o:p></o:p></span>
		</p>
		      
		</div>
		      <![if !mso]></td>     
	</tr>
	    
</table>
    <![endif]></v:textbox>  </v:oval><v:shape id="_x0000_s1052" type="#_x0000_t202" style='position:absolute;   left:4632;top:1075;width:49;height:114;mso-wrap-style:none' filled="f"   fillcolor="#9ff" stroked="f" strokeweight="1pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>   <v:textbox style='mso-fit-shape-to-text:t' inset="0,0,0,0">    <![if !mso]>    
<table cellpadding=0 cellspacing=0 width="100%">
	     
	<tr>
		      
		<td><![endif]>      
		<div>
		      
		<p class=MsoNormal align=center style='text-align:center;mso-layout-grid-align:      none;text-autospace:none'>
		<span lang=EN-US style='font-size:18.0pt;      color:black'><o:p>&nbsp;</o:p></span>
		</p>
		      
		</div>
		      <![if !mso]></td>     
	</tr>
	    
</table>
    <![endif]></v:textbox>  </v:shape><v:oval id="_x0000_s1053" style='position:absolute;left:3746;top:1056;   width:179;height:192;mso-wrap-style:none;v-text-anchor:middle' fillcolor="#cff"   strokeweight="1pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>   <v:textbox>    <![if !mso]>    
<table cellpadding=0 cellspacing=0 width="100%">
	     
	<tr>
		      
		<td><![endif]>      
		<div>
		      
		<p class=MsoNormal align=center style='text-align:center;mso-layout-grid-align:      none;text-autospace:none'>
		<span class=GramE><i><span lang=EN-US      style='font-size:20.0pt;color:black'>d</span></i></span><span lang=EN-US      style='font-size:18.0pt;color:black'><o:p></o:p></span>
		</p>
		      
		</div>
		      <![if !mso]></td>     
	</tr>
	    
</table>
    <![endif]></v:textbox>  </v:oval><v:shape id="_x0000_s1054" type="#_x0000_t202" style='position:absolute;   left:3948;top:1075;width:49;height:114;mso-wrap-style:none' filled="f"   fillcolor="#9ff" stroked="f" strokeweight="1pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>   <v:textbox style='mso-fit-shape-to-text:t' inset="0,0,0,0">    <![if !mso]>    
<table cellpadding=0 cellspacing=0 width="100%">
	     
	<tr>
		      
		<td><![endif]>      
		<div>
		      
		<p class=MsoNormal>
		<span lang=EN-US style='font-size:18.0pt'><o:p>&nbsp;</o:p></span>
		</p>
		      
		</div>
		      <![if !mso]></td>     
	</tr>
	    
</table>
    <![endif]></v:textbox>  </v:shape><v:oval id="_x0000_s1055" style='position:absolute;left:4393;top:624;   width:181;height:192;mso-wrap-style:none;v-text-anchor:middle' fillcolor="#cff"   strokeweight="1pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>   <v:textbox>    <![if !mso]>    
<table cellpadding=0 cellspacing=0 width="100%">
	     
	<tr>
		      
		<td><![endif]>      
		<div>
		      
		<p class=MsoNormal align=center style='text-align:center;mso-layout-grid-align:      none;text-autospace:none'>
		<span class=GramE><i><span lang=EN-US      style='font-size:20.0pt;color:black'>a</span></i></span><span lang=EN-US      style='font-size:18.0pt;color:black'><o:p></o:p></span>
		</p>
		      
		</div>
		      <![if !mso]></td>     
	</tr>
	    
</table>
    <![endif]></v:textbox>  </v:oval><v:shape id="_x0000_s1056" type="#_x0000_t202" style='position:absolute;   left:4632;top:643;width:49;height:114;mso-wrap-style:none' filled="f"   fillcolor="#9ff" stroked="f" strokeweight="1pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>   <v:textbox style='mso-fit-shape-to-text:t' inset="0,0,0,0">    <![if !mso]>    
<table cellpadding=0 cellspacing=0 width="100%">
	     
	<tr>
		      
		<td><![endif]>      
		<div>
		      
		<p class=MsoNormal align=center style='text-align:center;mso-layout-grid-align:      none;text-autospace:none'>
		<span lang=EN-US style='font-size:18.0pt;      color:black'><o:p>&nbsp;</o:p></span>
		</p>
		      
		</div>
		      <![if !mso]></td>     
	</tr>
	    
</table>
    <![endif]></v:textbox>  </v:shape><v:oval id="_x0000_s1057" style='position:absolute;left:3793;top:1968;   width:181;height:192;mso-wrap-style:none;v-text-anchor:middle' fillcolor="#cff"   strokeweight="1pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>   <v:textbox>    <![if !mso]>    
<table cellpadding=0 cellspacing=0 width="100%">
	     
	<tr>
		      
		<td><![endif]>      
		<div>
		      
		<p class=MsoNormal align=center style='text-align:center;mso-layout-grid-align:      none;text-autospace:none'>
		<span class=GramE><i><span lang=EN-US      style='font-size:20.0pt;color:black'>h</span></i></span><span lang=EN-US      style='font-size:18.0pt;color:black'><o:p></o:p></span>
		</p>
		      
		</div>
		      <![if !mso]></td>     
	</tr>
	    
</table>
    <![endif]></v:textbox>  </v:oval><v:shape id="_x0000_s1058" type="#_x0000_t202" style='position:absolute;   left:4032;top:1987;width:49;height:114;mso-wrap-style:none' filled="f"   fillcolor="#9ff" stroked="f" strokeweight="1pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>   <v:textbox style='mso-fit-shape-to-text:t' inset="0,0,0,0">    <![if !mso]>    
<table cellpadding=0 cellspacing=0 width="100%">
	     
	<tr>
		      
		<td><![endif]>      
		<div>
		      
		<p class=MsoNormal align=center style='text-align:center;mso-layout-grid-align:      none;text-autospace:none'>
		<span lang=EN-US style='font-size:18.0pt;      color:black'><o:p>&nbsp;</o:p></span>
		</p>
		      
		</div>
		      <![if !mso]></td>     
	</tr>
	    
</table>
    <![endif]></v:textbox>  </v:shape><v:oval id="_x0000_s1059" style='position:absolute;left:3271;top:1968;   width:143;height:192;mso-wrap-style:none;v-text-anchor:middle' fillcolor="#cff"   strokeweight="1pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>   <v:textbox>    <![if !mso]>    
<table cellpadding=0 cellspacing=0 width="100%">
	     
	<tr>
		      
		<td><![endif]>      
		<div>
		      
		<p class=MsoNormal align=center style='text-align:center;mso-layout-grid-align:      none;text-autospace:none'>
		<span class=GramE><i><span lang=EN-US      style='font-size:20.0pt;color:black'>j</span></i></span><span lang=EN-US      style='font-size:18.0pt;color:black'><o:p></o:p></span>
		</p>
		      
		</div>
		      <![if !mso]></td>     
	</tr>
	    
</table>
    <![endif]></v:textbox>  </v:oval><v:shape id="_x0000_s1060" type="#_x0000_t202" style='position:absolute;   left:3468;top:1987;width:49;height:114;mso-wrap-style:none' filled="f"   fillcolor="#9ff" stroked="f" strokeweight="1pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>   <v:textbox style='mso-fit-shape-to-text:t' inset="0,0,0,0">    <![if !mso]>    
<table cellpadding=0 cellspacing=0 width="100%">
	     
	<tr>
		      
		<td><![endif]>      
		<div>
		      
		<p class=MsoNormal align=center style='text-align:center;mso-layout-grid-align:      none;text-autospace:none'>
		<span lang=EN-US style='font-size:18.0pt;      color:black'><o:p>&nbsp;</o:p></span>
		</p>
		      
		</div>
		      <![if !mso]></td>     
	</tr>
	    
</table>
    <![endif]></v:textbox>  </v:shape><v:oval id="_x0000_s1061" style='position:absolute;left:4372;top:1968;   width:167;height:192;mso-wrap-style:none;v-text-anchor:middle' fillcolor="#cff"   strokeweight="1pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>   <v:textbox>    <![if !mso]>    
<table cellpadding=0 cellspacing=0 width="100%">
	     
	<tr>
		      
		<td><![endif]>      
		<div>
		      
		<p class=MsoNormal align=center style='text-align:center;mso-layout-grid-align:      none;text-autospace:none'>
		<span class=GramE><i><span lang=EN-US      style='font-size:20.0pt;color:black'>e</span></i></span><span lang=EN-US      style='font-size:18.0pt;color:black'><o:p></o:p></span>
		</p>
		      
		</div>
		      <![if !mso]></td>     
	</tr>
	    
</table>
    <![endif]></v:textbox>  </v:oval><v:shape id="_x0000_s1062" type="#_x0000_t202" style='position:absolute;   left:4608;top:1987;width:49;height:114;mso-wrap-style:none' filled="f"   fillcolor="#9ff" stroked="f" strokeweight="1pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>   <v:textbox style='mso-fit-shape-to-text:t' inset="0,0,0,0">    <![if !mso]>    
<table cellpadding=0 cellspacing=0 width="100%">
	     
	<tr>
		      
		<td><![endif]>      
		<div>
		      
		<p class=MsoNormal style='mso-layout-grid-align:none;text-autospace:none'>
		<span      lang=EN-US style='font-size:18.0pt;color:black'><o:p>&nbsp;</o:p></span>
		</p>
		      
		</div>
		      <![if !mso]></td>     
	</tr>
	    
</table>
    <![endif]></v:textbox>  </v:shape><v:oval id="_x0000_s1063" style='position:absolute;left:3076;top:2400;   width:168;height:192;mso-wrap-style:none;v-text-anchor:middle' fillcolor="#cff"   strokeweight="1pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>   <v:textbox>    <![if !mso]>    
<table cellpadding=0 cellspacing=0 width="100%">
	     
	<tr>
		      
		<td><![endif]>      
		<div>
		      
		<p class=MsoNormal align=center style='text-align:center;mso-layout-grid-align:      none;text-autospace:none'>
		<span class=GramE><i><span lang=EN-US      style='font-size:20.0pt;color:black'>k</span></i></span><span lang=EN-US      style='font-size:18.0pt;color:black'><o:p></o:p></span>
		</p>
		      
		</div>
		      <![if !mso]></td>     
	</tr>
	    
</table>
    <![endif]></v:textbox>  </v:oval><v:shape id="_x0000_s1064" type="#_x0000_t202" style='position:absolute;   left:3312;top:2419;width:49;height:114;mso-wrap-style:none' filled="f"   fillcolor="#9ff" stroked="f" strokeweight="1pt">   <v:stroke startarrowwidth="narrow" startarrowlength="short" endarrowwidth="narrow"    endarrowlength="short"/>   <v:shadow color="white"/>   <v:textbox style='mso-fit-shape-to-text:t' inset="0,0,0,0">    <![if !mso]>    
<table cellpadding=0 cellspacing=0 width="100%">
	     
	<tr>
		      
		<td><![endif]>      
		<div>
		      
		<p class=MsoNormal align=center style='text-align:center;mso-layout-grid-align:      none;text-autospace:none'>
		<span lang=EN-US style='font-size:18.0pt;      color:black'><o:p>&nbsp;</o:p></span>
		</p>
		      
		</div>
		      <![if !mso]></td>     
	</tr>
	    
</table>
    <![endif]></v:textbox>  </v:shape></v:group><![endif]--><!--[if !vml]-->  <!--[endif]-->
</p>
<table align="left" border="0" cellpadding="0" cellspacing="0">
	  
	<tbody>
		<tr>
			   
			<td height="7" width="11">&nbsp;</td>  
		</tr>
		  
		<tr>
			   
			<td>&nbsp;</td>   
			<td><img src="http://minhduc.comp.nus.edu.sg/Res/LCAa_files/image001.gif" height="474" width="557" /></td>  
		</tr>
		 
	</tbody>
</table>
<p class="MsoNormal">
&nbsp;
</p>
                                                  
<p class="MsoNormal">
Những cạnh liền l&agrave; những cạnh thuộc c&acirc;y suy biến, c&ograve;n c&aacute;c cạnh n&eacute;t đứt sẽ l&agrave; những cạnh nối c&aacute;c c&acirc;y suy biến với nhau. Nếu coi mỗi c&acirc;y suy biến l&agrave; một đỉnh th&igrave; ta sẽ được một c&acirc;y mới gọi l&agrave; c&acirc;y r&uacute;t gọn. Sau đ&acirc;y l&agrave; một c&aacute;ch chia c&acirc;y để c&acirc;y r&uacute;t gọn thu được c&oacute; độ cao O(LogN) với N l&agrave; số n&uacute;t của c&acirc;y ban đầu : xuất ph&aacute;t từ đỉnh gốc, với mỗi đỉnh nếu l&agrave; l&aacute; th&igrave; n&oacute; sẽ l&agrave; kết th&uacute;c của một c&acirc;y suy biến, c&ograve;n kh&ocirc;ng ta sẽ ph&aacute;t triển tiếp c&acirc;y suy biến n&agrave;y xuống đỉnh con c&oacute; trọng lượng lớn nhất, c&aacute;c đỉnh con kh&aacute;c sẽ l&agrave; n&uacute;t gốc của những c&acirc;y suy biến mới. Trọng lượng của một n&uacute;t được định nghĩa l&agrave; số n&uacute;t nhận n&uacute;t đ&oacute; l&agrave; tổ ti&ecirc;n ( hiểu một c&aacute;ch trực quan th&igrave; nếu coi mỗi n&uacute;t c&oacute; một &ldquo;sức nặng&rdquo; th&igrave; trọng lượng của một n&uacute;t ch&iacute;nh l&agrave; &ldquo;sức nặng&rdquo; m&agrave; n&uacute;t đ&oacute; phải g&aacute;nh ). 
</p>
  
<p>
Chứng minh :
</p>
  
<p>
Gọi F(n) l&agrave; h&agrave;m cho ta chiều cao tối đa của một c&acirc;y r&uacute;t gọn c&oacute; n đỉnh. Ta sẽ chứng minh F(n)&lt;=LogN+1.
</p>
  
<p>
Với n=1 th&igrave; F(1) = Log(1)+1.
</p>
  
<p>
Giả sử điều cần chứng minh đ&atilde; đ&uacute;ng đến n-1.
</p>
  
<p>
Với một c&acirc;y c&oacute; N đỉnh v&agrave; n&uacute;t gốc sẽ c&oacute; c&aacute;c c&acirc;y con với số đỉnh l&agrave; x1&hellip;xk. Giả sử x1 = Max( x1&hellip;xk). Ta c&oacute; 2*Max(x2&hellip;xk) &lt;= Max(x2&hellip;xk)+x1 &lt;= N 
</p>
  
<p style="margin-left: 36pt; text-indent: -18pt" class="MsoNormal">
<!--[if !supportLists]-->&eth;&nbsp;&nbsp;&nbsp;&nbsp; Max(x2&hellip;xk) &lt;= N/2.<!--[endif]-->
</p>
  
<p>
Theo c&aacute;ch x&acirc;y dựng c&acirc;y th&igrave; :
</p>
  
<p>
F(N)&nbsp; = Max( F(x1), F(x2)+1, F(x3)+1, &hellip;, F(xk)+1 )
</p>
  
<p class="MsoNormal">
M&agrave; : 
</p>
  
<p style="margin-left: 21pt; text-indent: -18pt" class="MsoNormal">
<!--[if !supportLists]-->-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; F(x1) &lt;= F(N-1) &lt;= LogN+1<!--[endif]-->
</p>
  
<p style="margin-left: 21pt; text-indent: -18pt" class="MsoNormal">
<!--[if !supportLists]-->-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; F(x2) +1 &lt;= F(N/2)+1 &lt;= LogN+1<!--[endif]-->
</p>
  
<p style="margin-left: 21pt; text-indent: -18pt" class="MsoNormal">
<!--[if !supportLists]-->-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &hellip;<!--[endif]-->
</p>
  
<p style="margin-left: 21pt; text-indent: -18pt" class="MsoNormal">
<!--[if !supportLists]-->-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; F(xk) +1 &lt;= F(N/2)+1 &lt;= LogN+1<!--[endif]-->
</p>
  
<p>
Vậy F(N) &lt;= LogN+1 =&gt; Điều phải chứng minh.
</p>
  
<p>
Để thực hiện chất vấn LCA(u,v) ta lần lượt nhảy từ u v&agrave; v trở về gốc của c&acirc;y. Từ một đỉnh ta thực hiện lần lượt một bước nhảy d&agrave;i tới gốc của c&acirc;y suy biến chứa n&oacute; v&agrave; một bước nhảy ngắn tới n&uacute;t cha ( qua đ&oacute; chuyển sang c&acirc;y suy biến mới). Sau khi x&aacute;c định được c&acirc;y suy biến chứa LCA(u,v), ta c&oacute; thể x&aacute;c định được đỉnh u1,v1 tương ứng l&agrave; n&uacute;t đầu ti&ecirc;n ta gặp khi nhảy từ u,v tới c&acirc;y suy biến chứa LCA(u,v). Sau đ&oacute; chỉ cần sử dụng một ph&eacute;p so s&aacute;nh xem u1 hay v1 gần gốc hơn l&agrave; c&oacute; thể x&aacute;c định được LCA(u,v).
</p>
  
<p>
Tuy về &yacute; tưởng ta quan t&acirc;m nhiều đến việc chia c&acirc;y ban đầu ra th&agrave;nh nhiều c&acirc;y suy biến nhưng về mặt c&agrave;i đặt, ta chỉ cần quan t&acirc;m với mỗi n&uacute;t của c&acirc;y đầu v&agrave;o, n&uacute;t gốc của c&acirc;y suy biến chứa n&oacute; l&agrave; n&uacute;t n&agrave;o. Dễ thấy khi thực hiện thủ tục DFS ( c&oacute; ưu ti&ecirc;n gọi đệ quy tới n&uacute;t con c&oacute; trọng lượng lớn nhất trước ) c&aacute;c n&uacute;t sẽ được liệt k&ecirc; lần lượt theo từng c&acirc;y suy biến. V&igrave; vậy ta c&oacute; thể khởi tạo mảng Head[1&hellip;n] với Head[i] cho ta biết n&uacute;t gốc của c&acirc;y suy biến chứa n&uacute;t i chỉ với O(N).
</p>
  
<p>
Thuật to&aacute;n n&agrave;y sẽ chạy trong thời gian &lt;N,LogN&gt;.
</p>
  
<p>
Thuật to&aacute;n n&agrave;y kh&aacute; linh hoạt v&agrave; c&oacute; thể mở rộng ra để ứng dụng v&agrave;o nhiều b&agrave;i to&aacute;n kh&aacute;c tr&ecirc;n c&acirc;y. Để &yacute; rằng nếu c&acirc;y ban đầu c&oacute; trọng số ở mỗi cạnh, sau khi chia th&agrave;nh c&aacute;c c&acirc;y suy biến th&igrave; cạnh của mỗi c&acirc;y suy biến sẽ giống như c&aacute;c phần tử li&ecirc;n tiếp của&nbsp; một mảng. Do đ&oacute; ta ho&agrave;n to&agrave;n c&oacute; thể sử dụng c&aacute;c cấu tr&uacute;c dữ liệu như Interval Tree để quản l&yacute; việc thay đổi hay chất vấn th&ocirc;ng tin về c&aacute;c cạnh n&agrave;y. Đ&acirc;y ch&iacute;nh l&agrave; &yacute; tưởng để l&agrave;m b&agrave;i <a href="http://www.spoj.pl/problems/QTREE">http://www.spoj.pl/problems/QTREE</a> tr&ecirc;n spoj.
</p>
    
<p>
<span style="font-size: 12pt">C&aacute;ch 5 :</span>
</p>
  
<p>
Đ&acirc;y l&agrave; một phương ph&aacute;p để giải b&agrave;i to&aacute;n LCA khi đ&atilde; biết trước mọi c&acirc;u hỏi chất vấn. C&aacute;ch l&agrave;m n&agrave;y tuy kh&ocirc;ng linh hoạt nhưng thời gian chạy kh&aacute; nhanh v&agrave; tiết kiệm bộ nhớ. Tư tưởng của phương ph&aacute;p n&agrave;y l&agrave; trả lời c&aacute;c c&acirc;u chất vấn theo một thứ tự kh&aacute;c dễ d&agrave;ng hơn. Với mỗi n&uacute;t của c&acirc;y ta sẽ lưu n&oacute; trong một tập hợp c&oacute; nh&atilde;n. Ban đầu mỗi n&uacute;t thuộc một tập hợp kh&aacute;c nhau v&agrave; nh&atilde;n của tập hợp ch&iacute;nh l&agrave; chỉ số của n&uacute;t đ&oacute;. Sau đ&oacute; ta thực hiện thủ tục DFS, trước khi tho&aacute;t ra khỏi thủ tục DFS ta thực hiện 2 thao t&aacute;c sau :
</p>
  
<p style="margin-left: 21pt; text-indent: -18pt" class="MsoNormal">
<!--[if !supportLists]-->-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; T&igrave;m cha chung của u với c&aacute;c đỉnh v m&agrave; thủ tục DFS(v) đ&atilde; được thực thi. Đỉnh cha chung ch&iacute;nh l&agrave; nh&atilde;n của tập hợp chứa v.<!--[endif]-->
</p>
  
<p style="margin-left: 21pt; text-indent: -18pt" class="MsoNormal">
<!--[if !supportLists]-->-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Hợp nhất tập hợp chứa u với tập hợp chứa cha(u) v&agrave; lấy nh&atilde;n l&agrave; cha(u).<!--[endif]-->
</p>
  
<p>
Ta sẽ chứng minh &ldquo;Đỉnh cha chung ch&iacute;nh l&agrave; nh&atilde;n của tập hợp chứa v&rdquo;. Giả sử i=LCA(u,v). Sau khi thực thi thủ tục DFS(v) xong, từ v thủ tục DFS phải đi về i v&agrave; rẽ xuống u để c&oacute; thể thực hiện DFS(u). Trong qu&aacute; tr&igrave;nh đi về i, n&oacute; sẽ hợp nhất v với cha v, &ocirc;ng v,&hellip; rồi với i. Do đ&oacute; nh&atilde;n của tập chứa v ch&iacute;nh l&agrave; i. 
</p>
  
<p>
Để thực hiện thao t&aacute;c hợp nhất 2 tập hợp với thời gian ngắn, ta c&oacute; thể sử dụng cấu tr&uacute;c disjoint set giống như trong thuật to&aacute;n Kruscal. Độ phức tạp của phương ph&aacute;p n&agrave;y l&agrave; (M+N)LogN với M l&agrave; số thao t&aacute;c.
</p>
			</td>
		</tr>
				</table>

		<span class="article_seperator">&nbsp;</span>

					<table align="center" style="margin-top: 25px;">
			<tr>
									<th class="pagenav_prev">
						<a href="http://vnoi.info/index.php?option=com_content&amp;task=view&amp;id=34&amp;Itemid=82">
							&lt; Trước</a>
					</th>
										<td width="50">&nbsp;

					</td>
										<th class="pagenav_next">
						<a href="http://vnoi.info/index.php?option=com_content&amp;task=view&amp;id=31&amp;Itemid=82">
							Tiếp &gt;</a>
					</th>
								</tr>
			</table>
						<div class="back_button">
				<a href='javascript:history.go(-1)'>
					[ Quay lại ]</a>
			</div>
			
</div>
</div>
<!-- END: CONTENT -->

</div>
</div>

<!-- BEGIN: FOOTER -->
<div id="ja-footerwrap">

<div id="ja-footer">


<!-- BEGIN: SPOTLIGHT -->
<div id="ja-spotlight" class="ja-spotlight clearfix">



<div class="ja-box box-ended" style="width: 99%;">
		<div class="moduletable">
			<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-3546305-2");
pageTracker._setVar("phamdat1992");
pageTracker._initData();
pageTracker._trackPageview();
</script>
		</div>
		</div>

</div>
<!-- END: SPOTLIGHT -->

<div id="ja-certwrap">
<p id="ja-bottomline">
Powered by <a href='http://joomla.org/'>Joomla!</a>
<br/>
Xem tốt nhất bằng trình duyệt <a href='http://www.mozilla.com/firefox'>Firefox</a> với độ phân giải từ 1024x768 trở lên
<br/>
Bản quyền &copy; 2008-2012 VNOI Team</p>
</div>		
</div>
</div>
</body>
</html><!-- 1378012016 -->